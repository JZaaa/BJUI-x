+function(e){"use strict";var t={JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:true,KeyPressed:{ctrl:false,shift:false},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},pageInfo:{pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",alertTimeout:6e3},ajaxTimeout:3e4,statusCode:{ok:200,error:300,timeout:301,warn:302},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSlidebar:true,clientPaging:true,overwriteHomeTab:false,hideWidth:600},debug:function(e){if(this.IS_DEBUG){if(typeof console!="undefined")console.log(e);else alert(e)}},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:true},loadLogin:function(){var t=this.loginInfo;e("body").dialog({id:"bjui-login",url:t.url,title:t.title,width:t.width,height:t.height,mask:t.mask})},init:function(i){var a=e.extend({},i);e.extend(t.statusCode,a.statusCode);e.extend(t.pageInfo,a.pageInfo);e.extend(t.alertMsg,a.alertMsg);e.extend(t.loginInfo,a.loginInfo);e.extend(t.ui,a.ui);if(a.JSPATH)this.JSPATH=a.JSPATH;if(a.PLUGINPATH)this.PLUGINPATH=a.PLUGINPATH;if(a.ajaxTimeout)this.ajaxTimeout=a.ajaxTimeout;this.IS_DEBUG=a.debug||false;this.initEnv();if((!e.cookie||!e.cookie("bjui_theme"))&&a.theme)e(this).theme("setTheme",a.theme)},initEnv:function(){e(window).resize(function(){var i=e(this).width();if(t.ui.windowWidth){if(t.ui.windowWidth>600&&t.ui.windowWidth<i)i=t.ui.windowWidth}t.initLayout(i);setTimeout(function(){e(this).trigger(t.eventType.resizeGrid)},30)});setTimeout(function(){var i=e(window).width();if(t.ui.windowWidth){if(t.ui.windowWidth>600&&t.ui.windowWidth<i)i=t.ui.windowWidth}t.initLayout(i);e(document).initui();var a=e("#bjui-navbar-collapse"),n=a.find(".bjui-navbar-right"),o=e("#navbar-collapse-cogs");o.on("click",function(){a.toggleClass("hidden")});n.on("click","[data-toggle=navtab],[data-toggle=dialog]",function(){if(o.hasClass("show")){a.addClass("hidden")}})},10)},initLayout:function(i){var a=i-(t.ui.showSlidebar?e("#bjui-sidebar").width()+6:6),n=e(window).height()-e("#bjui-footer").outerHeight(),o=e("#bjui-navtab").find(".tabsPageHeader").height()+e("#bjui-header").height();if(t.ui.windowWidth)e("#bjui-window").width(i);t.windowWidth=i;var r=e("#bjui-leftside"),s=e("#menu_lock");if(t.windowWidth<t.ui.hideWidth){r.hide().css("left",-r.width()+"px");e("#bjui-navtab").css("left",0).width(a+r.width());s.addClass("sm-collapse").data("lock","off")}else{r.show().css("left","0");e("#bjui-navtab").css("left",r.width()).width(a);s.removeClass("sm-collapse").data("lock","on")}e("#bjui-container").height(n);e("#bjui-navtab .tabsPageContent").height(n-o);setTimeout(function(){e("#bjui-navtab > .tabsPageContent > .navtabPage").resizePageH();e("#bjui-navtab > .tabsPageContent > .navtabPage").find(".bjui-layout").resizePageH()},10);var l=e("body").data("bjui.navbar.width"),d=e("#bjui-header"),c=d.find(".bjui-navbar-toggle"),f=d.find(".bjui-navbar-logo"),u=e("#bjui-navbar-collapse"),h=u.find(".bjui-navbar-right"),p=d.find("#navbar-collapse-cogs");if(!l){l={logoW:f.outerWidth(),navW:h.outerWidth()};e("body").data("bjui.navbar.width",l)}if(l){if(i-l.logoW<l.navW){c.show();u.addClass("collapse menu")}else{c.hide();u.removeClass("collapse menu in")}if(i-300<l.navW){if(!u.hasClass("hidden"))u.addClass("hidden open");p.addClass("show")}else{u.removeClass("hidden open");p.removeClass("show")}}var g=e("#bjui-hnav-navbar-box"),m=g.find("> #bjui-hnav-navbar"),v=g.prev(),b=g.next(),y=g.width(),k=0;m.find("> li").each(function(t){var i=e(this);k+=i.outerWidth();if(k>y){b.show();g.data("hnav.move",true).data("hnav.liw",k)}else{v.hide();b.hide();g.removeData("hnav.move")}})},regional:{},setRegional:function(e,i){t.regional[e]=i},getRegional:function(e){if(String(e).indexOf(".")>=0){var i,a=String(e).split(".");for(var n=0;n<a.length;n++){if(!i)i=t.regional[a[n]];else i=i[a[n]]}return i}else{return t.regional[e]}},doRegional:function(t,i){e.each(i,function(e,i){t=t.replaceAll("#"+e+"#",i)});return t}};window.BJUI=t}(jQuery);+function(e){"use strict";e(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}});BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"});BJUI.setRegional("orderby",{asc:"升序",desc:"降序"});BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"});BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询",import:"导入",export:"导出",all:"全部",true:"是",false:"否",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？"});BJUI.setRegional("progressmsg","正在努力加载数据，请稍等...");BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]});BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"});BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"});BJUI.setRegional("upload",{upConfirm:"开始上传",upPause:"暂停上传",upCancel:"取消上传"});BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！");BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！");BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！");BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！');BJUI.setRegional("notchecked","未选中任何一项！");BJUI.setRegional("selectmsg","请选择一个选项！");BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！");BJUI.setRegional("uititle","B-JUI");BJUI.setRegional("maintab","我的主页");})}(jQuery);+function(e){"use strict";BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}});BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"});BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"});BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"});BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query",import:"Import",export:"Export",all:"All",true:"True",false:"False",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?"});BJUI.setRegional("progressmsg","Data loading, please waiting...");BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"});BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"});BJUI.setRegional("upload",{upConfirm:"Start upload",upPause:"Pause upload",upCancel:"Cancel upload"});BJUI.setRegional("statusCode_503","The current server load is too large or is down for maintenance!");BJUI.setRegional("sessiontimeout","Session timeout, please login!");BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!");BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!');BJUI.setRegional("notchecked","Unchecked any one!");BJUI.setRegional("selectmsg","Please select one option!");BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!");BJUI.setRegional("uititle","B-JUI");BJUI.setRegional("maintab","My home");window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">'+'    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">'+'        <a class="close" href="#close" title="#close#"><i class="fa fa-times"></i></a>'+'        <a class="maximize" href="#maximize" title="#maximize#"><i class="fa fa-plus-circle"></i></a>'+'        <a class="restore" href="#restore" title="#restore#"><i class="fa fa-history"></i></a>'+'        <a class="minimize" href="#minimize" title="#minimize#"><i class="fa fa-minus-circle"></i></a>'+'        <h1><span class="title">#title#</span></h1>'+"    </div>"+'    <div class="dialogContent unitBox"></div>'+'    <div class="resizable_h_l" tar="nw"></div>'+'    <div class="resizable_h_r" tar="ne"></div>'+'    <div class="resizable_h_c" tar="n"></div>'+'    <div class="resizable_c_l" tar="w" style="height:100%;"></div>'+'    <div class="resizable_c_r" tar="e" style="height:100%;"></div>'+'    <div class="resizable_f_l" tar="sw"></div>'+'    <div class="resizable_f_r" tar="se"></div>'+'    <div class="resizable_f_c" tar="s"></div>'+"</div>",taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">'+'    <div class="taskbarContent">'+"        <ul></ul>"+"    </div>"+'    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>'+'    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div>'+"</div>",splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#msg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a>'+'<a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">'+'    <div class="panel-heading">'+'        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>'+"    </div>"+'    <div id="#id#" class="panel-collapse collapse#bodyclass#">'+'        <div class="panel-body">'+"        </div>"+"    </div>"+"</div>",pagination:'<ul class="pagination">'+'    <li class="j-first">'+'        <a class="first" href="javascript:;"><i class="fa fa-step-backward"></i> #first#</a>'+'        <span class="first"><i class="fa fa-step-backward"></i> #first#</span>'+"    </li>"+'    <li class="j-prev">'+'        <a class="previous" href="javascript:;"><i class="fa fa-backward"></i> #prev#</a>'+'        <span class="previous"><i class="fa fa-backward"></i> #prev#</span>'+"    </li>"+"    #pageNumFrag#"+'    <li class="j-next">'+'        <a class="next" href="javascript:;">#next# <i class="fa fa-forward"></i></a>'+'        <span class="next">#next# <i class="fa fa-forward"></i></span>'+"    </li>"+'    <li class="j-last">'+'        <a class="last" href="javascript:;">#last# <i class="fa fa-step-forward"></i></a>'+'        <span class="last">#last# <i class="fa fa-step-forward"></i></span>'+"    </li>"+'    <li class="jumpto"><span class="p-input"><input class="form-control input-sm-pages" type="text" size="2.6" value="#pageCurrent#" title="#jumpto#"></span><a class="goto" href="javascript:;" title="#jump#"><i class="fa fa-chevron-right"></i></a></li>'+"</ul>",gridPaging:'<ul class="pagination">'+'    <li class="page-total">'+'        <span title="#total#">#count#</span>'+"    </li>"+'    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>'+'    <li class="page-first btn-nav">'+'        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>'+"    </li>"+'    <li class="page-prev btn-nav">'+'        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>'+"    </li>"+'    <li class="page-next btn-nav">'+'        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>'+"    </li>"+'    <li class="page-last btn-nav">'+'        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>'+"    </li>"+"</ul>",gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">'+"    <ul>"+'        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>'+'        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>'+'        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>'+'        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>'+'        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>'+'        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>'+"    </ul>"+"</div>",gridFilter:'<div class="datagrid-filter-box">'+"<fieldset>"+"<legend>#label#</legend>"+'<span class="filter-a"></span>'+'<span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span>'+'<span class="filter-b"></span>'+'<span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span>'+"</fieldset>"+"</div>",gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn-green edit" data-icon="edit">#edit#</button>'+'<button type="button" class="btn-green update" data-icon="edit">#update#</button>'+'<button type="button" class="btn-green save" data-icon="check">#save#</button>'+'<button type="button" class="btn-orange cancel" data-icon="undo">#cancel#</button>'+'<button type="button" class="btn-orange delete" data-icon="remove">#del#</button>',gridDialogEditBtns:"<ul>"+'    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>'+'    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>'+'    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>'+'    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li>'+"</ul>",alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message#</div></div><div class="toolBar"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">'+'    <div class="main">'+'        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>'+'        <div class="head">'+'            <table width="100%" border="0" cellpadding="0" cellspacing="2">'+"                <tr>"+'                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>'+'                    <td><select name="year"></select></td>'+'                    <td><select name="month"></select></td>'+'                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>'+"                </tr>"+"            </table>"+"        </div>"+'        <div class="body">'+'            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>'+'            <dl class="days">\x3c!-- date list --\x3e</dl>'+'            <div style="clear:both;height:0;line-height:0"></div>'+"        </div>"+'        <div class="foot">'+'            <table class="time">'+"                <tr>"+"                    <td>"+'                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input'+'                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input'+'                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">'+"                    </td>"+'                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>'+"                </tr>"+"            </table>"+'            <button type="button" class="clearBtn btn btn-orange">#clear#</button>'+'            <button type="button" class="okBtn btn btn-default">#ok#</button>'+"        </div>"+'        <div class="tm">'+'            <ul class="hh">'+"                <li>0</li>"+"                <li>1</li>"+"                <li>2</li>"+"                <li>3</li>"+"                <li>4</li>"+"                <li>5</li>"+"                <li>6</li>"+"                <li>7</li>"+"                <li>8</li>"+"                <li>9</li>"+"                <li>10</li>"+"                <li>11</li>"+"                <li>12</li>"+"                <li>13</li>"+"                <li>14</li>"+"                <li>15</li>"+"                <li>16</li>"+"                <li>17</li>"+"                <li>18</li>"+"                <li>19</li>"+"                <li>20</li>"+"                <li>21</li>"+"                <li>22</li>"+"                <li>23</li>"+"            </ul>"+'            <ul class="mm">'+"                <li>0</li>"+"                <li>5</li>"+"                <li>10</li>"+"                <li>15</li>"+"                <li>20</li>"+"                <li>25</li>"+"                <li>30</li>"+"                <li>35</li>"+"                <li>40</li>"+"                <li>45</li>"+"                <li>50</li>"+"                <li>55</li>"+"            </ul>"+'            <ul class="ss">'+"                <li>0</li>"+"                <li>10</li>"+"                <li>20</li>"+"                <li>30</li>"+"                <li>40</li>"+"                <li>50</li>"+"            </ul>"+"        </div>"+"    </div>"+"</div>",spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',lookupBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="lookupbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">'+'    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>'+'    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>'+'    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>'+'    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li>'+"</ul>",dialogCM:'<ul id="bjui-dialogCM">'+'    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>'+'    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>'+'    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>'+'    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li>'+"</ul>",externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>',uploadTemp:'<div id="{fileId}" class="item">'+'    <div class="info">'+'        <span class="up_filename">{fileName}</span><span class="up_confirm" title="#upConfirm#"><i class="fa fa-play-circle-o"></i></span><span class="up_pause" title="#upPause#"><span class="glyphicon glyphicon-pause"></span></span><span class="up_cancel" title="#upCancel#"><i class="fa fa-times-circle-o"></i></span>'+"    </div>"+'    <div class="preview"><span class="img"></span></div>'+'    <div class="progress"><div class="bar"></div></div>'+'    <span class="percent">{percent}</span>'+'    <span class="filesize"><span class="uploadedsize">{uploadedSize}</span>/<span class="totalsize">{fileSize}</span></span>'+"</div>",uploadFrag:'<input class="bjui-upload-select-file" style="display:none;" type="file" name="fileselect[]" #multi# accept="#accept#">'+'<a href="javascript:void(0)" class="btn btn-default bjui-upload-select">#btnTxt#</a>'+'<div class="queue"></div>',statusCode_503:"HTTP status 503, #statusCode_503#",sessionTimout:"#sessiontimeout#",alertPlhMsg:"#plhmsg#",alertNoCheckGroup:"#nocheckgroup#",alertNotChecked:"#notchecked#",alertSelectMsg:"#selectmsg#",validateErrorMsg:"#validatemsg#",uiTitle:"#uititle#",mainTabTitle:"#mynavtab#"}}(jQuery);+function(e){"use strict";e.fn.extend({ajaxUrl:function(t){var i=e(this);i.trigger(BJUI.eventType.beforeAjaxLoad);if(t.loadingmask){i.trigger(BJUI.eventType.ajaxStatus)}e.ajax({type:t.type||"GET",url:t.url,data:t.data||{},cache:false,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(a){var n=a.toJson(),o=i.find("> .bjui-ajax-mask");if(!n[BJUI.keys.statusCode]){i.empty().html(a).append(o).initui();if(e.isFunction(t.callback))t.callback(a)}else{if(n[BJUI.keys.statusCode]==BJUI.statusCode.error){if(n[BJUI.keys.message])i.alertmsg("error",n[BJUI.keys.message]);if(!i.closest(".bjui-layout").length){if(i.closest(".navtab-panel").length)i.navtab("closeCurrentTab");else i.dialog("closeCurrent")}}else if(n[BJUI.keys.statusCode]==BJUI.statusCode.redirect){if(n.forward){if(n[BJUI.keys.message])i.alertmsg("ok",n[BJUI.keys.message]);i.dialog("reload",{url:n.forward})}else if(!i.closest(".bjui-layout").length){if(n[BJUI.keys.message])i.alertmsg("error",n[BJUI.keys.message]);if(i.closest(".navtab-panel").length)i.navtab("closeCurrentTab");else i.dialog("closeCurrent")}}else if(n[BJUI.keys.statusCode]==BJUI.statusCode.timeout){if(i.closest(".bjui-dialog").length)i.dialog("closeCurrent");if(i.closest(".navtab-panel").length)i.navtab("closeCurrentTab");e("body").alertmsg("info",n[BJUI.keys.message]||BJUI.regional.sessiontimeout);BJUI.loadLogin()}o.fadeOut("normal",function(){e(this).remove()})}},error:function(e,t,a){i.bjuiajax("ajaxError",e,t,a);if(!i.closest(".bjui-layout").length){if(i.closest(".navtab-panel").length)i.navtab("closeCurrentTab");else i.dialog("closeCurrent")}i.trigger("bjui.ajaxError")},statusCode:{503:function(e,t,a){i.alertmsg("error",FRAG.statusCode_503.replace("#statusCode_503#",BJUI.regional.statusCode_503)||a)},403:function(e,t,a){i.alertmsg("error","登录超时"||a);BJUI.loadLogin()}}})},loadUrl:function(t,i,a){e(this).ajaxUrl({url:t,data:i,callback:a})},doAjax:function(t){var i=e(this),a,n;if(!t.url){BJUI.debug("The ajax url is undefined!");return}if(!t.callback){BJUI.debug("The ajax callback is undefined!");return}else{t.callback=t.callback.toFunc()}if(t.loadingmask){a=i.getPageTarget();a.trigger(BJUI.eventType.ajaxStatus);n=a.find("> .bjui-ajax-mask")}if(!t.type)t.type="POST";if(!t.dataType)t.dataType="json";if(!t.cache)t.cache=false;t.timeout=BJUI.ajaxTimeout;t.success=function(i){if(n){if(t.callback){e.when(t.callback(i)).done(function(){a.trigger("bjui.ajaxStop")})}else{a.trigger("bjui.ajaxStop")}}else{t.callback(i)}};t.error=t.error||function(e,t,o){i.bjuiajax("ajaxError",e,t,o);if(n){a.trigger("bjui.ajaxError")}};e.ajax(t)},getPageTarget:function(){var t;if(this.closest(".bjui-layout").length)t=this.closest(".bjui-layout");else if(this.closest(".navtab-panel").length)t=e.CurrentNavtab;else t=e.CurrentDialog;return t},resizePageH:function(){return this.each(function(){if(e(this).closest(".tab-content").length)return;var t=e(this),i=t.find("> .bjui-pageHeader"),a=t.find("> .bjui-pageContent"),n=t.find("> .bjui-pageFooter"),o=i.outerHeight()||0,r=n.outerHeight()||0;if(t.hasClass("navtabPage")&&t.is(":hidden")){t.show();o=i.outerHeight()||0;r=n.outerHeight()||0;t.hide()}if(n.css("bottom"))r+=parseInt(n.css("bottom"))||0;if(r==0&&t.hasClass("dialogContent"))r=5;a.css({top:o,bottom:r})})},getMaxIndexObj:function(t){var i=0,a=0;t.each(function(t){var n=parseInt(e(this).css("zIndex"))||1;if(i<n){i=n;a=t}});return t.eq(a)},serializeJson:function(){var t={};var i=this.serializeArray();e.each(i,function(){if(t[this.name]!==undefined){if(!t[this.name].push){t[this.name]=[t[this.name]]}t[this.name].push(this.value||"")}else{t[this.name]=this.value||""}});return t},isTag:function(t){if(!t)return false;if(!e(this).prop("tagName"))return false;return e(this)[0].tagName.toLowerCase()==t?true:false},isBind:function(t){var i=e(this).data("events");return i&&t&&i[t]},log:function(e){return this.each(function(){if(console)console.log("%s: %o",e,this)})}});e.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(e){return this.indexOf(e)===0},endsWith:function(e){var t=this.length-e.length;return t>=0&&this.lastIndexOf(e)===t},replaceSuffix:function(e){return this.replace(/\[[0-9]+\]/,"["+e+"]").replace("#index#",e)},replaceSuffix2:function(e){return this.replace(/\-(i)([0-9]+)$/,"-i"+e).replace("#index#",e)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(e,t){return this.replace(new RegExp(e,"gm"),t)},replacePlh:function(t){t=t||e(document);return this.replace(/{\/?[^}]*}/g,function(e){var i=t.find(e.replace(/[{}]+/g,""));return i&&i.val()?i.val():e})},replaceMsg:function(e){return this.replace(new RegExp("({.*})","g"),e)},replaceTm:function(e){if(!e)return this;return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){return e[t.replace(/[{}]+/g,"")]})},replaceTmById:function(t){var i=t||e(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(e){var t=i.find("#"+e.replace(/[{}]+/g,""));return t.val()?t.val():e})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(e){if(!this||this.length===0)return"";if(this.charAt(0)===e)return this.substring(1).skipChar(e);return this},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){for(var e=0;e<this.length;e+=1){var t=this.charAt(e);if(t!=" "&&t!="\n"&&t!="\t"&&t!="\r")return false}return true},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&this.indexOf("://"+document.domain)==-1},toBool:function(){return this.toLowerCase()==="true"?true:false},toJson:function(){var e=this;try{if(typeof e=="object")e=e.toString();if(!e.trim().match("^{(.+:.+,*){1,}}$"))return this;else return JSON.parse(this)}catch(e){return this}},toObj:function(){var e=null;try{e=new Function("return "+this)()}catch(t){e=this;BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return e},toFunc:function(){if(!this||this.length==0)return undefined;if(this.startsWith("function")){return new Function("return "+this)()}var e=this.split(".");var t=window;for(var i=0;i<e.length;i++){t=t[e[i]]}if(typeof t==="function"){return t}return undefined},setUrlParam:function(e,t){var i="",a=this;if(a.indexOf("?")!=-1)i=a.substr(a.indexOf("?")+1);else return a+"?"+e+"="+t;var n="",o="",r,s="0";if(i.indexOf("&")!=-1){r=i.split("&");for(var l in r){if(r[l].split("=")[0]==e){o=t;s="1"}else{o=r[l].split("=")[1]}n=n+r[l].split("=")[0]+"="+o+"&"}n=n.substr(0,n.length-1);if(s=="0"){if(n==i)n=n+"&"+e+"="+t}}else{if(i.indexOf("=")!=-1){r=i.split("=");if(r[0]==e){o=t;s="1"}else{o=r[1]}n=r[0]+"="+o;if(s=="0"){if(n==i)n=n+"&"+e+"="+t}}else{n=e+"="+t}}return a.substr(0,a.indexOf("?"))+"?"+n}});e.extend(Function.prototype,{toFunc:function(){return this}});e.extend(Array.prototype,{remove:function(e){if(e<0)return this;else return this.slice(0,e).concat(this.slice(e+1,this.length))},unique:function(){var e=new Array;this.sort();for(var t=0;t<this.length;t++){if(this[t]==this[t+1])continue;e[e.length]=this[t]}return e},myIndexOf:function(e){if(!this||!this.length)return-1;for(var t=0,i;i=this[t];t++){if(i==e)return t}return-1},toJson:function(){var t={};var i=this;e.each(i,function(){if(t[this.name]!==undefined){if(!t[this.name].push){t[this.name]=[t[this.name]]}t[this.name].push(this.value||"")}else{t[this.name]=this.value||""}});return t}});e.isJson=function(t){var i=true;try{i=e.parseJSON(t)}catch(e){return false}return i?true:false}}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i};t.prototype.init=function(){var e=this;this.options.$obj=this.$element;if(this.options.obj)this.options.$obj=this.options.obj;if(this.options.event)this.start(this.options.event);else this.$element.find(this.options.selector).bind("mousedown",function(t){e.start.apply(e,[t])})};t.prototype.start=function(t){document.onselectstart=function(e){return false};var i=this;this.options.oleft=parseInt(this.$element.css("left"))||0;this.options.otop=parseInt(this.$element.css("top"))||0;e(document).bind("mouseup.bjui.basedrag",function(e){i.stop.apply(i,[e])}).bind("mousemove.bjui.basedrag",function(e){i.drag.apply(i,[e])})};t.prototype.drag=function(t){if(!t)t=window.event;var i=this.options;var a=i.oleft+(t.pageX||t.clientX)-i.event.pageX;var n=i.otop+(t.pageY||t.clientY)-i.event.pageY;if(n<1)n=0;if(i.move=="horizontal"){if(i.minW&&a>=parseInt(this.options.$obj.css("left"))+i.minW&&(i.maxW&&a<=parseInt(this.options.$obj.css("left"))+i.maxW)){this.$element.css("left",a)}else if(i.scop){if(i.relObj){if(a-parseInt(i.relObj.css("left"))>i.cellMinW)this.$element.css("left",a);else this.$element.css("left",a)}}}else if(i.move=="vertical"){this.$element.css("top",n)}else{var o=i.selector?this.options.$obj.find(i.selector):this.options.$obj;if(a>=-o.outerWidth()*2/3&&n>=0&&a+o.outerWidth()/3<e(window).width()&&n+o.outerHeight()<e(window).height()){this.$element.css({left:a,top:n})}}if(i.drag)i.drag.apply(this.$element,[this.$element,t]);return this.preventEvent(t)};t.prototype.stop=function(t){e(document).unbind("mousemove.bjui.basedrag").unbind("mouseup.bjui.basedrag");if(this.options.stop)this.options.stop.apply(this.$element,[this.$element,t]);if(this.options.event)this.destroy();document.onselectstart=function(e){return true};return this.preventEvent(t)};t.prototype.preventEvent=function(e){if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();return false};t.prototype.destroy=function(){this.$element.removeData("bjui.basedrag");if(!this.options.nounbind)this.$element.unbind("mousedown")};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},o.data(),typeof i=="object"&&i);var s=o.data("bjui.basedrag");if(!s)o.data("bjui.basedrag",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.basedrag;e.fn.basedrag=i;e.fn.basedrag.Constructor=t;e.fn.basedrag.noConflict=function(){e.fn.basedrag=a;return this}}(jQuery);+function(e){"use strict";e(function(){e("#bjui-leftside").after("\x3c!-- Adjust the width of Left slide --\x3e").after(FRAG.splitBar).after(FRAG.splitBarProxy)});var t=function(t,i){this.$element=e(t);this.$bar=this.$element.find("#bjui-sidebar");this.$sbar=this.$element.find("#bjui-sidebar-s");this.$lock=this.$bar.find("> .toggleCollapse > .lock");this.$new_lock=e("#menu_lock");this.$navtab=e("#bjui-navtab");this.$left_side=e("#bjui-leftside");this.$collapse=this.$sbar.find(".collapse");this.$split=e("#bjui-splitBar");this.$split2=e("#bjui-splitBarProxy");this.$window_shadow=e("#window-shadow");this.$catalog_tip=e("#catalog-tip");this.isfloat=false;this.options=i};t.prototype.lock=function(){var e=this;e.$window_shadow.addClass("show");e.$catalog_tip.addClass("show");e.$left_side.show().animate({left:0},500);e.$new_lock.data("lock","on")};t.prototype.unlock=function(){var t=this;t.$window_shadow.removeClass("show");t.$catalog_tip.removeClass("show");t.$left_side.animate({left:-230},500,function(){e(this).hide()});t.$new_lock.data("lock","off")};t.prototype._lock=function(){var t=this;var i=BJUI.windowWidth-236;t.$navtab.animate({left:230,width:i},400);t.$left_side.css("width","230px");t.$bar.animate({width:230},500,function(){e(window).trigger(BJUI.eventType.resizeGrid)});t._lg_menu();t.$new_lock.data("lock","on")};t.prototype._unlock=function(){var t=this;var i=BJUI.windowWidth-56;t.$navtab.animate({left:50,width:i},400);t.$left_side.css("width","50px");t.$bar.animate({width:50},500,function(){t.$sbar.animate({left:0},200);t.$split.hide();e(window).trigger(BJUI.eventType.resizeGrid)});t.$new_lock.data("lock","off");t._min_menu();t.isfloat=false};t.prototype._lg_menu=function(){var e=this;var t=e.$bar.find(".toggleCollapse");t.find(".logo-min").hide();t.find(".logo-lg").show();e.$bar.find(".sidebar-menu>li span").show()};t.prototype._min_menu=function(){var e=this;var t=e.$bar.find(".toggleCollapse");t.find(".logo-lg").hide();t.find(".logo-min").show();var i=e.$bar.find(".sidebar-menu>li");i.find("span").hide();e.$bar.one("click",".menu-items-tree",function(){e._lock()}).find(".menu-items-tree").removeClass("open").find(".menu-items").hide()};t.prototype.float=function(){var e=this;e.$sbar.animate({left:-10},200);e.$bar.addClass("shadown").animate({left:0},500);e.isfloat=true};t.prototype.hideFloat=function(){var e=this;var t=0-e.$bar.outerWidth()-0;e.$bar.animate({left:t-10},500,function(){e.$sbar.animate({left:0},100)});e.isfloat=false};t.prototype.hoverLock=function(){var e=this;e.$lock.hover(function(){e.tipUnLock();e.faUnLock()},function(){e.tipLock();e.faLock()})};t.prototype.hoverUnLock=function(){var e=this;e.$lock.hover(function(){e.tipLock();e.faLock()},function(){e.tipUnLock();e.faUnLock()})};t.prototype.tipLock=function(){this.$lock.tooltip("destroy").tooltip({title:"保持锁定，始终显示导航栏",container:"body"})};t.prototype.tipUnLock=function(){this.$lock.tooltip("destroy").tooltip({title:"解除锁定，自动隐藏导航栏",container:"body"})};t.prototype.faLock=function(){this.$lock.find("> i").attr("class","fa fa-lock")};t.prototype.faUnLock=function(){this.$lock.find("> i").attr("class","fa fa-unlock-alt")};t.prototype.init=function(){var t=this;t.$new_lock.data("lock","on");if(!BJUI.ui.showSlidebar){t.unlock()}else{t.hoverLock()}this.$new_lock.on("click",function(){if(t.$new_lock.hasClass("sm-collapse")){t.lock()}else{if(t.$new_lock.data("lock")=="on"){t._unlock()}else{t._lock()}}});this.$window_shadow.on("click",function(){t.unlock()});this.$lock.off("click.bjui.slidebar").on("click.bjui.slidebar",function(){if(t.isfloat){t.lock()}else{t.unlock()}BJUI.ui.showSlidebar=!BJUI.ui.showSlidebar});this.$collapse.hover(function(){t.float();t.$navtab.click(function(){if(t.isfloat)t.hideFloat()})});this.$split.mousedown(function(i){t.$split2.each(function(){var a=e(this);setTimeout(function(){a.show()},100);a.css({visibility:"visible",left:t.$split.css("left")}).basedrag(e.extend(t.options,{obj:t.$bar,move:"horizontal",event:i,stop:function(){e(this).css("visibility","hidden");var i=parseInt(e(this).css("left"))-parseInt(t.$split.css("left"));var a=t.$bar.outerWidth()+i;var n=parseInt(t.$navtab.css("left"))+i;var o=t.$navtab.outerWidth()-i;t.$bar.css("width",a);t.$split.css("left",e(this).css("left"));t.$navtab.css({left:n,width:o})}}));return false})});if(e("#bjui-hnav-navbar-box").length){t.moveHnav()}};t.prototype.moveHnav=function(){var t=e("#bjui-hnav-navbar-box"),i=t.find("> #bjui-hnav-navbar"),a=t.prev(),n=t.next();a.hover(function(){i.stop().animate({left:0},2e3,function(){a.hide()})},function(){i.stop();if(t.data("hnav.move")){n.show()}}).on("click",function(){i.stop().animate({left:0},"fast",function(){a.hide()});return false});n.hover(function(){i.stop().animate({left:t.width()-t.data("hnav.liw")-10},2e3,function(){n.hide()})},function(){i.stop();if(i.css("left")!="0px"){a.show()}}).on("click",function(){i.stop().animate({left:t.width()-t.data("hnav.liw")-10},"fast",function(){n.hide()});return false})};t.prototype.initHnav=function(){var t=this,i=t.$element.text().trim(),a=t.$element.parent(),n=e("#bjui-accordionmenu"),o,r,s,l;o=a.find("> .items > ul.ztree");r=a.find("> .items > ul.menu-items");if(!(o.length||r.length))return;if(o.length)l=o;if(r.length){if(!l)l=r;else l=l.add(r);r.find("a").each(function(){var t=e(this),i=t.data("options");if(!t.data("icon.init")&&i&&typeof i=="string"){i=i.toObj();if(i&&i.faicon){i.faicon=i.faicon.trim();if(i.faicon.startsWith("fa-"))i.faicon=i.faicon.substr(3);t.prepend('<i class="fa fa-'+i.faicon+'"></i>').data("icon.init",true).attr("title",t.text())}}})}n.empty();l.each(function(t){var a=e(this),o,r,l,d=a.data("faicon"),c=a.data("faiconClose"),f=d?d:"dot-circle-o";if(a.data("tit"))i=a.data("tit");r=t?"collapsed":"";l=t?"":" in";o=FRAG.slidePanel.replaceAll("#id#","bjui-collapse"+t).replaceAll("#title#",i).replaceAll("#righticon#",'<i class="fa fa-angle-down"></i>').replaceAll("#class#",r).replaceAll("#bodyclass#",l);if(f)o=o.replaceAll("#icon#",'<i class="fa fa-'+f+'"></i>');else o=o.replaceAll("#icon#","");s=e(o);s.find("> .panel-collapse > .panel-body").append(a.removeAttr("data-noinit"));n.append(s);if(!t)s.collapse("show")});e("#bjui-sidebar").initui();a.addClass("active").data("bjui.slidebar.hnav.panels",n.find("> .panel")).siblings().removeClass("active")};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},o.data(),typeof i=="object"&&i);var s=o.data("bjui.slidebar");if(!s)o.data("bjui.slidebar",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.slidebar;e.fn.slidebar=i;e.fn.slidebar.Constructor=t;e.fn.basedrag.noConflict=function(){e.fn.slidebar=a;return this};e(document).one(BJUI.eventType.afterInitUI,function(t){e("#bjui-leftside").slidebar({minW:150,maxW:700})});e(document).on("click.bjui.slidebar.data-api",'[data-toggle="slidebar"]',function(t){var a=e(this).parent(),n=e("#bjui-accordionmenu"),o=a.data("bjui.slidebar.hnav.panels");n.find("> .panel").detach();if(o&&o.length){n.append(o);a.addClass("active").siblings().removeClass("active")}else{i.call(e(this),"initHnav")}t.preventDefault()})}(jQuery);+function(e){"use strict";var t,i,a;e(function(){var n=function(){t=e('<div id="bjui-contextmenu"></div>').hide();i=e('<div id="bjui-contextmenuShadow"></div>').hide();a=[];e("body").append("\x3c!-- contextmenu --\x3e").append(t).append(i)};n()});var n=function(t,i){this.$element=e(t);this.options=i};n.DEFAULTS={id:undefined,shadow:true,bindings:{},ctrSub:null};n.prototype.init=function(){var e=this;var t=this.options;if(!t.id)return;a.push({id:t.id,shadow:t.shadow,bindings:t.bindings||{},ctrSub:t.ctrSub});var i=a.length-1;this.$element.on("contextmenu",function(a){e.display(i,this,a,t);return false})};n.prototype.display=function(n,o,r,s){var l=this;var d=a[n];var c=BJUI.regional[d.id];var f=FRAG[d.id];e.each(c,function(e,t){f=f.replace("#"+e+"#",c[e])});t.html(f);e.each(d.bindings,function(i,a){e('[rel="'+i+'"]',t).on("click",function(t){l.hide();a(e(o),e("#bjui-"+d.id))})});var u=r.pageX;var h=r.pageY;if(e(window).width()<u+t.width())u-=t.width();if(e(window).height()<h+t.height())h-=t.height();t.css({left:u,top:h}).show();if(d.shadow)i.css({width:t.width(),height:t.height(),left:u+3,top:h+3}).show();e(document).one("click",l.hide);if(e.isFunction(d.ctrSub))d.ctrSub(e(o),e("#bjui-"+d.id))};n.prototype.hide=function(){t.hide();i.hide()};n.prototype.show=function(t){var i=this;if(t.items&&t.items.length){i.$element.on("contextmenu",function(a){var n=true;if(t.exclude){i.$element.find(t.exclude).each(function(){if(this==a.target||e(this).find(a.target).length){n=false;return}})}if(!n){a.stopPropagation();return!n}else{i.custom(t.items,a)}return false})}};n.prototype.custom=function(a,n){t.empty().html("<ul></ul>");var o=this;var r=o.options;var s=t.find("> ul"),l;e.each(a,function(t,i){var a="";if(i.icon)a='<i class="fa fa-'+i.icon+'"></i>';if(i.title=="diver"){l=e('<li class="diver"></li>')}else{l=e('<li><span class="icon">'+a+'</span><span class="title">'+i.title+"</span></li>");if(i.func&&typeof i.func=="string")i.func=i.func.toFunc();if(i.func){l.on("click",function(e){o.hide();i.func(o.$element,l)})}}l.appendTo(s)});var d=n.pageX;var c=n.pageY;if(e(window).width()<d+t.width())d-=t.width();if(e(window).height()<c+t.height())c-=t.height();t.css({left:d,top:c}).show();if(r.shadow)i.css({width:t.width(),height:t.height(),left:d+3,top:c+3}).show();e(document).one("click",o.hide)};function o(t){var i=arguments;var a=t;return this.each(function(){var o=e(this);var r=e.extend({},n.DEFAULTS,o.data(),typeof t=="object"&&t);var s=o.data("bjui.contextmenu");if(!s)o.data("bjui.contextmenu",s=new n(this,r));if(typeof a=="string"&&e.isFunction(s[a])){[].shift.apply(i);if(!i)s[a]();else s[a].apply(s,i)}else{s.init()}})}var r=e.fn.contextmenu;e.fn.contextmenu=o;e.fn.contextmenu.Constructor=n;e.fn.contextmenu.noConflict=function(){e.fn.contextmenu=r;return this}}(jQuery);+function(e){"use strict";var t,i,a,n,o,r,s,l,d,c,f,u;var h;e(function(){var i=function(){t=0;n=e("#bjui-navtab");o=n.find(".navtab-tab");r=n.find(".navtab-panel");s=n.find(".tabsLeft");l=n.find(".tabsRight");d=n.find(".tabsMore");c=n.find(".tabsMoreList");f=o.find("li:first");u=c.find("li:first");s.click(function(){e(this).navtab("scrollPrev")});l.click(function(){e(this).navtab("scrollNext")});d.click(function(){c.show()});e(document).on("click.bjui.navtab.switchtab",function(t){var i=t.target.tagName=="I"?e(t.target).parent():e(t.target);if(d[0]!=i[0])c.hide()});var i,a;f.navtab("contextmenu",f).click(function(){e(this).navtab("switchTab","main").navtab("refresh","main")}).find("> a > span").html(function(e,t){return i=t.replace("#maintab#",BJUI.regional.maintab)});a=e.extend({},p.DEFAULTS,f.data(),{id:"main",title:i});f.data("initOptions",a).data("options",a);if(f.attr("data-url")){e(document).one(BJUI.eventType.initUI,function(e){f.removeAttr("data-url").navtab("reload",a)})}setTimeout(function(){f.navtab("switchTab","main")},50);u.click(function(){if(e(this).hasClass("active"))c.hide();else e(this).navtab("switchTab","main")}).find("> a").html(function(e,t){return t.replace("#maintab#",BJUI.regional.maintab)})};i()});var p=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS()};p.DEFAULTS={id:undefined,title:"New tab",url:undefined,type:"GET",data:{},loadingmask:true,fresh:false,autorefresh:false,onLoad:null,beforeClose:null,onClose:null};p.prototype.TOOLS=function(){var d=this;var f={getDefaults:function(){return p.DEFAULTS},getTabs:function(){return o.find("> li")},getPanels:function(){return r.find("> div")},getMoreLi:function(){return c.find("> li")},getTab:function(e){var t=this.indexTabId(e);if(t>=0)return this.getTabs().eq(t)},getPanel:function(e){var t=this.indexTabId(e);if(t>=0)return this.getPanels().eq(t)},getTabsW:function(e,t){return this.tabsW(this.getTabs().slice(e,t))},tabsW:function(t){var i=0;t.each(function(){i+=e(this).outerWidth(true)});return i},indexTabId:function(t){if(!t)return-1;var i=-1;this.getTabs().each(function(a){if(e(this).data("initOptions").id==t){i=a;return}});return i},getLeft:function(){return o.position().left},getScrollBarW:function(){return n.width()-55},visibleStart:function(){var e=this.getLeft(),t=0;var i=this.getTabs();for(var a=0;a<i.size();a++){if(t+e>=0)return a;t+=i.eq(a).outerWidth(true)}return 0},visibleEnd:function(){var e=this.getLeft(),t=0;var i=this.getTabs();for(var a=0;a<i.size();a++){t+=i.eq(a).outerWidth(true);if(t+e>this.getScrollBarW())return a}return i.size()},scrollPrev:function(){var e=this.visibleStart();if(e>0)this.scrollTab(-this.getTabsW(0,e-1))},scrollNext:function(){var e=this.visibleEnd();if(e<this.getTabs().size())this.scrollTab(-this.getTabsW(0,e+1)+this.getScrollBarW())},scrollTab:function(e,t){o.animate({left:e},200,function(){d.tools.ctrlScrollBtn()})},scrollCurrent:function(){var e=this.tabsW(this.getTabs()),i=this.getScrollBarW();if(e<=i)this.scrollTab(0);else if(this.getLeft()<i-e)this.scrollTab(i-e);else if(t<this.visibleStart())this.scrollTab(-this.getTabsW(0,t));else if(t>=this.visibleEnd())this.scrollTab(i-this.getTabs().eq(t).outerWidth(true)-this.getTabsW(0,t))},ctrlScrollBtn:function(){var e=this.tabsW(this.getTabs());if(this.getScrollBarW()>e){s.hide();l.hide();o.parent().removeClass("tabsPageHeaderMargin")}else{s.show().removeClass("tabsLeftDisabled");l.show().removeClass("tabsRightDisabled");o.parent().addClass("tabsPageHeaderMargin");if(this.getLeft()>=0)s.addClass("tabsLeftDisabled");else if(this.getLeft()<=this.getScrollBarW()-e)l.addClass("tabsRightDisabled")}},switchTab:function(n){var o=this.getTabs().removeClass("active").eq(n).addClass("active"),r=this.getPanels(),s=r.eq(n),l=d.options.onSwitch?d.options.onSwitch.toFunc():null;if(o.data("reloadFlag")){r.hide();s.show();d.refresh(o.data("initOptions").id)}else{r.hide();if(s.find(".bjui-ajax-mask").length){s.show()}else{s.addClass("fade").removeClass("in").show();if(e.support.transition)s.one("bsTransitionEnd",function(){s.addClass("in")}).emulateTransitionEnd(10);else s.removeClass("fade")}}this.getMoreLi().removeClass("active").eq(n).addClass("active");t=n;this.scrollCurrent();i=o;e.CurrentNavtab=a=s;if(l)l.apply(d);s.trigger("bjui.navtab.switch")},closeTab:function(e,i){var a=this.getTabs().eq(e);var n=this.getMoreLi().eq(e);var o=this.getPanels().eq(e);var r=a.data("options");var s=r.beforeClose?r.beforeClose.toFunc():null;var l=r.onClose?r.onClose.toFunc():null;var c=true;if(s)c=s.apply(d,[o]);if(!c){d.tools.switchTab(e);return}a.remove();n.remove();o.trigger(BJUI.eventType.beforeCloseNavtab).remove();if(h)clearInterval(h);if(l)l.apply(d);if(t>=e)t--;if(i){var f=this.indexTabId(i);if(f>0)t=f}this.scrollCurrent();this.switchTab(t)},closeOtherTab:function(i){i=i||t;this.getTabs().each(function(t){if(t>0&&i!=t)e(this).find("> .close").trigger("click")})},loadUrlCallback:function(e){e.find(":button.btn-close").click(function(){d.closeCurrentTab()})},reload:function(e,t){t=t||e.data("reloadFlag");var i=e.data("options");if(t){e.data("reloadFlag",false);var a=d.tools.getPanel(i.id);if(e.hasClass("external")){d.openExternal(i.url,a)}else{d.tools.reloadTab(a,i)}}},reloadTab:function(e,t){var i=t.onLoad?t.onLoad.toFunc():null,a=t.autorefresh&&(isNaN(String(t.autorefresh))?15:t.autorefresh);e.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:t.type||"GET",url:t.url,data:t.data||{},loadingmask:t.loadingmask,callback:function(n){d.tools.loadUrlCallback(e);if(i)i.apply(d,[e]);if(h)clearInterval(h);if(a)h=setInterval(function(){e.navtab("refresh")},a*1e3);if(BJUI.ui.clientPaging&&e.data("bjui.clientPaging"))e.pagination("setPagingAndOrderby",e);if(t.p_title){e.find(".bjui-pageHeader>.pageTitle").empty().html(t.p_title+">"+t.title)}else{e.find(".bjui-pageHeader>.pageTitle").empty().html(t.title)}}})}};return f};p.prototype.contextmenu=function(e){var i=this;e.contextmenu({id:"navtabCM",bindings:{reload:function(e,t){i.refresh(e.data("initOptions").id)},closeCurrent:function(e,t){var a=e.data("initOptions").id;if(a)i.closeTab(a);else i.closeCurrentTab()},closeOther:function(e,a){if(e.index()==0){i.closeAllTab()}else{var n=i.tools.indexTabId(e.data("initOptions").id);i.tools.closeOtherTab(n>0?n:t)}},closeAll:function(e,t){i.closeAllTab()}},ctrSub:function(e,t){var a=t.find('[rel="reload"]');var n=t.find('[rel="closeCurrent"]');var o=t.find('[rel="closeOther"]');var r=t.find('[rel="closeAll"]');var s=i.tools.getTabs();if(e.index()==0){n.addClass("disabled");if(!e.data("url"))a.addClass("disabled")}}})};p.prototype.openTab=function(){var i=this,a=this.$element,n=this.options,s=this.tools;if(!n.url&&n.href)n.url=n.href;if(!n.url){BJUI.debug("Navtab Plugin: Error trying to open a navtab, url is undefined!");return}else{n.url=decodeURI(n.url).replacePlh(a.closest(".unitBox"));if(!n.url.isFinishedTm()){a.alertmsg("error",n.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Navtab Plugin: The new navtab's url is incorrect, url: "+n.url);return}n.url=encodeURI(n.url)}var l=n.id?s.indexTabId(n.id):t;if(!n.id&&!BJUI.ui.overwriteHomeTab&&l==0){n.id="navtab";l=-1}if(l>=0){if(!n.id)delete n.id;var d=s.getTabs().eq(l);var f=s.getPanels().eq(l);var u=d.data("initOptions");var h=e.extend({},u,n);if(u.fresh||n.fresh||u.url!=n.url){i.reload(h)}t=l}else{var p='<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>';var d=e(p.replaceAll("#title#",n.title));var f=e('<div class="navtabPage unitBox"></div>');var g=e('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",n.title));d.appendTo(o);f.appendTo(r);g.appendTo(c);d.data("options",n).data("initOptions",n);if(n.external||n.url&&n.url.isExternalUrl()){d.addClass("external");this.openExternal(n.url,f)}else{d.removeClass("external");s.reloadTab(f,n)}t=s.getTabs().length-1;this.contextmenu(d);d.on("click",function(t){var a=e(t.target);if(a.hasClass("close"))i.closeTab(n.id);else if(a.closest("li").hasClass("active"))return false;else i.switchTab(n.id)});g.on("click",function(){i.switchTab(n.id)})}s.switchTab(t);s.scrollCurrent()};p.prototype.closeTab=function(e){var t=this.tools.indexTabId(e);if(t>0)this.tools.closeTab(t)};p.prototype.closeCurrentTab=function(e){if(t>0)this.tools.closeTab(t,e)};p.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").each(function(){e(this).trigger("click")})};p.prototype.reloadFlag=function(e){var i=e.split(",");for(var a=0;a<i.length;a++){var n=this.tools.getTab(i[a].trim());if(n){if(this.tools.indexTabId(i[a])==t)this.tools.reload(n,true);else n.data("reloadFlag",true)}}};p.prototype.switchTab=function(e){var t=this.tools.indexTabId(e);this.tools.switchTab(t)};p.prototype.scrollPrev=function(){this.tools.scrollPrev()};p.prototype.scrollNext=function(){this.tools.scrollNext()};p.prototype.refresh=function(e){var t,a;if(!e){t=i}else if(typeof e=="string"){t=this.tools.getTab(e)}else{t=e}if(t&&t.length){a=this.tools.getPanel(t.data("initOptions").id);a.removeData("bjui.clientPaging");this.reload(t.data("initOptions"))}};p.prototype.reload=function(i,a){var n=this;var o=e.extend({},typeof i=="object"&&i);var r=o.id?this.tools.getTab(o.id):this.tools.getTabs().eq(t);if(r){var s=r.data("initOptions")||{},l=e.extend({},s,o);var d=function(){if(s.title!=l.title)r.find("> a").attr("title",l.title).find("> span").html(l.title);if(!a)r.data("initOptions",l);r.data("options",l);n.tools.reload(r,true)};if(o.reloadWarn){this.$element.alertmsg("confirm",o.reloadWarn,{okCall:function(){d()}})}else{d()}}};p.prototype.reloadForm=function(i,a){var n=e.extend({},typeof a=="object"&&a);var o,r;if(typeof a=="string"){o=this.tools.getTab(a);r=this.tools.getPanel(a)}else{o=n.id?this.tools.getTab(n.id):this.tools.getTabs().eq(t);r=n.id?this.tools.getPanel(n.id):this.tools.getPanels().eq(t)}if(o&&r){if(!o.hasClass("external")){var s=r.find("#pagerForm"),l={},d={};if(s.attr("action"))n.url=s.attr("action");if(s&&s.length){d=s.serializeJson();if(!a||!a.type)n.type=s.attr("method")||"POST";if(i){var c=BJUI.pageInfo;d[c["orderDirection"]]=d[c["orderField"]]="";r.data("bjui.clientPaging").orderDirection=r.data("bjui.clientPaging").orderField="";for(var f in c){l[c[f]]=d[c[f]]}}else{l=d}n.data=e.extend({},n.data||{},l)}}this.reload(n,true)}};p.prototype.reloadSearchMore=function(i,a,n){var o=e.extend({},typeof a=="object"&&a);var r,s;if(typeof a=="string"){r=this.tools.getTab(a);s=this.tools.getPanel(a)}else{r=o.id?this.tools.getTab(o.id):this.tools.getTabs().eq(t);s=o.id?this.tools.getPanel(o.id):this.tools.getPanels().eq(t)}if(r&&s){if(!r.hasClass("external")){var l=s.find("#pagerForm");if(l.attr("action"))o.url=l.attr("action");if(!a||!a.type)o.type=l.attr("method")||"POST";if(i){n.orderDirection=n.orderField="";s.data("bjui.clientPaging").orderDirection=s.data("bjui.clientPaging").orderField=""}n.pageCurrent="1";n.pageSize="20";o.data=e.extend({},o.data||{},n)}this.reload(o,true)}};p.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(t)};p.prototype.checkTimeout=function(){var e=JSON.parse(a.html());if(e&&e[BJUI.keys.statusCode]==BJUI.statusCode.timeout)this.closeCurrentTab()};p.prototype.openExternal=function(e,t){var i=t.closest(".navtab-panel").height();t.html(FRAG.externalFrag.replaceAll("{url}",e).replaceAll("{height}",i+"px"))};function g(t){var i=arguments;var a=t;return this.each(function(){var n=e(this);var o=e.extend({},p.DEFAULTS,typeof t=="object"&&t);var r=n.data("bjui.navtab");if(!r)n.data("bjui.navtab",r=new p(this,o));if(typeof a=="string"&&e.isFunction(r[a])){[].shift.apply(i);if(!i)r[a]();else r[a].apply(r,i)}else{r=new p(this,o);r.openTab()}})}var m=e.fn.navtab;e.fn.navtab=g;e.fn.navtab.Constructor=p;e.fn.navtab.noConflict=function(){e.fn.navtab=m;return this};e(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(t){var i=e(this),a=i.attr("href"),n=i.data(),o=n.options;if(o){if(typeof o=="string")o=o.toObj();if(typeof o=="object")e.extend(n,o)}if(!n.title)n.title=i.text();if(a&&!n.url)n.url=a;g.call(i,n);t.preventDefault()})}(jQuery);+function(e){"use strict";var t;var i,a,n;e(function(){var i=function(){t=e("#bjui-resizable");a="dialogShadow";n=o.ZINDEX;e("body").append("\x3c!-- dialog resizable --\x3e").append(FRAG.resizable)};i()});var o=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS()};o.DEFAULTS={id:"dialog",title:"New Dialog",url:undefined,type:"GET",data:{},loadingmask:true,width:500,height:300,minW:65,minH:40,max:false,mask:true,resizable:true,drawable:true,maxable:false,minable:true,closeable:true,fresh:false,onLoad:null,beforeClose:null,onClose:null,current:false};o.ZINDEX=30;o.prototype.TOOLS=function(){var t=this;var i={getDefaults:function(){return o.DEFAULTS},init:function(i){var n=t.options.width>t.options.minW?t.options.width:t.options.minW;var o=t.options.height>t.options.minH?t.options.height:t.options.minH;var r=e(window).width(),s=e(window).height(),l=t.options.max?0:(s-o)/2;if(n>r)n=r;if(o>s)o=s;i.height(o).width(n).show().css({left:(r-n)/2,top:0,opacity:.1}).animate({top:l>0?l:0,opacity:1}).addClass(a).find("> .dialogContent").height(o-e("> .dialogHeader",i).outerHeight()-6);e("body").find("> .bjui-dialog-container").not(i).removeClass(a)},reload:function(i,a){var n=i.find("> .dialogContent"),o;a=a||i.data("initOptions");o=a.onLoad?a.onLoad.toFunc():null;i.trigger(BJUI.eventType.beforeLoadDialog);if(a.url){n.ajaxUrl({type:a.type||"GET",url:a.url,data:a.data||{},loadingmask:a.loadingmask,callback:function(e){if(o)o.apply(t,[i]);if(BJUI.ui.clientPaging&&i.data("bjui.clientPaging"))i.pagination("setPagingAndOrderby",i)}})}else if(a.target){var r;if(a.current){if(a.current=="navtab")r=e.CurrentNavtab.find(a.target).html();else if(a.current=="dialog")r=i.find(a.target).html()}else r=e(a.target).html()||i.data("bjui.dialog.target");e(a.target).empty();i.data("bjui.dialog.target",r);n.trigger(BJUI.eventType.beforeAjaxLoad).html(r).initui();if(o)o.apply(t,[i])}},resizeContent:function(t,i,a){var n=t.find("> .dialogContent");n.css({width:i-12,height:a-t.find("> .dialogHeader").outerHeight()-6}).resizePageH();e(window).trigger(BJUI.eventType.resizeGrid)}};return i};o.prototype.open=function(){var t=this,a=t.options;var o=e("body");var r=o.data(a.id);if(!a.target||!e(a.target).length){if(!a.url&&a.href)a.url=a.href;if(!a.url){BJUI.debug("Dialog Plugin: Error trying to open a dialog, url is undefined!");return}else{a.url=decodeURI(a.url).replacePlh(t.$element.closest(".unitBox"));if(!a.url.isFinishedTm()){t.$element.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Dialog Plugin: The new dialog's url is incorrect, url: "+a.url);return}a.url=encodeURI(a.url)}}else{a.url=undefined}if(r){var s=r.data("initOptions")||a;this.switchDialog(r);if(r.is(":hidden"))r.show();if(s.fresh||a.fresh||!s.url||s.url!=a.url){t.reload(a);r.data("initOptions",a)}}else{var l=BJUI.regional.dialog;var d=FRAG.dialog.replace("#close#",l.close).replace("#maximize#",l.maximize).replace("#restore#",l.restore).replace("#minimize#",l.minimize).replace("#title#",l.title);r=e(d).data("options",a).data("initOptions",a).css("zIndex",n+=1).hide().appendTo(o);r.find("> .dialogHeader > h1 > span.title").html(a.title);this.tools.init(r);if(a.maxable)r.find("a.maximize").show();else r.find("a.maximize").hide();if(a.minable)r.find("a.minimize").show();else r.find("a.minimize").hide();if(a.closeable)r.find("a.close").show();else r.find("a.close").hide();if(a.max)t.maxsize(r);if(a.mask)this.addMask(r);else if(a.minable&&e.fn.taskbar)this.$element.taskbar({id:a.id,title:a.title});r.on("click",function(a){if(!e(a.target).data("bjui.dialog"))if(i&&i[0]!=r[0])t.switchDialog(r)}).on("click",".btn-close",function(e){t.close(r);e.preventDefault()}).on("click",".dialogHeader > a",function(i){var a=e(this);if(a.hasClass("close"))t.close(r);if(a.hasClass("minimize")){t.minimize(r)}if(a.hasClass("maximize")){t.switchDialog(r);t.maxsize(r)}if(a.hasClass("restore"))t.restore(r);i.preventDefault();i.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(e){if(a.maxable){if(r.find("> .dialogHeader > a.restore").is(":hidden"))r.find("a.maximize").trigger("click");else r.find("> .dialogHeader > a.restore").trigger("click")}}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(i){t.switchDialog(r);if(!a.drawable||r.data("max"))return;r.data("bjui.dialog.task",true);setTimeout(e.proxy(function(){if(r.data("bjui.dialog.task"))t.drag(i,r)},t),150);i.preventDefault()}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(e){r.data("bjui.dialog.task",false)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(i){if(!a.drawable||r.data("max"))return;var n=e(this);t.switchDialog(r);t.resizeInit(i,e("#bjui-resizable"),r,n);n.show();i.preventDefault()}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(e){e.preventDefault()});o.data(a.id,r);this.tools.reload(r,a)}e.CurrentDialog=i=r};o.prototype.addMask=function(t){var i=t.data("bjui.dialog.mask");t.wrap('<div style="z-index:'+n+'" class="bjui-dialog-wrap"></div>');t.find("> .dialogHeader > a.minimize").hide();if(!i||!i.length){i=e(FRAG.dialogMask);i.css("zIndex",1).show().insertBefore(t);t.data("bjui.dialog.mask",i)}};o.prototype.refresh=function(t){if(t&&typeof t=="string"){var a=t.split(",");for(var n=0;n<a.length;n++){var o=e("body").data(a[n].trim());if(o){o.removeData("bjui.clientPaging");this.tools.reload(o)}}}else{i.removeData("bjui.clientPaging");this.tools.reload(i)}};o.prototype.reload=function(t,i){var a=this;var n=e.extend({},typeof t=="object"&&t);var o=n.id&&e("body").data(n.id)||a.getCurrent();if(o&&o.length){var r=o.data("initOptions"),s=e.extend({},r,n);var l=function(){var t=o.find("> .dialogContent");if(r.width!=s.width){if(!s.max){o.animate({width:s.width},"normal",function(){t.width(s.width)})}else{o.width(s.width);t.width(s.width)}}if(r.height!=s.height){if(!s.max){o.animate({height:s.height},"normal",function(){t.height(s.height-o.find("> .dialogHeader").outerHeight()-6).resizePageH()})}else{o.height(s.height);t.height(s.height-o.find("> .dialogHeader").outerHeight()-6)}}if(r.maxable!=s.maxable){if(s.maxable)o.find("a.maximize").show();else o.find("a.maximize").hide()}if(r.minable!=s.minable){if(s.minable)o.find("a.minimize").show();else o.find("a.minimize").hide()}if(r.max!=s.max&&s.max)setTimeout(a.maxsize(o),10);if(r.mask!=s.mask){if(s.mask){a.addMask(o);if(e.fn.taskbar)a.$element.taskbar("closeDialog",s.id)}else if(s.minable&&e.fn.taskbar){a.$element.taskbar({id:s.id,title:s.title})}}if(r.title!=s.title){o.find("> .dialogHeader > h1 > span.title").html(s.title);o.taskbar("changeTitle",s.id,s.title)}o.data("options",s);if(!i)o.data("initOptions",s);a.tools.reload(o,s)};if(s.reloadWarn){o.alertmsg("confirm",s.reloadWarn,{okCall:function(){l()}})}else{l()}}};o.prototype.reloadForm=function(t,i){var a,n;if(typeof i=="string"){a=e("body").data(i);n=a.data("options")}else if(typeof i=="object"){a=i.id&&e("body").data(i.id)||this.getCurrent()}if(a){if(typeof i=="object"){if(i.title)a.find("> .dialogHeader > h1 > span.title").html(i.title);n=e.extend({},i,a.data("options"))}var o=a.find("#pagerForm"),r={},s={};if(o.attr("action"))n.url=o.attr("action");if(o&&o.length){s=o.serializeJson();if(!i||!i.type)n.type=o.attr("method")||"POST";if(t){var l=BJUI.pageInfo;for(var d in l){r[l[d]]=s[l[d]]}}else{r=s}if(n.newquery){n.data=r}else{n.data=e.extend({},n.data||{},r)}}this.reload(n,true)}};o.prototype.getCurrent=function(){return i};o.prototype.switchDialog=function(t){var n=t.css("zIndex");if(i&&i!=t){var o=i.css("zIndex");i.css("zIndex",n);t.css("zIndex",o);e.CurrentDialog=i=t;if(e.fn.taskbar)this.$element.taskbar("switchTask",t.data("options").id)}t.addClass(a);e("body").find("> .bjui-dialog-container").not(t).removeClass(a)};o.prototype.close=function(t){var a=this;var r=typeof t=="string"?e("body").data(t):t;var s=r.data("bjui.dialog.mask");var l=r.data("options");var d=r.data("bjui.dialog.target");var c=l.beforeClose?l.beforeClose.toFunc():null;var f=l.onClose?l.onClose.toFunc():null;var u=true;if(!r||!l)return;if(c)u=c.apply(a,[r]);if(!u){a.switchDialog(r);return}if(l.target&&d)e(l.target).html(d);if(s&&s.length){s.remove();r.unwrap()}else if(e.fn.taskbar){this.$element.taskbar("closeDialog",l.id)}r.animate({top:-r.outerHeight(),opacity:.1},"normal",function(){e("body").removeData(l.id);r.trigger(BJUI.eventType.beforeCloseDialog).remove();if(f)f.apply(a);var t=e("body").find(".bjui-dialog-container");var s=undefined;if(t.length){s=a.$element.getMaxIndexObj(t)}else{n=o.ZINDEX;i=null}if(s&&s.is(":visible"))a.switchDialog(s)})};o.prototype.closeCurrent=function(){this.close(i)};o.prototype.checkTimeout=function(){var e=i.find("> .dialogContent");var t=JSON.parse(e.html());if(t&&t[BJUI.keys.statusCode]==BJUI.statusCode.timeout)this.closeCurrent()};o.prototype.maxsize=function(t){t.data("original",{top:t.css("top"),left:t.css("left"),width:t.css("width"),height:t.css("height")}).data("max",true);t.find("> .dialogHeader > a.maximize").hide();t.find("> .dialogHeader > a.restore").show();var i=e(window).width();var a=e(window).height()-e("#bjui-taskbar").height()-1;t.css({top:0,left:0,width:i,height:a});this.tools.resizeContent(t,i,a)};o.prototype.restore=function(e){var t=e.data("original");var i=parseInt(t.width);var a=parseInt(t.height);e.css({top:t.top,left:t.left,width:i,height:a});this.tools.resizeContent(e,i,a);e.find("> .dialogHeader > a.maximize").show();e.find("> .dialogHeader > a.restore").hide();e.data("max",false)};o.prototype.minimize=function(t){t.hide();if(e.fn.taskbar)this.$element.taskbar("minimize",t)};o.prototype.drag=function(t,i){var a=e("#bjui-dialogProxy");i.find("> .dialogContent").css("opacity",".3");i.basedrag({selector:"> .dialogHeader",stop:function(){i.css({left:i.css("left"),top:i.css("top")}).find("> .dialogContent").css("opacity",1)},event:t,nounbind:true})};o.prototype.resizeDialog=function(t,i,a){var n;var o=parseInt(t.css("left"));var r=parseInt(t.css("top"));var s=parseInt(t.css("height"));var l=parseInt(t.css("width"));if(a=="n"||a=="nw")n=parseInt(i.css("top"))-r;else n=s-parseInt(i.css("height"));if(r<0)r=0;i.css({top:r,left:o,width:l+2,height:s+1}).find("> .dialogContent").css("width",l-10);if(a!="w"&&a!="e"){var d=i.find("> .dialogContent");d.css({height:s-i.find("> .dialogHeader").outerHeight()-6}).resizePageH()}e(window).trigger(BJUI.eventType.resizeGrid)};o.prototype.resizeInit=function(t,i,a,n){var o=this;var r=n.attr("tar");e("body").css("cursor",r+"-resize");i.css({top:a.css("top"),left:a.css("left"),height:a.outerHeight(),width:a.css("width")}).show();if(!this.options.dragCurrent){this.options.dragCurrent={$resizable:i,$dialog:a,target:r,oleft:parseInt(i.css("left"))||0,owidth:parseInt(i.css("width"))||0,otop:parseInt(i.css("top"))||0,oheight:parseInt(i.css("height"))||0,ox:t.pageX||t.screenX,oy:t.pageY||t.clientY};e(document).on("mouseup.bjui.dialog.resize",e.proxy(o.resizeStop,o));e(document).on("mousemove.bjui.dialog.resize",e.proxy(o.resizeStart,o))}};o.prototype.resizeStart=function(t){var i=this.options.dragCurrent;if(!i)return;if(!t)var t=window.event;var a=(t.pageX||t.screenX)-i.ox;var n=(t.pageY||t.clientY)-i.oy;var o=i.$dialog.data("bjui.dialog.mask");if(!o||!o.length)if((t.pageY||t.clientY)<=0||(t.pageY||t.clientY)>=e(window).height()-i.$dialog.find("> .dialogHeader").outerHeight())return;var r=i.target;var s=i.owidth;var l=i.oheight;if(r!="n"&&r!="s")s+=r.indexOf("w")>=0?-a:a;if(s>=this.options.minW){if(r.indexOf("w")>=0)i.$resizable.css("left",i.oleft+a);if(r!="n"&&r!="s")i.$resizable.css("width",s)}if(r!="w"&&r!="e")l+=r.indexOf("n")>=0?-n:n;if(l>=this.options.minH){if(r.indexOf("n")>=0)i.$resizable.css("top",i.otop+n);if(r!="w"&&r!="e")i.$resizable.css("height",l)}};o.prototype.resizeStop=function(t){var i=this.options.dragCurrent;if(!i)return false;e(document).off("mouseup.bjui.dialog.resize");e(document).off("mousemove.bjui.dialog.resize");this.options.dragCurrent=null;this.resizeDialog(i.$resizable,i.$dialog,i.target);e("body").css("cursor","");i.$resizable.hide()};function r(t){var i=arguments;var a=t;return this.each(function(){var n=e(this);var r=e.extend({},o.DEFAULTS,typeof t=="object"&&t);var s=n.data("bjui.dialog");if(!s)n.data("bjui.dialog",s=new o(this,r));if(typeof a=="string"&&e.isFunction(s[a])){[].shift.apply(i);if(!i)s[a]();else s[a].apply(s,i)}else{s=new o(this,r);s.open()}})}var s=e.fn.dialog;e.fn.dialog=r;e.fn.dialog.Constructor=o;e.fn.dialog.noConflict=function(){e.fn.dialog=s;return this};e(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(t){var i=e(this),a=i.attr("href"),n=i.data(),o=n.options;if(o){if(typeof o=="string")o=o.toObj();if(typeof o=="object")e.extend(n,o)}if(!n.title)n.title=i.text();if(a&&!n.url)n.url=a;r.call(i,n);t.preventDefault()})}(jQuery);+function(e){"use strict";var t;var i,a,n,o,r,s,l,d;e(function(){var c=function(){t=e("#bjui-resizable");i=e(FRAG.taskbar);a=i.find(".taskbarContent");n=a.find("> ul");o=i.find(".taskbarLeft");r=i.find(".taskbarRight");s="disabled";l="selected";d="taskbarMargin";e("body").append("\x3c!-- dialog task bar --\x3e").append(i);o.click(function(t){e(this).taskbar("scrollLeft")});r.click(function(t){e(this).taskbar("scrollRight")})};c()});var c=function(t,i){this.$element=e(t);this.$task=null;this.options=i;this.tools=this.TOOLS()};c.DEFAULTS={id:undefined,title:undefined};c.prototype.init=function(){var t=this;var i=n.find("#"+this.options.id);this.show();if(!i.length){var a='<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>';i=e(a.replace("#taskid#",this.options.id).replace("#title#",this.options.title));i.appendTo(n)}else{i.find("> div > span.title").html(this.options.title)}this.contextmenu(i);this.switchTask(i);this.tools.scrollTask(i);i.click(function(a){if(e(a.target).closest("div").hasClass("close")||e(a.target).hasClass("close")){i.dialog("close",t.options.id)}else{var n=e("body").data(t.options.id);if(i.hasClass("selected")){n.find(".dialogHeader a.minimize").trigger("click")}else{if(n.is(":hidden")){t.restoreDialog(n)}else{n.trigger("click");i.addClass(l)}}t.scrollCurrent(i)}return false})};c.prototype.TOOLS=function(){var t=this;var c={scrollCurrent:function(){var e=this.tasksW(this.getTasks());if(e>this.getTaskBarW()){var t=this;var i=n.find("> li:last-child");var a=this.getTaskBarW()-i.position().left-i.outerWidth(true);n.animate({left:a},200,function(){t.ctrlScrollBtn()})}else{this.ctrlScrollBtn()}},getTaskBarW:function(){return a.width()-(o.is(":hidden")?o.width()+2:0)-(r.is(":hidden")?r.width()+2:0)},scrollTask:function(e){var t=this;if(e.position().left+this.getLeft()+e.outerWidth()>this.getBarWidth()){var i=this.getTaskBarW()-e.position().left-e.outerWidth(true)-2;n.animate({left:i},200,function(){t.ctrlScrollBtn()})}else if(e.position().left+this.getLeft()<0){var i=this.getLeft()-(e.position().left+this.getLeft());n.animate({left:i},200,function(){t.ctrlScrollBtn()})}},ctrlScrollBtn:function(){var e=this.tasksW(this.getTasks());if(this.getTaskBarW()>e){a.removeClass(d);r.hide();o.hide();if(this.getTasks().eq(0).length)this.scrollTask(this.getTasks().eq(0))}else{a.addClass(d);r.show().removeClass(s);o.show().removeClass(s);if(this.getLeft()>=0)o.addClass(s);if(this.getLeft()<=this.getTaskBarW()-e)r.addClass(s)}},getLeft:function(){return n.position().left},visibleStart:function(){var e=this.getLeft();var t=this.getTasks();for(var i=0;i<t.size();i++){if(t.eq(i).position().left+t.eq(i).outerWidth(true)+e>=0)return t.eq(i)}return t.eq(0)},visibleEnd:function(){var e=this.getLeft();var t=this.getTasks();for(var i=0;i<t.size();i++){if(t.eq(i).position().left+t.eq(i).outerWidth(true)+e>this.getBarWidth())return t.eq(i)}return t.eq(t.size()-1)},getTasks:function(){return n.find("> li")},tasksW:function(t){var i=0;t.each(function(){i+=e(this).outerWidth(true)});return i},getBarWidth:function(){return i.innerWidth()},getCurrent:function(){return n.find("li."+l)}};return c};c.prototype.contextmenu=function(t){var i=this;t.contextmenu({id:"dialogCM",bindings:{reload:function(e){e.dialog("refresh",i.options.id)},closeCurrent:function(e,t){var a=e.isTag("li")?e:i.tools.getCurrent();a.find(".close").trigger("click")},closeOther:function(t,i){var a=n.find("> li").not(t);a.each(function(t){e(this).find(".close").trigger("click")})},closeAll:function(t,a){var n=i.tools.getTasks();n.each(function(t){e(this).find(".close").trigger("click")})}},ctrSub:function(e,t){var a=t.find('[rel="closeCurrent"]');var n=t.find('[rel="closeOther"]');if(!i.tools.getCurrent().length){a.addClass(s);n.addClass(s)}else{if(i.tools.getTasks().size()==1)n.addClass(s)}}})};c.prototype.closeDialog=function(e){var t=typeof e=="string"?this.getTask(e):e;if(!t||!t.length)return;t.remove();if(this.tools.getTasks().size()==0){this.hide()}this.tools.scrollCurrent();this.$element.removeData("bjui.taskbar")};c.prototype.minimize=function(i){var a=this;var n=typeof i=="string"?e("body").data("dialog"):i;var o=this.getTask(n.data("options").id);t.css({top:n.css("top"),left:n.css("left"),height:n.css("height"),width:n.css("width")}).show().animate({top:e(window).height()-60,left:o.position().left,width:o.outerWidth(),height:o.outerHeight()},250,function(){e(this).hide();a.inactive(o)})};c.prototype.restoreDialog=function(i){var a=this.getTask(i.data("options").id);t.css({top:e(window).height()-60,left:a.position().left,height:a.outerHeight(),width:a.outerWidth()}).show().animate({top:i.css("top"),left:i.css("left"),width:i.css("width"),height:i.css("height")},250,function(){e(this).hide();i.show()});this.switchTask(a)};c.prototype.inactive=function(e){var t=typeof e=="string"?this.getTask(e):e;t.removeClass(l)};c.prototype.scrollLeft=function(){var e=this.tools.visibleStart();this.tools.scrollTask(e)};c.prototype.scrollRight=function(){var e=this.tools.visibleEnd();this.tools.scrollTask(e)};c.prototype.scrollCurrent=function(e){this.tools.scrollTask(e)};c.prototype.switchTask=function(e){this.tools.getCurrent().removeClass(l);var t=typeof e=="string"?this.getTask(e):e;t.addClass(l)};c.prototype.getTask=function(e){return n.find("#"+e)};c.prototype.changeTitle=function(e,t){var i=this.getTask(e);if(i&&t)i.find(".title").html(t)};c.prototype.show=function(){if(i.is(":hidden"))i.show().animate({bottom:0},500)};c.prototype.hide=function(){if(i.is(":visible"))i.animate({bottom:-50},500,function(){i.hide()})};function f(t){var i=arguments;var a=t;return this.each(function(){var n=e(this);var o=e.extend({},c.DEFAULTS,n.data(),typeof t=="object"&&t);var r=n.data("bjui.taskbar");if(!r)n.data("bjui.taskbar",r=new c(this,o));else if(r.options.id!=o.id)n.data("bjui.taskbar",r=new c(this,o));if(typeof a=="string"&&e.isFunction(r[a])){[].shift.apply(i);if(!i)r[a]();else r[a].apply(r,i)}else{r.init()}})}var u=e.fn.taskbar;e.fn.taskbar=f;e.fn.taskbar.Constructor=c;e.fn.taskbar.noConflict=function(){e.fn.taskbar=u;return this}}(jQuery);+function(e){"use strict";var t;var i=function(t,i){var a=this;this.$element=e(t);this.options=i;this.tools=this.TOOLS()};i.DEFAULTS={reload:true,loadingmask:true,searchmore:false};i.NAVTAB="navtab";i.prototype.TOOLS=function(){var t=this;var a={getPagerForm:function(t,i){var a=t.isTag("form")?t[0]:t.find("#pagerForm:first")[0];var n=e.extend({},BJUI.pageInfo);if(t.data("bjui.clientPaging")){i=e.extend({},t.data("bjui.clientPaging"),i);t.data("bjui.clientPaging",i)}if(a){for(var o in n){var r="";if(i&&i[o])r=i[o];if(!a[n[o]])e('<input type="hidden" name="'+n[o]+'" value="'+r+'">').appendTo(e(a));else if(r)a[n[o]].value=r}}return a},getTarget:function(){if(t.$element.closest(".navtab-panel").length)return i.NAVTAB;else return"dialog"}};return a};i.prototype.ajaxForm=function(t){var i=this;var a=this.$element,n=t&&t.callback,o=a.attr("enctype");t=e.extend({},i.options,typeof t=="object"&&t);if(n)n=n.toFunc();var r=function(t,o,r){n?n.apply(i,[t,a]):e.proxy(i.ajaxCallback(t),i)};var s=function(){var n={loadingmask:t.loadingmask,type:a.attr("method"),url:a.attr("action"),callback:r,error:e.proxy(i.ajaxError,i)};if(o&&o=="multipart/form-data"){if(window.FormData){e.extend(n,{data:new FormData(a[0]),contentType:false,processData:false})}else{e.extend(n,{data:a.serializeArray(),files:a.find(":file"),iframe:true,processData:false})}}else{e.extend(n,{data:a.serializeArray()})}a.doAjax(n)};if(t.confirmMsg){a.alertmsg("confirm",t.confirmMsg,{okCall:s})}else{s()}};i.prototype.ajaxDone=function(e){var t=this.$element;if(e[BJUI.keys.statusCode]==BJUI.statusCode.error){if(e[BJUI.keys.message])t.alertmsg("error",e[BJUI.keys.message])}else if(e[BJUI.keys.statusCode]==BJUI.statusCode.timeout){t.alertmsg("info",e[BJUI.keys.message]||FRAG.sessionTimout);BJUI.loadLogin()}else if(e[BJUI.keys.statusCode]==BJUI.statusCode.warn){if(e[BJUI.keys.message])t.alertmsg("warn",e[BJUI.keys.message])}else{if(e[BJUI.keys.message])t.alertmsg("correct",e[BJUI.keys.message])}};i.prototype.ajaxError=function(e,t,i){var a=e.responseText.trim();if(a.startsWith("{")){this.ajaxDone(a.toObj())}else{this.$element.alertmsg("error","<div>Http status: "+e.status+" "+e.statusText+"</div>"+"<div>ajaxOptions: "+t+" </div>"+"<div>thrownError: "+i+" </div>"+"<div>"+a+"</div>")}};i.prototype.ajaxCallback=function(e){var t=this;var a=t.$element;var n=a.closest(".bjui-layout");t.ajaxDone(e);if(e[BJUI.keys.statusCode]==BJUI.statusCode.ok||e[BJUI.keys.statusCode]==BJUI.statusCode.warn){if(n&&n.length){t.divCallback(e,n)}else{if(t.tools.getTarget()==i.NAVTAB){t.navtabCallback(e)}else{t.dialogCallback(e)}}}};i.prototype.divCallback=function(e,t){var i=this;if(e.tabid)setTimeout(function(){i.$element.navtab("reloadFlag",e.tabid)},100);if(e.dialogid)setTimeout(function(){i.$element.dialog("refresh",e.dialogid)},100);if(e.divid)setTimeout(function(){i.$element.bjuiajax("refreshDiv",e.divid)},100);if(i.options.reload){var a=i.tools.getPagerForm(t);var n=null,o=null;if(a){n=a.attr("action");o=a.attr("method")||"GET"}else{n=t.data("url");o=t.data("type")||"GET"}if(n)t.ajaxUrl({url:n,type:o})}if(i.options.reloadNavtab)setTimeout(function(){i.$element.navtab("refresh")},100);if(e.forward){var r=function(){t.ajaxUrl({url:e.forward})};if(e.forwardConfirm){i.$element.alertmsg("confirm",e.forwardConfirm,{okCall:function(){r()}})}else{r()}}};i.prototype.navtabCallback=function(t){var i=this;if(t.tabid)setTimeout(function(){i.$element.navtab("reloadFlag",t.tabid)},100);if(t.dialogid)setTimeout(function(){i.$element.dialog("refresh",t.dialogid)},100);if(t.divid)setTimeout(function(){i.$element.bjuiajax("refreshDiv",t.divid)},100);if(t.datagrid){setTimeout(function(){e.each(t.datagrid.join(","),function(t,i){e("#"+i.trim()).datagrid("refresh")})},100)}if(t.closeCurrent&&!t.forward)i.$element.navtab("closeCurrentTab");else if(i.options.reload)setTimeout(function(){i.$element.navtab("refresh")},100);if(t.forward){var a=function(){i.$element.navtab("reload",{url:t.forward})};if(t.forwardConfirm){i.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){a()},cancelCall:function(){if(t.closeCurrent){i.$element.navtab("closeCurrentTab")}}})}else{a()}}};i.prototype.dialogCallback=function(e){var t=this;if(!e.tabid&&(e.statusCode==BJUI.statusCode.ok||e.statusCode==BJUI.statusCode.warn))setTimeout(function(){t.$element.navtab("refresh")},100);else if(e.tabid=="false"){}else if(e.tabid)setTimeout(function(){t.$element.navtab("reloadFlag",e.tabid)},100);if(e.dialogid)setTimeout(function(){t.$element.dialog("refresh",e.dialogid)},100);if(e.divid)setTimeout(function(){t.$element.bjuiajax("refreshDiv",e.divid)},100);if(e.closeCurrent&&!e.forward)t.$element.dialog("closeCurrent");else if(t.options.reload)setTimeout(function(){t.$element.dialog("refresh")},100);if(t.options.reloadNavtab)setTimeout(function(){t.$element.navtab("refresh")},100);if(e.forward){var i=function(){t.$element.dialog("reload",{url:e.forward})};if(e.forwardConfirm){t.$element.alertmsg("confirm",e.forwardConfirm,{okCall:function(){i()}})}else{i()}}};i.prototype.pageCallback=function(t,a){var n=this;var o=e.extend({},i.DEFAULTS,t);var r=a||null;var s=null;if(r&&r.length){s=n.tools.getPagerForm(r,o);if(s){e.extend(o,e(s).data());n.reloadDiv(r,{type:e(s).attr("method")||"POST",url:e(s).attr("action"),data:e(s).serializeArray(),loadingmask:o.loadingmask})}}else{if(n.tools.getTarget()==i.NAVTAB){r=e.CurrentNavtab;s=n.tools.getPagerForm(r,o);if(s)e.extend(o,e(s).data());n.$element.navtab("reloadForm",false,o)}else{r=e.CurrentDialog;s=n.tools.getPagerForm(r,o);if(s)e.extend(o,e(s).data());n.$element.dialog("reloadForm",false,o)}}};i.prototype.doSearch=function(t){var a=this,n=a.$element,o=null,r={pageCurrent:1},s=n.closest(".bjui-layout"),l=t.isValid;t=e.extend({},i.DEFAULTS,typeof t=="object"&&t);if(!t.url)t.url=n.attr("action");if(!t.url){BJUI.debug("Error trying to submit form action: action url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The submit form action is incorrect: "+t.url);return}t.url=encodeURI(t.url)}var d=function(){if(s&&s.length){o=a.tools.getPagerForm(s,r);var l=n.serializeJson(),d={};if(t.clearQuery){var c=BJUI.pageInfo;for(var f in c){d[c[f]]=l[c[f]]}l=d}a.reloadDiv(s,{type:n.attr("method")||"POST",url:t.url,data:l,loadingmask:t.loadingmask})}else{if(a.tools.getTarget()==i.NAVTAB){s=e.CurrentNavtab;o=a.tools.getPagerForm(s,r);n.navtab("reloadForm",t.clearQuery,t)}else{if(t.searchmore){s=e.CurrentNavtab;o=a.tools.getPagerForm(s,r);n.dialog("closeCurrent").navtab("reloadSearchMore",t.clearQuery,t,n.serializeJson())}else{s=e.CurrentDialog;o=a.tools.getPagerForm(s,r);n.dialog("reloadForm",t.clearQuery,t)}}}};if(!l){if(e.validator){n.isValid(function(e){if(e)d()})}else{d()}}else{d()}};i.prototype.doLoad=function(t){var a=this,n=a.$element,o=t.target?e(t.target):null;t=e.extend({},i.DEFAULTS,typeof t=="object"&&t);if(!t.url){BJUI.debug("Error trying to open a ajax link: The url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The ajax link incorrect: "+t.url);return}t.url=encodeURI(t.url)}if(!o||!o.length){BJUI.debug("Not set loaded 'ajax' content container, like [data-target].");return}if(o&&o.length){o.removeData("bjui.clientPaging");a.reloadDiv(o,t)}};i.prototype.refreshLayout=function(a){var n=this,o=n.$element,r=a.target?e(a.target):null;a=e.extend({},i.DEFAULTS,typeof a=="object"&&a);if(!r||!r.length){if(t)clearInterval(t);BJUI.debug("Not set loaded 'ajax' content container, like [data-target].");return}if(r&&r.length){r.removeData("bjui.clientPaging");n.reloadDiv(r,e.extend({},r.data("options")||{},a))}};i.prototype.reloadDiv=function(e,i){var a=i.autorefresh&&(isNaN(String(i.autorefresh))?15:i.autorefresh);e.addClass("bjui-layout").data("options",i).ajaxUrl({type:i.type,url:i.url,data:i.data,loadingmask:i.loadingmask,callback:function(n){if(BJUI.ui.clientPaging&&e.data("bjui.clientPaging"))e.pagination("setPagingAndOrderby",e);if(i.callback)i.callback.apply(this,[e]);if(t)clearInterval(t);if(a)t=setInterval(function(){e.bjuiajax("refreshLayout",i)},a*1e3)}})};i.prototype.refreshDiv=function(e){if(e&&typeof e=="string"){var t=e.split(",");for(var i=0;i<t.length;i++){this.refreshLayout({target:"#"+t[i]})}}};i.prototype.doAjax=function(t){var a=this,n=a.$element;t=e.extend({},i.DEFAULTS,typeof t=="object"&&t);if(!t.url){BJUI.debug("Error trying to open a ajax link: url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The ajax url is incorrect: "+t.url);return}t.url=encodeURI(t.url)}var o=t.callback&&t.callback.toFunc();var r=function(){n.doAjax({type:t.type,url:t.url,data:t.data,callback:o?o:e.proxy(function(e){a.ajaxCallback(e)},a)})};if(t.confirmMsg){n.alertmsg("confirm",t.confirmMsg,{okCall:function(){r()}})}else{r()}};i.prototype.doExport=function(t){var a=this,n=a.$element,o=t.target?e(t.target):null,r;if(!t.url){BJUI.debug("Error trying to open a ajax link: url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The ajax url is incorrect: "+t.url);return}}var s=function(){if(!o||!o.length){if(a.tools.getTarget()==i.NAVTAB){o=e.CurrentNavtab}else{o=e.CurrentDialog}}r=a.tools.getPagerForm(o);if(r)t.url=encodeURI(t.url+(t.url.indexOf("?")==-1?"?":"&")+e(r).serialize());e.fileDownload(t.url,{failCallback:function(e,t){if(e.trim().startsWith("{"))e=e.toObj();a.ajaxDone(e)}})};if(t.confirmMsg){n.alertmsg("confirm",t.confirmMsg,{okCall:function(){s()}})}else{s()}};i.prototype.doExportChecked=function(t){var a=this,n=a.$element,o=t.target?e(t.target):null;if(!t.url){BJUI.debug("Error trying to open a export link: url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The ajax url is incorrect: "+t.url);return}}var r=function(){if(!t.group){a.$element.alertmsg("error",t.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup));return}if(!o||!o.length){if(a.tools.getTarget()==i.NAVTAB){o=e.CurrentNavtab}else{o=e.CurrentDialog}}var n=[];var r=o.find(":checkbox[name="+t.group+"]:checked");if(r.length==0){a.$element.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked));return}r.each(function(){n.push(e(this).val())});t.url=t.url.setUrlParam(t.idname?t.idname:"ids",n.join(","));e.fileDownload(t.url,{failCallback:function(e,t){if(e.trim().startsWith("{"))e=e.toObj();a.ajaxDone(e)}})};if(t.confirmMsg){n.alertmsg("confirm",t.confirmMsg,{okCall:function(){r()}})}else{r()}};i.prototype.doAjaxChecked=function(t){var a=this,n=a.$element,o=t.target?e(t.target):null;t=e.extend({},i.DEFAULTS,typeof t=="object"&&t);if(!t.url){BJUI.debug("Error trying to open a del link: url is undefined!");return}else{t.url=decodeURI(t.url).replacePlh(n.closest(".unitBox"));if(!t.url.isFinishedTm()){n.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("The ajax url is incorrect: "+t.url);return}}var r=function(){if(!t.group){n.alertmsg("error",t.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup));return}if(!o||!o.length){if(a.tools.getTarget()==i.NAVTAB){o=e.CurrentNavtab}else{o=e.CurrentDialog}}var r=[];var s=o.find(":checkbox[name="+t.group+"]:checked");var l=t.callback&&t.callback.toFunc();if(s.length==0){n.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked));return}s.each(function(){r.push(e(this).val())});t.url=t.url.setUrlParam(t.idname?t.idname:"ids",r.join(","));n.doAjax({type:t.type,url:t.url,data:t.data,callback:l?l:e.proxy(function(e){a.ajaxCallback(e)},a)})};if(t.confirmMsg){n.alertmsg("confirm",t.confirmMsg,{okCall:function(){r()}})}else{r()}};function a(t){var a=arguments;var n=t;return this.each(function(){var o=e(this);var r=e.extend({},i.DEFAULTS,o.data(),typeof t=="object"&&t);var s=o.data("bjui.bjuiajax");if(!s)o.data("bjui.bjuiajax",s=new i(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{return}})}var n=e.fn.bjuiajax;e.fn.bjuiajax=a;e.fn.bjuiajax.Constructor=i;e.fn.bjuiajax.noConflict=function(){e.fn.bjuiajax=n;return this};e(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"]',function(t){var i=e(this),n=i.data();a.call(i,"ajaxForm",n);t.preventDefault()});e(function(){if(e.validator){e(document).on(BJUI.eventType.initUI,function(t){e(t.target).find('form[data-toggle="ajaxsearch"]').each(function(){var t=e(this),i=t.data();var n=i.msgClass?i.msgClass:"n-right";i.isValid=true;t.validator({valid:function(e){a.call(t,"doSearch",i)},msgClass:n})})})}else{e(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxsearch"]',function(t){var i=e(this),n=i.data();a.call(i,"doSearch",n);t.preventDefault()})}});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadsearch"]',function(t){var i=e(this),n;var o=i.closest("form");if(!o||!o.length)return;n=o.data();n.clearQuery=i.data("clearQuery")||true;a.call(o,"doSearch",n);t.preventDefault()});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(t){var i=e(this);var n=i.data();if(!n.url)n.url=i.attr("href");a.call(i,"doLoad",n);t.preventDefault()});e(document).on(BJUI.eventType.initUI,function(t){var i=e(t.target).find('[data-toggle="autoajaxload"]');i.each(function(){var t=e(this),i=t.data();i.target=this;a.call(t,"doLoad",i)})});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(t){var i=e(this);var n=i.data();a.call(i,"refreshLayout",n)});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(t){var i=e(this);var n=i.data();if(!n.url)n.url=i.attr("href");a.call(i,"doAjax",n);t.preventDefault()});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexport"]',function(t){var i=e(this);var n=i.data();if(!n.url)n.url=i.attr("href");a.call(i,"doExport",n);t.preventDefault()});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexportchecked"]',function(t){var i=e(this);var n=i.data();if(!n.url)n.url=i.attr("href");a.call(i,"doExportChecked",n);t.preventDefault()});e(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajaxchecked"]',function(t){var i=e(this);var n=i.data();if(!n.url)n.url=i.attr("href");a.call(i,"doAjaxChecked",n);t.preventDefault()})}(jQuery);+function(e){"use strict";var t,i,a;e(function(){var a=function(){t=e(FRAG.alertBoxFrag).hide().html("");i=e(FRAG.alertBackground).hide().html("");e("body").append("\x3c!-- alert msg box --\x3e").append(t).append("\x3c!-- alert msg box mask bg --\x3e").append(i)};a()});var n=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS();this.clearTime=null};n.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},fas:{error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle"}};n.prototype.TOOLS=function(){var n=this,o=n.options;var r={getTitle:function(e){return o.title||BJUI.regional.alertmsg.title[e]},keydownOk:function(e){if(e.which==BJUI.keyCode.ENTER){e.data.target.trigger("click");return false}return true},keydownEsc:function(e){if(e.which==BJUI.keyCode.ESC)e.data.target.trigger("click")},openPosition:function(){var e=BJUI.alertMsg.displayPosition,i=BJUI.alertMsg.displayMode,a=460,n=t.outerHeight(),r={},s={};if(e){if(o.displayPosition&&o.displayPosition!="topcenter")e=o.displayPosition}else{e=o.displayPosition}if(i){if(o.displayMode&&o.displayMode!="silde")i=o.displayMode}else{i=o.displayMode}switch(e){case"topleft":r={top:0-n,left:0,"margin-left":0};s={top:0};break;case"topcenter":r={top:0-n};s={top:0};break;case"topright":r={top:0-n,left:"auto",right:0,"margin-left":0};s={top:0};break;case"middleleft":r={top:"50%",left:0-a,"margin-left":0,"margin-top":0-n/2};s={left:0};break;case"middlecenter":r={top:"0","margin-top":0-n/2};s={top:"50%"};break;case"middleright":r={top:"50%",left:"auto",right:0-a,"margin-top":0-n/2};s={right:0};break;case"bottomleft":r={top:"auto",left:0,bottom:0-n,"margin-left":0};s={bottom:0};break;case"bottomcenter":r={top:"auto",bottom:0-n};s={bottom:0};break;case"bottomright":r={top:"auto",left:"auto",right:0,bottom:0-n,"margin-left":0};s={bottom:0};break}if(i=="slide"){t.css(r).show().animate(s,500)}else if(i=="fade"){r.opacity=.1;t.css(r).css(s).show().animate({opacity:1},500)}else{t.css(r).css(s).show()}},closePosition:function(){var a=BJUI.alertMsg.displayPosition,n=BJUI.alertMsg.displayMode,r=460,s=t.outerHeight(),l={};if(a){if(o.displayPosition&&o.displayPosition!="topcenter")a=o.displayPosition}else{a=o.displayPosition}if(n){if(o.displayMode&&o.displayMode!="silde")n=o.displayMode}else{n=o.displayMode}switch(a){case"topleft":l={top:0-s};break;case"topcenter":l={top:0-s};break;case"topright":l={top:0-s};break;case"middleleft":l={left:0-r};break;case"middlecenter":l={top:0-s};break;case"middleright":l={right:0-r};break;case"bottomleft":l={bottom:0-s};break;case"bottomcenter":l={bottom:0-s};break;case"bottomright":l={bottom:0-s};break}if(n=="slide"){t.animate(l,500,function(){i.hide();e(this).hide().empty()})}else if(n=="fade"){t.animate({opacity:0},500,function(){i.hide();e(this).hide().empty()})}else{t.hide().remove();i.hide()}},open:function(r,s,l){var d=this,c="",f,u,h=BJUI.alertMsg.alertTimeout;if(l){for(var p=0;p<l.length;p++){var g=l[p].call?"callback":"";var m=l[p].cls?l[p].cls:"default";var v=l[p].cls&&l[p].cls=="green"?"check":"close";c+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+v+'"></i> '+l[p].name).replace("#callback#",g).replace("#class#",m)}}f=e(FRAG.alertBoxFrag.replace("#type#",r).replace("#fa#",o.fas[r]).replace("#title#",this.getTitle(r)).replace("#message#",s).replace("#btnFragment#",c)).hide().appendTo("body");if(t&&t.length)t.remove();t=f;d.openPosition();if(a){clearTimeout(a);a=null}if(o.mask==null){if(!(o.types.info==r||o.types.correct==r))i.show()}if(o.autoClose==null){if(o.types.info==r||o.types.correct==r){if(h){if(o.alertTimeout&&o.alertTimeout!=3e3)h=o.alertTimeout}else{h=o.alertTimeout}a=setTimeout(function(){d.close()},h)}}u=t.find(".btn");u.each(function(t){e(this).on("click",e.proxy(function(){n.tools.close();var e=l[t].call;if(typeof e=="string")e=e.toFunc();if(typeof e=="function")e.call()},n));if(l[t].keyCode==BJUI.keyCode.ENTER){e(document).on("keydown.bjui.alertmsg.ok",{target:u.eq(t)},d.keydownOk)}if(l[t].keyCode==BJUI.keyCode.ESC){e(document).on("keydown.bjui.alertmsg.esc",{target:u.eq(t)},d.keydownEsc)}})},alert:function(t,i,a){e.extend(o,typeof a=="object"&&a);var n=e.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},o);var r=[{name:n.okName,call:n.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}];this.open(t,i,r)},close:function(){e(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc");this.closePosition()}};return r};n.prototype.error=function(e,t){this.tools.alert(this.options.types.error,e,t)};n.prototype.info=function(e,t){this.tools.alert(this.options.types.info,e,t)};n.prototype.warn=function(e,t){this.tools.alert(this.options.types.warn,e,t)};n.prototype.ok=function(e,t){this.tools.alert(this.options.types.correct,e,t)};n.prototype.correct=function(e,t){this.tools.alert(this.options.types.correct,e,t)};n.prototype.confirm=function(t,i){e.extend(this.options,typeof i=="object"&&i);var a=e.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options);var n=[{name:a.okName,call:a.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:a.cancelName,call:a.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.confirm,t,n)};function o(t){var i=arguments;var a=t;return this.each(function(){var o=e(this);var r=e.extend({},n.DEFAULTS,o.data(),typeof t=="object"&&t);var s=new n(this,r);if(typeof a=="string"&&e.isFunction(s[a])){[].shift.apply(i);if(!i)s[a]();else s[a].apply(s,i)}else{return}})}var r=e.fn.alertmsg;e.fn.alertmsg=o;e.fn.alertmsg.Constructor=n;e.fn.alertmsg.noConflict=function(){e.fn.alertmsg=r;return this};e(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(t){var i=e(this),a=i.data(),n=a.options,r,s;if(n){if(typeof n=="string")n=n.toObj();if(typeof n=="object"){e.extend(a,n)}}r=a.type;if(!r)return false;o.call(i,r,a.msg||r,a);t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS()};t.DEFAULTS={first:"li.j-first",prev:"li.j-prev",next:"li.j-next",last:"li.j-last",nums:"li.j-num > a",jump:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>',total:0,pageSize:10,pageNum:10,pageCurrent:1,callback:function(){return false}};t.prototype.TOOLS=function(){var e=this;var t=this.options;var i={pageNums:function(){return Math.ceil(t.total/t.pageSize)},getInterval:function(){var e=Math.ceil(t.pageNum/2);var i=this.pageNums();var a=i-t.pageNum;var n=this.getCurrentPage()>e?Math.max(Math.min(this.getCurrentPage()-e,a),0):0;var o=this.getCurrentPage()>e?Math.min(this.getCurrentPage()+e,i):Math.min(t.pageNum,i);return{start:n+1,end:o+1}},getCurrentPage:function(){var e=parseInt(t.pageCurrent);return isNaN(e)?1:e},hasPrev:function(){return this.getCurrentPage()>1},hasNext:function(){return this.getCurrentPage()<this.pageNums()}};return i};t.prototype.init=function(){if(BJUI.ui.clientPaging&&!this.getClientPaging())this.setClientPaging({pageCurrent:this.options.pageCurrent,pageSize:this.options.pageSize});var t=this;var i=this.options;var a=this.tools;var n=a.getInterval();var o="";var r=FRAG.pagination;var s=BJUI.regional.pagination;for(var l=n.start;l<n.end;l++){o+=i.pageNumFrag.replaceAll("#pageNum#",l).replaceAll("#liClass#",l==a.getCurrentPage()?"selected j-num":"j-num")}r=r.replaceAll("#pageNumFrag#",o).replaceAll("#pageCurrent#",a.getCurrentPage()).replaceAll("#first#",s.first).replaceAll("#last#",s.last).replaceAll("#prev#",s.prev).replaceAll("#next#",s.next).replaceAll("#jumpto#",s.jumpto).replaceAll("#jump#",s.jump);this.$element.html(r);var d=this.$element.find(i.first);var c=this.$element.find(i.prev);var f=this.$element.find(i.next);var u=this.$element.find(i.last);if(a.hasPrev()){d.add(c).find("> span").hide();h(c,a.getCurrentPage()-1);h(d,1)}else{d.add(c).addClass("disabled").find("> a").hide()}if(a.hasNext()){f.add(u).find("> span").hide();h(f,a.getCurrentPage()+1);h(u,a.pageNums())}else{f.add(u).addClass("disabled").find("> a").hide()}this.$element.find(i.nums).each(function(t){h(e(this),t+n.start)});this.$element.find(i.jump).each(function(){var a=e(this).find(":text");var n=e(this).find(".goto");n.on("click",function(){var n=a.val(),o={pageCurrent:n,pageSize:i.pageSize};if(n&&n.isPositiveInteger()){t.setClientPaging(o);e(this).bjuiajax("pageCallback",o,t.$element.closest(".bjui-layout"))}});a.keyup(function(e){if(e.keyCode==BJUI.keyCode.ENTER)n.trigger("click")})});function h(i,a){i.on("click",function(i){var n={pageCurrent:a,pageSize:t.options.pageSize};t.setClientPaging(n);e(this).bjuiajax("pageCallback",n,t.$element.closest(".bjui-layout"));i.preventDefault()})}};t.prototype.changePagesize=function(){var e=this,t=e.$element.val(),i={pageSize:t};if(!isNaN(t)){e.setClientPaging(i);e.$element.bjuiajax("pageCallback",i,e.$element.closest(".bjui-layout"))}};t.prototype.orderBy=function(t){var i=this;i.$element.css({cursor:"pointer"}).click(function(){var t=e(this).data("orderField");var a=e(this).data("orderDirection");var n={orderField:t,orderDirection:a};i.setClientPaging(n);e(this).bjuiajax("pageCallback",n,i.$element.closest(".bjui-layout"))})};t.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()};t.prototype.getTarget=function(){var t=this,i;if(t.$element.closest(".bjui-layout").length)i=t.$element.closest(".bjui-layout");else if(t.$element.closest(".navtab-panel").length)i=e.CurrentNavtab;else i=e.CurrentDialog;return i};t.prototype.getClientPaging=function(){return this.getTarget().data("bjui.clientPaging")};t.prototype.setClientPaging=function(t){if(BJUI.ui.clientPaging){var i=this.getTarget();i.data("bjui.clientPaging",e.extend({},i.data("bjui.clientPaging")||{},t))}};t.prototype.setClientOrder=function(e){if(BJUI.ui.clientPaging){var t=this.getClientPaging();if(!t||!t.orderField)this.setClientPaging(e)}};t.prototype.setPagingAndOrderby=function(e){var t=e.data("bjui.clientPaging");e.find('[data-toggle="pagination"]').pagination("destroy").pagination(t);if(t.pageSize)e.find('select[data-toggle-change="changepagesize"]').selectpicker("val",t.pageSize);if(t.orderField)e.find('th[data-order-field="'+t.orderField+'"]').addClass(t.orderDirection).siblings().removeClass("asc desc")};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.pagination");if(!s)o.data("bjui.pagination",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.pagination;e.fn.pagination=i;e.fn.pagination.Constructor=t;e.fn.pagination.noConflict=function(){e.fn.pagination=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('[data-toggle="pagination"]');if(!a.length)return;i.call(a)});e(document).on("change.bjui.pagination.data-api",'select[data-toggle-change="changepagesize"]',function(t){var a=e(this);var n=a.data();i.call(a,"changePagesize");t.preventDefault()})}(jQuery);+function($){"use strict";var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");function LZ(e){return(e<0||e>9?"":"0")+e}function formatDate(e,t){t=t+"";var i="";var a=0;var n="";var o="";var r=e.getYear()+"";var s=e.getMonth()+1;var l=e.getDate();var d=e.getDay();var c=e.getHours();var f=e.getMinutes();var u=e.getSeconds();var h,p,g,m,v,b,y,k,x,w,C,c,$,j,T,I;var B={};if(r.length<4){r=""+(r-0+1900)}B["y"]=""+r;B["yyyy"]=r;B["yy"]=r.substring(2,4);B["M"]=s;B["MM"]=LZ(s);B["MMM"]=MONTH_NAMES[s-1];B["NNN"]=MONTH_NAMES[s+11];B["d"]=l;B["dd"]=LZ(l);B["E"]=DAY_NAMES[d+7];B["EE"]=DAY_NAMES[d];B["H"]=c;B["HH"]=LZ(c);if(c==0){B["h"]=12}else if(c>12){B["h"]=c-12}else{B["h"]=c}B["hh"]=LZ(B["h"]);if(c>11){B["K"]=c-12}else{B["K"]=c}B["k"]=c+1;B["KK"]=LZ(B["K"]);B["kk"]=LZ(B["k"]);if(c>11){B["a"]="PM"}else{B["a"]="AM"}B["m"]=f;B["mm"]=LZ(f);B["s"]=u;B["ss"]=LZ(u);while(a<t.length){n=t.charAt(a);o="";while(t.charAt(a)==n&&a<t.length){o+=t.charAt(a++)}if(B[o]!=null){i+=B[o]}else{i+=o}}return i}function _isInteger(e){return new RegExp(/^\d+$/).test(e)}function _getInt(e,t,i,a){for(var n=a;n>=i;n--){var o=e.substring(t,t+n);if(o.length<i){return null}if(_isInteger(o)){return o}}return null}function parseDate(e,t){e=e+"";t=t+"";var i=0;var a=0;var n="";var o="";var r="";var s,l;var d=new Date(1900,0,1);var c=d.getYear();var f=d.getMonth()+1;var u=1;var h=d.getHours();var p=d.getMinutes();var g=d.getSeconds();var m="";while(a<t.length){n=t.charAt(a);o="";while(t.charAt(a)==n&&a<t.length){o+=t.charAt(a++)}if(o=="yyyy"||o=="yy"||o=="y"){if(o=="yyyy"){s=4;l=4}if(o=="yy"){s=2;l=2}if(o=="y"){s=2;l=4}c=_getInt(e,i,s,l);if(c==null){return 0}i+=c.length;if(c.length==2){if(c>70){c=1900+(c-0)}else{c=2e3+(c-0)}}}else if(o=="MMM"||o=="NNN"){f=0;for(var v=0;v<MONTH_NAMES.length;v++){var b=MONTH_NAMES[v];if(e.substring(i,i+b.length).toLowerCase()==b.toLowerCase()){if(o=="MMM"||o=="NNN"&&v>11){f=v+1;if(f>12){f-=12}i+=b.length;break}}}if(f<1||f>12){return 0}}else if(o=="EE"||o=="E"){for(var v=0;v<DAY_NAMES.length;v++){var y=DAY_NAMES[v];if(e.substring(i,i+y.length).toLowerCase()==y.toLowerCase()){i+=y.length;break}}}else if(o=="MM"||o=="M"){f=_getInt(e,i,o.length,2);if(f==null||f<1||f>12){return 0}i+=f.length}else if(o=="dd"||o=="d"){u=_getInt(e,i,o.length,2);if(u==null||u<1||u>31){return 0}i+=u.length}else if(o=="hh"||o=="h"){h=_getInt(e,i,o.length,2);if(h==null||h<1||h>12){return 0}i+=h.length}else if(o=="HH"||o=="H"){h=_getInt(e,i,o.length,2);if(h==null||h<0||h>23){return 0}i+=h.length}else if(o=="KK"||o=="K"){h=_getInt(e,i,o.length,2);if(h==null||h<0||h>11){return 0}i+=h.length}else if(o=="kk"||o=="k"){h=_getInt(e,i,o.length,2);if(h==null||h<1||h>24){return 0}i+=h.length;h--}else if(o=="mm"||o=="m"){p=_getInt(e,i,o.length,2);if(p==null||p<0||p>59){return 0}i+=p.length}else if(o=="ss"||o=="s"){g=_getInt(e,i,o.length,2);if(g==null||g<0||g>59){return 0}i+=g.length}else if(o=="a"){if(e.substring(i,i+2).toLowerCase()=="am"){m="AM"}else if(e.substring(i,i+2).toLowerCase()=="pm"){m="PM"}else{return 0}i+=2}else{if(e.substring(i,i+o.length)!=o){return 0}else{i+=o.length}}}if(i!=e.length){return 0}if(f==2){if(c%4==0&&c%100!=0||c%400==0){if(u>29){return 0}}else{if(u>28){return 0}}}if(f==4||f==6||f==9||f==11){if(u>30){return 0}}if(h<12&&m=="PM"){h=h-0+12}else if(h>11&&m=="AM"){h-=12}return new Date(c,f-1,u,h,p,g)}Date.prototype.formatDate=function(e){return formatDate(this,e)};String.prototype.parseDate=function(e){if(this.length<e.length){e=e.slice(0,this.length)}return parseDate(this,e)};function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}Date.prototype.formatDateTm=function(e){var t=this.getFullYear();var i=this.getMonth()+1;var a=this.getDate();var n=e.replaceAll("%y",t).replaceAll("%M",i).replaceAll("%d",a);n=replaceTmEval(n);var o=1900,r=0,s=1;var l=n.split("-");if(l.length>0)o=l[0];if(l.length>1)r=l[1]-1;if(l.length>2)s=l[2];return new Date(o,r,s).formatDate("yyyy-MM-dd")}}(jQuery);+function(e){"use strict";var t,i,a,n,o,r,s,l,d,c,f,u,h,p,g,m,v,b;e(function(){var y=function(){var y=BJUI.regional.datepicker;var k=FRAG.calendarFrag.replace("#close#",y.close).replace("#prev#",y.prev).replace("#next#",y.next).replace("#clear#",y.clear).replace("#ok#",y.ok);t=e(k).hide();e("body").append("\x3c!-- datepicker --\x3e").append(t);i=t.find("> .main");a=t.find("a.prev");n=t.find("a.next");o=t.find("select[name=year]");r=t.find("select[name=month]");s=t.find(".time");l=s.find(":text");d=s.find("ul > li");c=s.find(".hh");f=s.find(".mm");u=s.find(".ss");h=i.find("> .tm");p=t.find(".close");g=i.find("> .body > .days");m=i.find("> .body > .dayNames");v=t.find(".clearBtn");b=t.find(".okBtn");var x="",w=BJUI.regional.datepicker;e.each(w.dayNames,function(e,t){x+="<dt>"+t+"</dt>"});m.html(x);e.each(w.monthNames,function(e,t){var i=e+1;r.append('<option value="'+i+'">'+t+"</option>")});t.on("selectstart",function(){return false})};y()});var y=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS();this.$dateBtn=null;var a=new Date;this.options.minDate=a.formatDateTm(this.options.minDate);this.options.maxDate=a.formatDateTm(this.options.maxDate);this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}};y.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1};y.EVENTS={afterChange:"afterchange.bjui.datepicker"};y.prototype.TOOLS=function(){var i=this;var a={changeTmMenu:function(e){h.removeClass("hh").removeClass("mm").removeClass("ss");if(e){h.addClass(e);l.removeClass("slt").filter("."+e).addClass("slt")}},clickTmMenu:function(t,a){h.find("> ul").hide().filter("."+a).show().find("> li").off(i.events.click_tm).on(i.events.click_tm,function(){var i=e(this);var a=parseInt(i.text())<10?"0"+i.text():i.text();t.val(a)})},keydownInt:function(e){if(!(e.keyCode>=48&&e.keyCode<=57||(e.keyCode==BJUI.keyCode.DELETE||e.keyCode==BJUI.keyCode.BACKSPACE))){return false}},changeTm:function(e,t){var i=parseInt(e.val()),a=parseInt(e.data("start"))||0,n=parseInt(e.data("end"));var o=parseInt(e.data("step")||1);var r=t?t.data("add")?t.data("add"):-1:0;var s=i;if(r==1){if(i<=n-o)s=i+o}else if(r==-1){if(i>=a+o)s=i-o}else if(i>n){s=n}else if(i<a){s=a}if(s<10)s="0"+s;e.val(s)},closeCalendar:function(n){a.changeTmMenu();if(n){e(document).off(i.events.click_close);t.hide()}},get:function(e){return i.options[e]},getDays:function(e,t){return t==2?e%4||!(e%100)&&e%400?28:29:/4|6|9|11/.test(t)?30:31},minMaxDate:function(e){var t=e.split("-").length-1;var i="y-M-d";if(t==1)i="y-M";else if(t==0)i="y";return e.parseDate(i)},getMinDate:function(){return this.minMaxDate(i.options.minDate)},getMaxDate:function(){var e=i.options.maxDate;var t=e.split("-").length-1;var a=this.minMaxDate(e);if(t<2){var n=this.getDays(a.getFullYear(),a.getMonth()+1);a.setDate(n);if(t==0)a.setMonth(11)}return a},getDateWrap:function(e){if(!e)e=this.parseDate(i.sDate)||new Date;var t=e.getFullYear();var a=e.getMonth()+1;var n=this.getDays(t,a);return{year:t,month:a,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),days:n,date:e}},changeDate:function(e,t,a){var n=new Date(e,t-1,a||1);i.sDate=this.formatDate(n);return n},changeDateTime:function(e,t,a,n,o,r){var s=new Date(e,t-1,a,n,o,r);i.sDate=this.formatDate(s);return s},changeDay:function(e,t){if(!t)t=0;var i=this.getDateWrap();return this.changeDate(i.year,i.month+parseInt(t),e)},changeMonth:function(e){var t=o.get(0).selectedIndex;var i=o.find("option").length;var a=r.val()*1+e;if(a==0){if(t==0){a=1}else{a=12;t--;o.get(0).selectedIndex=t}}else if(a==13){if(t==i-1){a=12}else{a=1;t++;o.get(0).selectedIndex=t}}r.val(a).change()},parseDate:function(e){if(!e)return null;return e.parseDate(i.options.pattern)},formatDate:function(e){return e.formatDate(i.options.pattern)},hasHour:function(){return i.options.pattern.indexOf("H")!=-1},hasMinute:function(){return i.options.pattern.indexOf("m")!=-1},hasSecond:function(){return i.options.pattern.indexOf("s")!=-1},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){var e=["y","M","d","E"];for(var t=0;t<e.length;t++){if(i.options.pattern.indexOf(e[t])!=-1)return true}return false},afterChange:function(e){i.$element.trigger(y.EVENTS.afterChange,{value:e})}};return a};y.prototype.addBtn=function(){var t=this,i=t.$element;if(!this.$dateBtn&&!this.options.addbtn&&!i.parent().hasClass("wrap_bjui_btn_box")){this.$dateBtn=e(FRAG.dateBtn);this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var a=this.$element.parent();var n=this.$element.addClass("form-control").innerHeight();a.css({position:"relative",display:"inline-block"});this.$dateBtn.css({height:n,lineHeight:n+"px"}).appendTo(a);this.$dateBtn.on("selectstart",function(){return false})}};y.prototype.init=function(){if(this.$element.val())this.sDate=this.$element.val().trim();var t=this;var i=this.options;var s=this.tools;var l=s.getDateWrap();var d=s.getMinDate(),h=s.getMaxDate();var m=d.getFullYear(),y=h.getFullYear();o.empty();for(var k=m;k<=y;k++){o.append('<option value="'+k+'"'+(l.year==k?" selected":"")+">"+k+"</option>")}r.val(l.month);o.add(r).off(this.events.change_ym).on(this.events.change_ym,function(){if(s.hasTime()){var e=g.find(".slt");var i=s.changeDateTime(o.val(),r.val(),e.data("day"),l.hour,l.minute,l.second);t.create(s.getDateWrap(i),d,h)}else{var e=g.find(".slt");var i=s.changeDate(o.val(),r.val(),e.data("day"));t.create(s.getDateWrap(i),d,h)}});a.off(this.events.click_prev).on(this.events.click_prev,function(){t.tools.changeMonth(-1)});n.off(this.events.click_prev).on(this.events.click_prev,function(){t.tools.changeMonth(1)});v.off(this.events.click_clear).on(this.events.click_clear,function(){t.$element.val("");s.closeCalendar(true)});b.off(this.events.click_ok).on(this.events.click_ok,function(){var e=g.find("dd.slt");if(e.hasClass("disabled"))return false;var i=s.changeDay(e.data("day"),e.data("month"));if(s.hasTime()){i.setHours(parseInt(c.val()));i.setMinutes(parseInt(f.val()));i.setSeconds(parseInt(u.val()))}s.closeCalendar(true);t.$element.val(s.formatDate(i)).focus();s.afterChange(i)});p.off(this.events.click_close).on(this.events.click_close,function(){s.closeCalendar(true)});e(document).on(this.events.click_close,function(i){var a=e(i.target);if(i.target==t.$element.get(0))return;if(a.closest("#calendar").length)return;if(a.data("toggle")=="datepicker"||a.parent().data("toggle")=="datepickerbtn"||a.data("toggle")=="datepickerbtn")s.closeCalendar(false);else s.closeCalendar(true)});this.create(l,d,h)};y.prototype.create=function(a,n,o){var r=this;var p=this.options;var m=this.tools;var v=new Date(a.year,a.month-1,1);var b=v.getDay();var y="";if(b>0){v.setMonth(v.getMonth()-1);var k=m.getDateWrap(v);for(var x=k.days-b+1;x<=k.days;x++){var w=new Date(a.year,a.month-2,x);var C=w>=n&&w<=o?"":" disabled";y+='<dd class="other'+C+'" data-month="-1" data-day="'+x+'">'+x+"</dd>"}}for(var x=1;x<=a.days;x++){var w=new Date(a.year,a.month-1,x);var C=w>=n&&w<=o?"":"disabled";if(x==a.day)C+=" slt";y+='<dd class="'+C+'" data-day="'+x+'">'+x+"</dd>"}for(var x=1;x<=42-b-a.days;x++){var w=new Date(a.year,a.month,x);var C=w>=n&&w<=o?"":" disabled";y+='<dd class="other'+C+'" data-month="1" data-day="'+x+'">'+x+"</dd>"}var $=g.html(y).find("dd");$.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var t=e(this);if(!m.hasTime()){var i=m.changeDay(t.data("day"),t.data("month"));m.closeCalendar(true);r.$element.val(m.formatDate(i)).focus();m.afterChange(i)}else{$.removeClass("slt");t.addClass("slt")}});if(!m.hasDate()){i.addClass("nodate")}else{i.removeClass("nodate")}if(m.hasTime()){s.show();c.val(a.hour<10?"0"+a.hour:a.hour).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("hh")});var j=parseInt(a.minute/p.mmStep)*p.mmStep;f.val(j<10?"0"+j:j).data("step",p.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("mm")});u.val(m.hasSecond()?a.second<10?"0"+a.second:a.second:"00").data("step",p.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){m.changeTmMenu("ss")});t.off("click").on("click",function(t){if(e(t.target).closest(".time").length)return;h.find("> ul").hide();m.changeTmMenu()});l.off(this.events.keydown_time).on(this.events.keydown_time,m.keydownInt).each(function(){var t=e(this);t.off(r.events.keyup_time).on(r.events.keyup_time,function(){m.changeTm(t)})}).off(this.events.click_time).on(this.events.click_time,function(){m.clickTmMenu(e(this),e(this).data("type"))});var T=null;d.off(this.events.click_spinner).on(this.events.click_spinner,function(t){var i=e(this);l.filter(".slt").each(function(){m.changeTm(e(this),i)});t.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(t){var i=e(this);T=setInterval(function(){l.filter(".slt").each(function(){m.changeTm(e(this),i)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(e){clearTimeout(T)});if(!m.hasHour())c.attr("disabled",true);if(!m.hasMinute())f.attr("disabled",true);if(!m.hasSecond())u.attr("disabled",true)}else{s.hide()}this.show()};y.prototype.show=function(){var i=this.$element.offset();var a=i.top+this.$element.get(0).offsetHeight;var n=t.outerHeight(true);if(a>n&&a>e(window).height()-n)a=i.top-n;t.css({left:i.left,top:a}).show().click(function(e){e.stopPropagation()})};function k(t){var i=arguments;var a=t;return this.each(function(){var n=e(this);var o=e.extend({},y.DEFAULTS,n.data(),typeof t=="object"&&t);var r=n.data("bjui.datepicker");if(!r)n.data("bjui.datepicker",r=new y(this,o));if(typeof a=="string"&&e.isFunction(r[a])){[].shift.apply(i);if(!i)r[a]();else r[a].apply(r,i)}else{r.init()}})}var x=e.fn.datepicker;e.fn.datepicker=k;e.fn.datepicker.Constructor=y;e.fn.datepicker.noConflict=function(){e.fn.datepicker=x;return this};e(document).on(BJUI.eventType.initUI,function(t){var i=e(t.target).find('[data-toggle="datepicker"]');if(!i.length)return;if(i.data("nobtn"))return;k.call(i,"addBtn")});e(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(t){var i=e(this).prevAll('[data-toggle="datepicker"]');if(!i||!i.is(":text"))return;k.call(i,i.data());t.preventDefault()});e(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(t){var i=e(this);if(i.data("onlybtn"))return;if(!i.is(":text"))return;k.call(i,i.data());t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i};t.DEFAULTS={url:undefined,target:undefined,reload:false};t.prototype.init=function(){var e=this.options;if(!e.url){BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!");return}else{e.url=decodeURI(e.url).replacePlh(this.$element.closest(".unitBox"));if(!e.url.isFinishedTm()){this.$element.alertmsg("error",e.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+e.url);return}e.url=encodeURI(e.url)}if(!e.target){BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!");return}if(e.reload){this.load()}else{var t=this.$element.data("bjui.ajaxtab.reload");if(!t)this.load();else this.$element.tab("show")}};t.prototype.load=function(){var t=this.$element;var i=this.options;e(i.target).ajaxUrl({url:i.url,data:{},callback:function(){t.data("bjui.ajaxtab.reload",true).tab("show")}})};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.ajaxtab");if(!s)o.data("bjui.ajaxtab",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.ajaxtab;e.fn.ajaxtab=i;e.fn.ajaxtab.Constructor=t;e.fn.ajaxtab.noConflict=function(){e.fn.ajaxtab=a;return this};e(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(t){var a=e(this);var n=a.data();if(!n.url)n.url=a.attr("href");i.call(a,n);t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS();this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"};this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}};t.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:true,filterThead:true,sortAll:false,filterAll:false,filterMult:true,linenumberAll:false,showLinenumber:true,showCheckboxcol:false,showEditbtnscol:false,showTfoot:false,showToolbar:false,toolbarItem:"",toolbarCustom:"",columnResize:true,columnMenu:true,columnShowhide:true,columnFilter:true,columnLock:true,paging:true,pagingAlign:"center",editUrl:null,editCallback:null,editMode:"inline",editDialogOp:null,inlineEditMult:true,saveAll:true,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:true,delCallback:null,jsonPrefix:"",contextMenuH:true,contextMenuB:false,hScrollbar:false,fullGrid:false,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,afterSave:null,afterDelete:null};t.renderItem=function(t,i){if(!i||!i.length)return"";var a="";e.each(i,function(e,i){if(typeof i[t]!="undefined"){a=i[t];return false}});return a};t.prototype.TOOLS=function(){var t=this,i=t.options;var a={getPageCount:function(e,t){return Math.ceil(t/e)},getPageInterval:function(e,t,i){var a=Math.ceil(i/2),n=e-i,o=t>a?Math.max(Math.min(t-a,n),0):0,r=t>a?Math.min(t+a,e):Math.min(i,e);if(r-o==i)r=r+1;if(r<i)r=r+1;return{start:o+1,end:r}},getRight:function(i){var a=0,n=i.data("index"),o=t.$tbody.find("> tr:first > td:lt("+(n+1)+")");if(!o||!o.length)o=t.$colgroupH.find("> col:lt("+(n+1)+")");o.each(function(){var t=e(this),i=t.is(":hidden")?0:t.outerWidth();a+=i});return a},getRight4Lock:function(i){var a=0,n=t.$lockTbody.find("> tr:first > td:eq("+i+")"),o=n&&n.prevAll().add(n);if(!o||!o.length)o=t.$lockColgroupH.filter(":lt("+(i+1)+")");o.each(function(){var t=e(this),i=t.is(":hidden")?0:t.outerWidth();a+=i});return a},beforeEdit:function(e,a){var n=i.beforeEdit;if(n){if(typeof n=="string")n=n.toFunc();if(typeof n=="function"){return n.call(t,e,a)}}return true},afterSave:function(e,a){var n=i.afterSave;if(n){if(typeof n=="string")n=n.toFunc();if(typeof n=="function"){n.call(t,e,a)}}},afterDelete:function(){var e=i.afterDelete;if(e){if(typeof e=="string")e=e.toFunc();if(typeof e=="function"){e.call(t)}}},setColspan:function(e,t){if(e.colspan)e.colspan=e.colspan+t-1;e.index=e.index+t-1;if(e.parent)this.setColspan(e.parent,t)},columns2Arr:function(i,a,n,o){var r=this;if(!a)a=[];if(!n)n=0;if(!a[n])a[n]=[];e.each(i,function(e,i){var s=a[n].length,l;if(o)i.parent=o;if(i.columns){l=i.columns.length;if(n&&i.parent){r.setColspan(i.parent,l)}i.index=t.columnModel.length+l-1;i.colspan=l;i.quicksort=false;a[n][s++]=i;return r.columns2Arr(i.columns,a,n+1,i)}else{i.rowspan=n;i.index=t.columnModel.length;i.menu=typeof i.menu=="undefined"?true:i.menu;i.lock=typeof i.lock=="undefined"?true:i.lock;i.hide=typeof i.hide=="undefined"?false:i.hide;i.edit=typeof i.edit=="undefined"?true:i.edit;i.add=typeof i.add=="undefined"?true:i.add;i.quicksort=typeof i.quicksort=="undefined"?true:i.quicksort;a[n][s++]=i;t.columnModel.push(i)}});return a},createTrsByData:function(i,n){var o;if(!t.$tbody)t.$tbody=e("<tbody></tbody>");if(i){if(i.list)o=i.list;else o=i;t.paging.total=o.length;if(typeof i=="object"){if(i[BJUI.pageInfo.total])t.paging.total=parseInt(i[BJUI.pageInfo.total]);if(i[BJUI.pageInfo.pageSize]){if(n&&t.paging.pageSize!=i[BJUI.pageInfo.pageSize]){t.$selectpage.trigger("bjui.datagrid.paging.pageSize",i[BJUI.pageInfo.pageSize])}t.paging.pageSize=parseInt(i[BJUI.pageInfo.pageSize])}}t.paging.pageCount=a.getPageCount(t.paging.pageSize,t.paging.total);if(t.paging.pageCurrent>t.paging.pageCount)t.paging.pageCurrent=t.paging.pageCount;this.initTbody(o,n)}if(!t.init_tbody)t.$tbody.appendTo(t.$element);if(!t.init_thead)t.initThead()},initTbody:function(a,n){var o=this,r=t.allData,s=i.dataType||"json",l=t.columnModel,d=t.hiddenFields,c=t.regional,f=[],u=t.attach,h;var p=t.paging,g=0,m=p.pageSize;var v=function(){s=s.toLowerCase();if(a)r=t.allData=a;if(!r.length){m=0}else{if(i.local=="local"){g=p.pageSize*(p.pageCurrent-1);m=g+p.pageSize;if(p.total!=r.length)p.total=r.length;if(g>r.length)g=p.pageSize*(p.pageCount-1)}else{if(r.length>p.pageSize)m=p.pageSize}}if(m>r.length)m=r.length;if(s=="array"&&a&&a.length&&e.type(a[0])=="array"){var c=g,v=m,b=[],y;if(i.local=="local"){c=0;v=r.length}for(var k=c;k<v;k++){h={};y=0;e.each(r[k],function(t,i){var a,n=i;if(l[y]&&l[y].gridNumber)y++;if(l[y]&&l[y].gridCheckbox)y++;if(typeof n=="string")n='"'+n+'"';if(l[y]&&!l[y].gridEdit){a='{"'+l[y].name+'":'+n+"}";e.extend(h,JSON.parse(a))}else{if(l[y]&&l[y].gridEdit)y++;if(y>=l.length&&d){if(d[t-l.length]){a='{"'+d[t-l.length]+'":'+n+"}";e.extend(h,JSON.parse(a))}}}y++});b.push(h)}r=t.allData=b}for(var k=g;k<m;k++){h=e.extend({},t.allData[k],u);f.push(h)}o.createTrs(f,n);t.data=f};if(n&&t.$boxM){t.$boxM.show().trigger("bjui.ajaxEnd").trigger("bjui.ajaxStart",[50,v])}else{v()}},createTrs:function(a,n){var o=this,r=t.columnModel,s=t.paging,l=BJUI.doRegional(FRAG.gridEditBtn,t.regional),d=[];if(n){e.each(r,function(e,i){if(i.locked){t.colLock(i.th,false);i.lock_refresh=true}});t.$tbody.empty();t.$lockTableH&&t.$lockTableH.empty();t.$lockTableB&&t.$lockTableB.empty()}e.each(a,function(o,d){var c=e("<tr></tr>"),f,u=i.linenumberAll?(s.pageCurrent-1)*s.pageSize+(o+1):o+1;e.extend(d,{gridNumber:u,gridIndex:o});e.each(r,function(i,r){var s=r.name||"datagrid-noname",u=d[s],h="",p="",g;if(typeof u=="undefined")u="";g=u;if(r.align)h=' align="'+r.align+'"';if(r.gridCheckbox)u='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>';if(r.gridEdit){u=l;p=' class="'+t.classnames.s_edit+'"'}if(r.calc){if(!r.calc_count)r.calc_count=a.length;var m=u?String(u).isNumber()?u*1:0:0;if(r.calc=="sum"||r.calc=="avg")r.calc_sum=(r.calc_sum||0)+m;else if(r.calc=="max")r.calc_max=r.calc_max?r.calc_max<m?m:r.calc_max:m;else if(r.calc=="min")r.calc_min=r.calc_min?r.calc_min>m?m:r.calc_min:m}f=e("<td"+h+p+"><div>"+u+"</div></td>");f.data("val",u).appendTo(c);if(r.gridNumber)f.addClass(t.classnames.td_linenumber);if(r.gridCheckbox)f.addClass(t.classnames.td_checkbox);if(n&&r.hidden)f.css("display","none");if(r.items&&!r.render)r.render=e.datagrid.renderItem;if(r.render&&typeof r.render=="string")r.render=r.render.toFunc();if(r.render&&typeof r.render=="function"){var v="",b=false;if(r.items){if(typeof r.items=="string"){if(r.render.trim().startsWith("["))r.render=r.render.toObj();else r.render=r.render.toFunc()}if(!r.renderTds)r.renderTds=[];var y=function(i,a){e.when(r.items.call(t)).then(function(n){r.items=n;v=r.render.call(t,a,n);i.html(v);e.each(r.renderTds,function(e,i){v=r.render.call(t,i.text(),n);i.html(v);if(e==r.renderTds.length-1)r.renderTds=null});t.delayRender--})};if(typeof r.items=="function"){if(o==0){if(!t.delayRender)t.delayRender=0;t.delayRender++;y(f,g)}else{r.renderTds.push(f)}}else{v=r.render.call(t,g,r.items);f.html(v)}}else{v=r.render.call(t,g);f.html(v)}}});c.appendTo(t.$tbody);if(n)c.initui()});if(n){t.initEvents();if(i.editMode)t.edit();t.$paging&&t.$paging.trigger("bjui.datagrid.paging.jump");e.each(r,function(e,i){if(i.lock_refresh){t.colLock(i.th,true);delete i.lock_refresh}})}if(t.$boxM){t.$boxM.trigger("bjui.ajaxStop").hide()}},loadData:function(a,n){var o=this,r=i.dataUrl,s=i.dataType||"json",l=t.columnModel;if(t.$tbody){t.$boxM.show().trigger("bjui.ajaxStart",[50])}s=s.toLowerCase();if(s=="array")s="text";e.ajax({url:r,data:a||{},type:i.loadType,cache:i.cache||false,dataType:s,success:function(t){if(s=="xml"){var i=[],a;e(t).find("row").each(function(){a={};e(this).find("cell").each(function(t){var i=e(this),n=i.text(),o=i.attr("name");a[o]=n});i.push(a)});if(i)o.createTrsByData(i,n)}else if(s=="json"){o.createTrsByData(t,n)}else{o.createTrsByData(t.toObj(),n)}}})},appendColumns:function(){t.linenumberColumn={name:"gridNumber",gridNumber:true,width:30,minWidth:30,label:"No.",align:"center",menu:false,edit:false,quicksort:false};t.checkboxColumn={name:"gridCheckbox",gridCheckbox:true,width:40,minWidth:40,label:"Checkbox",align:"center",menu:false,edit:false,quicksort:false};t.editBtnsColumn={name:"gridEdit",gridEdit:true,width:110,minWidth:110,label:"Edit",align:"center",menu:false,edit:false,hide:false,quicksort:false}},createThead:function(){var a=this,n=i.columns,o=[],r=[],s,l,d,c,f,u,h;a.appendColumns();if(i.showCheckboxcol){n.unshift(t.checkboxColumn);if(i.showCheckboxcol=="lock")t.checkboxColumn.initLock=true}if(i.showLinenumber){n.unshift(t.linenumberColumn);if(i.showLinenumber=="lock")t.linenumberColumn.initLock=true}if(i.showEditbtnscol)n.push(t.editBtnsColumn);o=a.columns2Arr(n,o);t.columnModel[t.columnModel.length-(i.showEditbtnscol?2:1)].lock=false;if(i.hiddenFields)t.hiddenFields=i.hiddenFields;t.$thead=e("<thead></thead>");e.each(o,function(a,n){var r=e('<tr style="height:25px;"></tr>'),p='<th class="datagrid-number"></th>',g;e.each(n,function(a,n){s=n.label||n.name;l=n.align?' align="'+n.align+'"':"";d=n.width?' width="'+n.width+'"':"";c=n.colspan?' colspan="'+n.colspan+'"':"";f=o.length-n.rowspan>1?' rowspan="'+(o.length-n.rowspan)+'"':"";u='<div class="'+t.classnames.th_resizemark+'"></div>';h="";if(n.gridCheckbox)s='<input type="checkbox" data-toggle="icheck">';if(n.colspan)l=' align="center"';if(n.thalign)l=' align="'+n.thalign+'"';if(n.menu&&i.columnMenu)h=' class="'+t.classnames.th_menu+'"';g=e("<th"+h+d+l+c+f+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+s+'</div><div class="'+t.classnames.th_cell+'">'+u+"</div></div></th>");g.data("index",n.index).appendTo(r);g.find("> div").css("height",o.length-n.rowspan>1?24*(o.length-n.rowspan)+"px":"24px");if(!f)g.addClass("single-row");if(n.gridNumber)g.addClass(t.classnames.td_linenumber);if(i.fieldSortable&&n.quicksort)g.addClass("datagrid-quicksort-th");n.th=g});r.appendTo(t.$thead)});t.$thead.appendTo(t.$element)},createTbody:function(){var e=this,a=i.data,n=t.columnModel,o=[];if(a){if(typeof a=="string"){if(a.trim().startsWith("[")||a.trim().startsWith("{")){a=a.toObj()}else{a=a.toFunc()}}if(typeof a=="function"){a=a.call()}e.createTrsByData(a)}else if(i.dataUrl){e.loadData()}},setBoxbH:function(e){var a=e||i.height,n=0,o;if(a<100)return;if(isNaN(a))a=t.$grid.height();if(t.$boxT){o=t.$boxT.outerHeight();a-=o;n+=o}if(t.$toolbar){o=t.$toolbar.outerHeight();a-=o;n+=o}if(t.$box_paging)a-=t.$box_paging.outerHeight();if(t.$boxF)a-=t.$boxF.outerHeight();n+=t.$tableH.outerHeight();a-=t.$boxH.outerHeight();if(a<0)a=0;t.$boxB.height(a);t.$boxM.height(a).css({top:n})},fixedH:function(e){this.setBoxbH(e)},showSubMenu:function(i,a,n){var o,r=a.outerWidth(),s=n.data("width")||n.outerWidth(),l,d=t.$boxH.width();var c=function(i,a,n){o=a.offset().left-t.$grid.offset().left-1;l={left:"50%"};i.removeClass("active");if(a.hasClass("position-right")||d-o<r+s){n.css({left:"auto",right:"100%"});l={right:"50%"}}else{n.css({left:"100%",right:"auto"})}l.opacity=.2;n.stop().animate(l,"fast",function(){e(this).hide()})};i.hover(function(){n.appendTo(i);if(i.hasClass(t.classnames.li_filter)&&n.is(":visible")){return false}else{var e=i.siblings("."+t.classnames.li_filter);if(e.length&&e.hasClass("active")){c(e,a,e.find("> ."+t.classnames.s_filter))}}o=a.offset().left-t.$grid.offset().left-1;l={left:"100%"};if(a.hasClass("position-right")||d-o<r+s){n.css({left:"auto",right:"50%"});l={right:"100%"}}else{n.css({left:"50%",right:"auto"})}l.opacity=1;i.addClass("active");n.show().stop().animate(l,"fast")},function(){if(i.hasClass(t.classnames.li_filter)){return false}c(i,a,n)});i.on("bjui.datagrid.th.submenu.hide",function(t,i,a){c(e(this),i,a)})},locking:function(e){var i=e.data("index"),a=t.columnModel[i],n=a.lock,o=a.locked,r=t.$menu,s=r.find("> ul"),l=s.find("> li."+t.classnames.li_lock),d=l.next();if(o){l.addClass("disable");d.removeClass("disable")}else{d.addClass("disable");l.removeClass("disable")}if(n){l.show().off("click").on("click",function(){if(l.hasClass("disable"))return;r.hide().data("bjui.datagrid.menu.btn").removeClass("active");t.colLock(e,true)});d.show().off("click").on("click",function(){if(d.hasClass("disable"))return;r.hide().data("bjui.datagrid.menu.btn").removeClass("active");t.colLock(e,false)})}else{l.hide().off("click");d.hide().off("click")}},createShowhide:function(){var i;if(!t.$showhide){t.col_showhide_count=t.columnModel.length;i=e('<ul class="'+t.classnames.s_showhide+'" role="menu"></ul>');e.each(t.columnModel,function(a,n){if(n.gridNumber||n.gridCheckbox||n.gridEdit)t.col_showhide_count--;var o=e(FRAG.gridShowhide.replaceAll("#index#",n.index).replaceAll("#label#",n.label||"")).toggleClass("nodisable",!!(n.gridNumber||n.gridCheckbox||n.gridEdit));var r=function(a){o.click(function(){if(e(this).hasClass("disable"))return false;var n=e(this),o=!n.find("i").hasClass("fa-check-square-o"),r=a.index;n.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(o?"-check":"")+"-square-o");t.showhideColumn(a.th,o);if(!(a.gridNumber||a.gridCheckbox||a.gridEdit)){t.col_showhide_count=o?t.col_showhide_count+1:t.col_showhide_count-1}if(t.col_showhide_count==1)i.find("> li.datagrid-col-check").addClass("disable");else i.find("> li.disable").removeClass("disable");i.find("> li.nodisable").removeClass("disable")})};r(n);o.appendTo(i);if(n.hide)o.trigger("click")});i.appendTo(t.$grid);i.data("width",i.outerWidth());t.$showhide=i}},showhide:function(e,i){var a=e.index,n=e.th,o=t.$tbody.find("> tr"),r=i?"":"none";var s=function(e){var t=e.colspan;if(i)t++;else t--;if(!t)e.th.css("display","none");else e.th.css("display","");e.th.attr("colspan",t);e.colspan=t;if(e.parent)s(e.parent)};if(typeof e.hidden=="undefined")e.hidden=false;if(e.hidden==!i)return;e.hidden=!i;n.css("display",r);o.find("> td:eq("+a+")").css("display",r);t.$colgroupH.find("> col").eq(a).css("display",r);t.$colgroupB.find("> col").eq(a).css("display",r);t.$thead.find("> tr.datagrid-filter > th:eq("+a+")").css("display",r);if(t.$boxF){t.$tableF.find("> thead > tr > th:eq("+a+")").css("display",r);t.$colgroupF.find("> col").eq(a).css("display",r)}if(e.calc){t.$tfoot&&t.$tfoot.trigger("bjui.datagrid.tfoot.resizeH")}if(e.parent)s(e.parent)},jumpPage:function(e,a){var n=t.allData,o;if(e)t.paging.pageCurrent=e;if(a){t.paging.pageSize=a;t.paging.pageCount=this.getPageCount(a,t.paging.total);if(t.paging.pageCurrent>t.paging.pageCount)t.paging.pageCurrent=t.paging.pageCount}if(i.local=="remote"){o=this.getRemoteFilterData(true);this.loadData(o,true)}else{this.initTbody(n,true)}},quickSort:function(e){if(t.isDom){if(i.local=="local")return;i.sortAll=true}if(t.$tbody.find("> tr."+t.classnames.tr_edit).length){t.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg"));return}var a=e.th,n=t.data,o=t.allData,r,s,l=e.name,d=e.type,c=t.$thead.find("> tr > th.datagrid-quicksort-th");if(!l)l="datagrid-noname";var f=function(t){t.sort(function(t,i){var a=typeof t[l],n=typeof i[l];if(d=="boolean"||d=="number"||(a=n=="number")||(a=n=="boolean")){return e.sortAsc?t[l]-i[l]:i[l]-t[l]}else{return e.sortAsc?String(t[l]).localeCompare(i[l]):String(i[l]).localeCompare(t[l])}})};c.find("> div > .datagrid-label > i").remove();if(e.sortAsc){s="desc";e.sortAsc=false}else{s="asc";e.sortAsc=true}a.find("> div > .datagrid-label").prepend('<i class="fa fa-long-arrow-'+(e.sortAsc?"up":"down")+'"></i>');if(i.sortAll){if(i.local=="remote"){r={};r[BJUI.pageInfo.orderField]=l;r[BJUI.pageInfo.orderDirection]=s;r[BJUI.pageInfo.pageSize]=t.paging.pageSize;r[BJUI.pageInfo.pageCurrent]=t.paging.pageCurrent;this.loadData(r,true)}else{f(o);this.initTbody(o,true)}}else{f(n);this.createTrs(n,true)}},quickFilter:function(a,n){if(t.isDom){if(i.local!="remote"){BJUI.debug("Datagrid Plugin: Please change the local option is remote!");return}if(!i.dataUrl){BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!");return}}var o=this,r=a.th,s=t.data,l=t.allData,d=a.name,c,f;var u=function(e,t,i){var n=false;switch(e){case"=":n=String(t)==String(i);break;case"!=":n=String(t)!=String(i);break;case">":n=parseFloat(i)>parseFloat(t);break;case"<":n=parseFloat(i)<parseFloat(t);break;case"like":if(a.type=="select"){n=String(t)==String(i)}else{n=String(i).indexOf(String(t))>=0}break;default:break}return n};var h=function(t,i){var a=function(t){var a=0;e.each(i,function(e,i){var n=i.datas;a++;if(!n){a--;i.model.isFiltered=false;i.model.th.trigger("bjui.datagrid.th.filter",[false]);if(i.model.quickfilter)i.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter");return true}i.model.isFiltered=true;i.model.th.trigger("bjui.datagrid.th.filter",[true]);if(n.andor){if(n.andor=="and"){if(u(n.operatorA,n.valA,t[e])&&u(n.operatorB,n.valB,t[e])){a--}}else if(n.andor=="or"){if(u(n.operatorA,n.valA,t[e])||u(n.operatorB,n.valB,t[e])){a--}}}else{if(n.operatorB){if(u(n.operatorB,n.valB,t[e])){a--}}else{if(u(n.operatorA,n.valA,t[e])){a--}}}});return!a?true:false};return e.grep(t,function(e,t){return a(e)})};if(!t.filterDatas)t.filterDatas={};if(i.filterMult){t.filterDatas[d]={datas:n,model:a}}else{t.filterDatas={};t.filterDatas[d]={datas:n,model:a}}if(i.local!="remote"&&l){if(!t.oldAllData)t.oldAllData=l.concat();else l=t.oldAllData.concat()}if(i.filterAll){if(i.local=="remote"){o.loadData(o.getRemoteFilterData(),true)}else{f=h(l,t.filterDatas);t.paging.pageCurrent=1;t.paging.pageCount=this.getPageCount(t.paging.pageSize,f.length);this.initTbody(f,true)}}else{if(t.isDom){o.loadData(o.getRemoteFilterData(),true)}else{f=h(s,t.filterDatas);this.createTrs(f,true)}}},getRemoteFilterData:function(a){var n=[];if(t.filterDatas&&!e.isEmptyObject(t.filterDatas)){e.each(t.filterDatas,function(e,t){if(!t.datas){t.model.isFiltered=false;t.model.th.trigger("bjui.datagrid.th.filter",[false]);if(t.model.quickfilter)t.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter");return true}t.model.isFiltered=true;t.model.th.trigger("bjui.datagrid.th.filter",[true]);if(i.jsonPrefix)e=i.jsonPrefix+"."+e;if(t.datas.andor)n.push({name:"andor",value:t.datas.andor});if(t.datas.operatorA){n.push({name:e,value:t.datas.valA});n.push({name:e+".operator",value:t.datas.operatorA})}if(t.datas.operatorB){n.push({name:e,value:t.datas.valB});n.push({name:e+".operator",value:t.datas.operatorB})}});if(!a)t.paging.pageCurrent=1}n.push({name:BJUI.pageInfo.pageSize,value:t.paging.pageSize});n.push({name:BJUI.pageInfo.pageCurrent,value:t.paging.pageCurrent});return n},setDomData:function(i){var a=t.columnModel,n={},o=i.attr("data-hidden-datas"),r=t.attach;i.find("> td").each(function(t){var i=e(this),o=a[t],r=i.attr("data-val")||i.text();if(!o.name)n["datagrid-noname"+t]=r;else n[o.name]=r});if(o)o=o.toObj();e.extend(n,r,{gridNumber:i.index()+1},o);i.data("initData",n);return n},initEditInputs:function(){var i=t.columnModel;t.inputs=[];e.each(i,function(i,a){var n=a.name,o="",r="",s=[],l="";if(!a)return;if(a.attrs&&typeof a.attrs=="object"){e.each(a.attrs,function(e,t){l+=" "+e+"="+t})}if(a==t.linenumberColumn||a==t.checkboxColumn||a==t.editBtnsColumn){t.inputs.push("")}else if(n){if(a.rule)o=' data-rule="'+a.label+"："+a.rule+'"';else if(a.type=="date")o=' data-rule="pattern('+(a.pattern||"yyyy-MM-dd")+')"';if(a.type){switch(a.type){case"date":if(!a.pattern)a.pattern="yyyy-MM-dd";r=' data-pattern="'+a.pattern+'"';t.inputs.push('<input type="text" name="'+n+'" data-toggle="datepicker"'+r+o+l+">");break;case"select":if(!a.items)return;e.each(a.items,function(t,i){e.each(i,function(e,t){s.push('<option value="'+e+'">'+t+"</option>")})});t.inputs.push('<select name="'+n+'" data-toggle="selectpicker"'+o+l+' data-width="100%">'+s.join("")+"</select>");break;case"boolean":t.inputs.push('<input type="checkbox" name="'+n+'" data-toggle="icheck"'+o+l+' value="true">');break;case"lookup":t.inputs.push('<input type="text" name="'+n+'" data-toggle="lookup" data-custom-event="true"'+o+l+">");break;case"spinner":t.inputs.push('<input type="text" name="'+n+'" data-toggle="spinner"'+o+l+">");break;case"textarea":t.inputs.push('<textarea data-toggle="autoheight" rows="1"'+o+l+"></textarea>");break;default:t.inputs.push('<input type="text" name="'+n+'"'+o+l+">");break}}else{t.inputs.push('<input type="text" name="'+n+'"'+o+l+">")}}else{t.inputs.push("")}});return t.inputs},contextmenuH:function(){var i=this;t.$tableH.on("contextmenu",function(a){if(!t.$showhide)i.createShowhide();var n=a.pageX;var o=a.pageY;if(e(window).width()<n+t.$showhide.width())n-=t.$showhide.width();if(e(window).height()<o+t.$showhide.height())o-=t.$showhide.height();if(t.$menu){t.$grid.trigger("click.bjui.datagrid.filter")}t.$showhide.appendTo("body").css({left:n,top:o,opacity:1,"z-index":9999}).show();e(document).on("click",function(i){var a=e(i.target).closest("."+t.classnames.s_showhide);if(!a.length)t.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(t.$grid)});a.preventDefault();a.stopPropagation()})},contextmenuB:function(e,i){e.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(e,i){t.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(e,i){t.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(e,a){var n=e;if(i)n=t.$tbody.find("> tr:eq("+n.index()+")");t.doEditRow(n)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(e,a){var n=e;if(i)n=t.$tbody.find("> tr:eq("+n.index()+")");if(!n.hasClass(t.classnames.tr_edit)){n=t.$tbody.find("> tr."+t.classnames.tr_edit)}t.doCancelEditRow(n)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(e,a){var n=e;if(i)n=t.$tbody.find("> tr:eq("+n.index()+")");t.delRows(n)}}]})}};return a};t.prototype.createTable=function(){var e=this,t=e.options,i=e.tools;if(t.columns)i.createThead();if(t.data||t.dataUrl)i.createTbody()};t.prototype.setColumnModel=function(){var t=this,i=t.options,a=t.$thead.find("> tr"),n=[],o=[],r=a.length;if(!t.isDom){t.tools.appendColumns();var s,l=r>1?' rowspan="'+r+'"':"";if(i.showCheckboxcol){t.columnModel.push(t.checkboxColumn);if(i.showCheckboxcol=="lock")t.checkboxColumn.initLock=true;s=e("<th"+l+'><input type="checkbox" data-toggle="icheck"></th>');s.prependTo(a.first());if(l)s.data("datagrid.column",t.checkboxColumn)}if(i.showLinenumber){t.columnModel.unshift(t.linenumberColumn);if(i.showLinenumber=="lock")t.linenumberColumn.initLock=true;s=e('<th class="datagrid-linenumber-td"'+l+">No.</th>");s.prependTo(a.first());if(l)s.data("datagrid.column",t.linenumberColumn)}if(i.showEditbtnscol){t.columnModel[s.index()]=t.editBtnsColumn;s=e("<th"+l+">Edit</th>");s.appendTo(a.first());if(l)s.data("datagrid.column",t.editBtnsColumn)}}if(a.length&&r==1){a.height(25);a.find("> th").each(function(a){var n=e(this).addClass("single-row"),o=n.data("options"),r=n.attr("width")||n.outerWidth(),s=n.html();if(t.columnModel.length&&t.columnModel[a]){o=t.columnModel[a]}else{if(o&&typeof o=="string")o=o.toObj();if(typeof o!="object")o={};o.index=a;o.label=s;o.width=typeof o.width=="undefined"?r:o.width;o.menu=typeof o.menu=="undefined"?true:o.menu;o.lock=typeof o.lock=="undefined"?true:o.lock;o.hide=typeof o.hide=="undefined"?false:o.hide;o.edit=typeof o.edit=="undefined"?true:o.edit;o.add=typeof o.add=="undefined"?true:o.add;o.quicksort=typeof o.quicksort=="undefined"?true:o.quicksort;t.columnModel[a]=o}o.th=n;n.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+s+'</div><div class="'+t.classnames.th_cell+'"><div class="'+t.classnames.th_resizemark+'"></div></div></div>');if(o.menu&&i.columnMenu)n.addClass(t.classnames.th_menu);if(i.fieldSortable&&o.quicksort)n.addClass("datagrid-quicksort-th");if(o.align)n.attr("align",o.align);n.data("index",a).find("> div").css("height","24px")})}else{a.each(function(a){var r=[],s=[],l=-1,d=0;if(n.length){r=n.concat();s=o.concat()}n=[];o=[];e(this).height(25).find("> th").each(function(a){var c=e(this),f=c.data("options")||c.data("datagrid.column")||{},u=parseInt(c.attr("colspan")||0),h=parseInt(c.attr("rowspan")||0),p=c.attr("width")||c.outerWidth(),g=c.html();if(f&&typeof f=="string")f=f.toObj();if(typeof f!="object")f={};if(!-[1]&&u==1)u=0;f.label=g;f.th=c;if(f.gridCheckbox)f.label="Checkbox";l++;if(u){f.colspan=u;for(var m=r.length?r[l]:l,v=m;v<m+u;v++){n[d++]=v;o[d-1]=f}l+=u-1;c.data("index",l);if(r.length){f.parent=s[l]}}if(!h||h==1)c.addClass("single-row");if(!u){f.width=typeof f.width=="undefined"?p:f.width;f.menu=typeof f.menu=="undefined"?true:f.menu;f.lock=typeof f.lock=="undefined"?true:f.lock;f.hide=typeof f.hide=="undefined"?false:f.hide;f.edit=typeof f.edit=="undefined"?true:f.edit;f.add=typeof f.add=="undefined"?true:f.add;f.quicksort=typeof f.quicksort=="undefined"?true:f.quicksort;c.html('<div style="height:'+(h?h*24:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+g+'</div><div class="'+t.classnames.th_cell+'"><div class="'+t.classnames.th_resizemark+'"></div></div></div>');if(f.menu&&i.columnMenu)c.addClass(t.classnames.th_menu);if(i.fieldSortable&&f.quicksort)c.addClass("datagrid-quicksort-th");if(f.align)c.attr("align",f.align);if(!r.length){f.index=l;t.columnModel[l]=f}else{f.index=r[l];f.parent=s[l];t.columnModel[r[l]]=f}c.data("index",f.index)}else{c.html('<div style="height:'+(h?h*24:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+g+'</div><div class="'+t.classnames.th_cell+'"><div class="'+t.classnames.th_resizemark+'"></div></div></div>')}})})}};t.prototype.init=function(){if(!this.$element.isTag("table"))return;if(this.$element.data("bjui.datagrid.init"))return;var t=this,i,a=t.tools,n=t.$element.parent(),o;if(t.options.options){if(typeof t.options.options=="string")t.options.options=t.options.options.toObj();e.extend(t.options,typeof t.options.options=="object"&&t.options.options)}t.parentH=n.height();i=t.options;t.$element.data("bjui.datagrid.init",true);if(!i.width)o=n.width();if(String(i.width).endsWith("%"))o=Math.round(n.width()*parseInt(String(i.width).replace("%",""))/100);i.height=i.height||300;t.isDom=false;t.columnModel=[];t.inputs=[];t.$grid=e('<div class="bjui-datagrid"></div>').width(i.width).height(i.height);t.$boxH=e('<div class="datagrid-box-h"></div>');t.$boxB=e('<div class="datagrid-box-b"></div>');t.$boxM=e('<div class="datagrid-box-m"></div>').appendTo(t.$grid);t.regional=BJUI.regional.datagrid;t.$element.before(t.$grid);if(typeof i.paging=="string")i.paging=i.paging.toObj();t.paging=e.extend({},{pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},typeof i.paging=="object"&&i.paging);t.attach={gridNumber:0,gridCheckbox:"#checkbox#",gridEdit:"#edit#"};t.$thead=t.$element.find("> thead");t.$tbody=t.$element.find("> tbody");if(t.$tbody&&t.$tbody.find("> tr").length)t.isDom=true;if(i.columns){if(typeof i.columns=="string"){if(i.columns.trim().startsWith("[")){i.columns=i.columns.toObj()}else{i.columns=i.columns.toFunc()}}if(typeof i.columns=="function"){i.columns=i.columns.call()}t.$thead=null;a.createThead()}else{if(t.$thead&&t.$thead.length&&t.$thead.find("> tr").length){t.setColumnModel()}}t.initTop();t.$grid.data("bjui.datagrid.table",t.$element.clone());if(t.isDom){a.appendColumns();t.$tbody.find("> tr > td").each(function(){var t=e(this),i=t.html();t.html("<div>"+i+"</div>")});if(!t.paging.total){t.paging.total=t.$tbody.find("> tr").length;t.paging.pageCount=1}else{t.paging.pageCount=a.getPageCount(t.paging.pageSize,t.paging.total)}t.paging.pageCurrent=1;t.initThead()}else{t.$tbody=null;if(i.data||i.dataUrl)a.createTbody()}};t.prototype.refresh=function(){var t=this,i=t.options,a=t.tools,n=t.isDom,o=BJUI.pageInfo,r=t.paging,s={};if(!i.dataUrl){if(i.data&&i.data.length){a.initTbody(t.allData,true);return}BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!");return}s[o.pageSize]=r.pageSize;s[o.pageCurrent]=r.pageCurrent;a.loadData(s,true);t.filterDatas=null;e.each(t.columnModel,function(e,t){t.th.trigger("bjui.datagrid.th.filter",[false]);t.isFiltered=false;if(t.quickfilter)t.quickfilter.trigger("bjui.datagrid.thead.clearfilter")});t.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove()};t.prototype.destroy=function(){var e=this,t=e.$grid.data("bjui.datagrid.table");if(t){e.$element.html(t.html()).insertBefore(e.$grid);e.$grid.remove()}};t.prototype.initTop=function(){var t=this,i=t.options,a=t.regional,n=false,o,r='<div class="btn-group" role="group"></div>',s='<button type="button" class="btn" data-icon=""></button>';if(i.gridTitle){t.$boxT=e('<div class="datagrid-title">'+i.gridTitle+"</div>");t.$boxT.appendTo(t.$grid)}if(i.showToolbar){if(i.toolbarItem||i.toolbarCustom){t.$toolbar=e('<div class="datagrid-toolbar"></div');if(i.toolbarItem){n=true;if(i.toolbarItem.indexOf("all")>=0)i.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export";e.each(i.toolbarItem.split(","),function(a,n){n=n.trim().toLocaleLowerCase();if(!o||n=="|"){o=e(r).appendTo(t.$toolbar);if(n=="|")return true}if(n=="add"){t.$toolbar_add=e(s).attr("data-icon","plus").addClass("btn-blue").text(BJUI.getRegional("datagrid.add")).appendTo(o).on("click",function(e){t.add()})}else if(n=="edit"){t.$toolbar_edit=e(s).attr("data-icon","edit").addClass("btn-green").text(BJUI.getRegional("datagrid.edit")).appendTo(o).on("click",function(a){var n=t.$tbody.find("> tr."+t.classnames.tr_selected);if(!n.length){e(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}else{if(i.inlineEditMult){t.doEditRow(n)}else{if(t.$lastSelect)t.doEditRow(t.$lastSelect);else t.doEditRow(n.first())}}})}else if(n=="cancel"){t.$toolbar_calcel=e(s).attr("data-icon","undo").addClass("btn-orange").text(BJUI.getRegional("datagrid.cancel")).appendTo(o).on("click",function(e){t.doCancelEditRow(t.$tbody.find("> tr."+t.classnames.tr_edit))})}else if(n=="save"){t.$toolbar_save=e(s).attr("data-icon","save").addClass("btn-default").text(BJUI.getRegional("datagrid.save")).appendTo(o).on("click",function(e){t.doSaveEditRow()})}else if(n=="del"){t.$toolbar_del=e(s).attr("data-icon","times").addClass("btn-red").text(BJUI.getRegional("datagrid.del")).appendTo(o).on("click",function(i){var a=t.$tbody.find("> tr."+t.classnames.tr_selected);if(a.length){t.delRows(a)}else{e(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}})}else if(n=="refresh"){t.$toolbar_refresh=e(s).attr("data-icon","refresh").addClass("btn-green").text(BJUI.getRegional("datagrid.refresh")).appendTo(o).on("click",function(e){t.refresh()})}else if(n=="import"){t.$toolbar_add=e(s).attr("data-icon","sign-in").addClass("btn-blue").text(BJUI.getRegional("datagrid.import")).appendTo(o).on("click",function(e){if(i.importOption){var a=i.importOption;if(typeof a=="string")a=a.toObj();if(a.options&&a.options.url){if(a.type=="dialog"){t.$grid.dialog(a.options)}else if(a.type=="navtab"){t.$grid.navtab(a.options)}else{t.$grid.bjuiajax("doAjax",a.options)}}}})}else if(n=="export"){t.$toolbar_add=e(s).attr("data-icon","sign-out").addClass("btn-green").text(BJUI.getRegional("datagrid.export")).appendTo(o).on("click",function(a){if(i.exportOption){var n=i.exportOption;if(typeof n=="string")n=n.toObj();if(n.options&&n.options.url){if(n.type=="dialog"){t.$grid.dialog(n.options)}else if(n.type=="navtab"){t.$grid.navtab(n.options)}else if(n.type=="file"){e.fileDownload(n.options.url,{failCallback:function(e,i){if(e.trim().startsWith("{"))e=e.toObj();t.$grid.bjuiajax("ajaxDone",e)}})}else{t.$grid.bjuiajax("doAjax",n.options)}}}})}})}if(i.toolbarCustom){var l,d=e('<div style="display:inline-block;"></div>');if(typeof i.toolbarCustom=="string"){var c=e(i.toolbarCustom);if(c&&c.length){l=c}else{c=c.toFunc();if(c){l=c.call(t);if(typeof l=="string")l=e(l)}}}else if(typeof i.toolbarCustom=="function"){l=i.toolbarCustom.call(t);if(typeof l=="string")l=e(l)}else{l=i.toolbarCustom}if(l&&l.length&&typeof l!="string"){if(n){d.css("margin-left","5px")}d.appendTo(t.$toolbar);l.appendTo(d)}}t.$toolbar.appendTo(t.$grid)}}};t.prototype.initThead=function(){var t=this,i=t.options,a=t.tools,n=t.columnModel,o,r=[],s=t.$tbody.find("> tr:first-child > td");t.init_thead=true;t.$colgroupH=e("<colgroup></colgroup>");t.$tableH=e('<table class="table table-bordered"></table>').append(t.$thead);t.$trsH=t.$thead.find("> tr");t.table_width=0;e.each(t.columnModel,function(e,i){o=i.width?i.width:s.eq(e).outerWidth()||50;r.push('<col style="width:'+o+'px;">');i.width=o;t.table_width+=o});t.$thead.before(t.$colgroupH.append(r.join("")));t.$grid.append(t.$boxH.append(e('<div class="datagrid-wrap-h"></div>').append(t.$tableH)));var l=t.$trsH.find("> th");l.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(i){var o=e(i.target);if(!o.closest("."+t.classnames.th_cell).length&&!t.isResize)a.quickSort(n[e(this).data("index")])});l.filter(".datagrid-column-menu").on("bjui.datagrid.th.filter",function(i,a){var n=e(this),o=n.find("> div > ."+t.classnames.th_cell+"> ."+t.classnames.btn_menu+"> .btn");if(a){n.addClass("filter-active");o.find("> i").attr("class","fa fa-filter")}else{n.removeClass("filter-active");o.find("> i").attr("class","fa fa-bars")}});if(i.contextMenuH){a.contextmenuH()}t.initTbody();if(i.columnResize)t.colResize();if(i.columnMenu)t.colMenu();if(i.paging)t.initPaging();if(i.editMode)t.edit();t.resizeGrid();var d=function(){if(i.showTfoot)t.initTfoot();t.initLock();t.$grid.initui();if(i.height)a.fixedH();setTimeout(function(){t.fixedWidth("init")},500);t.initEvents()};if(i.filterThead){if(t.delayRender){t.delayFilterTimeout=setInterval(function(){if(!t.delayRender){clearInterval(t.delayFilterTimeout);t.filterInThead();d()}},100)}else{t.filterInThead();d()}}else{d()}};t.prototype.fixedWidth=function(t){var i=this,a=i.options,n,o=0,r,s,l=i.columnModel,d=l.length;if(t&&i.initFixedW)return;i.initFixedW=true;var c=function(){i.$boxH.find("> div").css("width","");i.$boxB.find("> div").css("width","");i.$boxF&&i.$boxF.find("> div").css("width","");i.$pagingCon&&i.$pagingCon.css("width","");n=i.$boxB.find("> div").width();if(n){i.$boxB.find("> div").width(n);i.$boxH.find("> div").width(n);i.$boxF&&i.$boxF.find("> div").width(n);if(i.table_width>n)i.$pagingCon&&i.$pagingCon.width(n);else i.$pagingCon&&i.$pagingCon.width(i.table_width)}};var f=function(){if(n&&n<i.table_width){if(l[d-1]==i.editBtnsColumn){o+=i.editBtnsColumn.width;d--}if(l[0]==i.linenumberColumn){o+=i.linenumberColumn.width;d--}if(l[0]==i.checkboxColumn||l[1]==i.checkboxColumn){o+=i.checkboxColumn.width;d--}r=parseInt((n-i.table_width-o)/d);if(!r)r=-1;else r--;e.each(l,function(e,t){if(t==i.linenumberColumn||t==i.checkboxColumn||t==i.editBtnsColumn)return true;s=t.width+r;if(s<=0)s=1;i.$colgroupH.find("> col:eq("+t.index+")").width(s);i.$colgroupB.find("> col:eq("+t.index+")").width(s);i.$colgroupF&&i.$colgroupF.find("> col:eq("+t.index+")").width(s);t.new_width=s})}};if(a.fullGrid){c();f()}else{c()}};t.prototype.initTbody=function(){var t=this,i=t.options,a=t.tools,n=t.$tbody.find("> tr"),o=n.find("> td"),r="0";t.init_tbody=true;t.$colgroupB=t.$colgroupH.clone();t.$tableB=t.$element;t.$tableB.removeAttr("data-toggle width").empty().append(t.$tbody);t.$tbody.before(t.$colgroupB);t.$grid.append(t.$boxB.append(e('<div class="datagrid-wrap-b"></div>').append(t.$tableB)));if(!-[1])r="auto";if(i.fullGrid)r="100%";t.$tableH.width(r);t.$tableB.width(r);t.$tableB.addClass("table table-bordered").removeClass("table-hover");t.$boxB.scroll(function(){t.$boxH.find("> div").prop("scrollLeft",this.scrollLeft);t.$boxF&&t.$boxF.find("> div").prop("scrollLeft",this.scrollLeft);t.$lockB&&t.$lockB.prop("scrollTop",this.scrollTop)});if(t.isDom){if(i.showLinenumber){t.showLinenumber(i.showLinenumber)}if(i.showCheckboxcol){t.showCheckboxcol(i.showCheckboxcol)}if(i.showEditbtnscol){t.showEditCol(i.showEditbtnscol)}t.$grid.data(t.datanames.tbody,t.$tbody.clone())}};t.prototype.initEvents=function(t){var i=this,a=i.options,n=i.$tbody.find("> tr");if(!t)t=n;t.on("click.bjui.datagrid.tr",function(t,a){var n=e(this),o=n.index(),r=i.$tbody.find("> tr."+i.classnames.tr_selected),s=i.$lastSelect,l,d=i.$lockTbody&&i.$lockTbody.find("> tr");if(a){l=a.is(":checked");if(!l)i.$lastSelect=n;i.selectedRows(n,!l)}else{if(n.hasClass(i.classnames.tr_edit))return;if(!BJUI.KeyPressed.ctrl&&!BJUI.KeyPressed.shift){if(r.length>1&&n.hasClass(i.classnames.tr_selected)){i.selectedRows(r.not(n));i.$lastSelect=n}else{if(r.length&&r[0]!=this)i.selectedRows(null);if(!n.hasClass(i.classnames.tr_selected))i.$lastSelect=n;i.selectedRows(n)}}else{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();if(BJUI.KeyPressed.ctrl){if(!n.hasClass(i.classnames.tr_selected))i.$lastSelect=n;i.selectedRows(n)}else if(BJUI.KeyPressed.shift){if(!s)s=i.$lastSelect=n;if(s.length){i.selectedRows(null);if(s.index()!=o){if(s.index()>o){i.selectedRows(n.nextUntil(s).add(n).add(s),true)}else{i.selectedRows(n.prevUntil(s).add(n).add(s),true)}}else{i.selectedRows(o)}}}}}}).on("mouseenter.bjui.datagrid",function(t){var a=e(this),n=a.index();a.addClass("datagrid-hover");i.$lockTbody&&i.$lockTbody.find("> tr:eq("+n+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(t){var a=e(this),n=a.index();a.removeClass("datagrid-hover");i.$lockTbody&&i.$lockTbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")}).on("bjui.datagrid.tr.delete",function(t){var a=e(this),n=a.index(),o=i.data,r,s=i.allData,l=i.$lockTbody&&i.$lockTbody.find("> tr");if(!i.isDom){r=o[n].gridIndex;i.data=o.remove(n);i.allData=s.remove(r)}if(i.columnModel[0]==i.linenumberColumn){a.nextAll().each(function(){var t=e(this).find("> td:eq(0)"),i=parseInt(t.text());t.text(i-1)});l&&l.eq(n).trigger("bjui.datagrid.tr.delete",[n])}a.remove()});if(a.contextMenuB){t.each(function(){i.tools.contextmenuB(e(this))})}t.each(function(){var t=e(this);t.find("> td."+i.classnames.td_checkbox).find("input").on("ifClicked",function(){t.trigger("click.bjui.datagrid.tr",[e(this)])})});if(i.checkboxColumn&&i.checkboxColumn.th){i.checkboxColumn.th.find("input").on("ifChanged",function(){var t=e(this).is(":checked"),a=i.$tbody.find("> tr");i.selectedRows(a,t)})}};t.prototype.initTfoot=function(){var t=this,i=t.options,a=t.tools,n=t.columnModel,o=e("<tr></tr>");t.$boxF=e('<div class="datagrid-box-f"></div>');t.$colgroupF=t.$colgroupH.clone();t.$tableF=t.$tableH.clone().empty();t.$tableF.append(t.$colgroupF);t.$boxF.append(e('<div class="datagrid-wrap-h"></div>').append(t.$tableF));t.$boxF.insertAfter(t.$boxB);t.$tfoot=e("<thead></thead>");e.each(n,function(t,i){var a=e("<th><div></div></th>");if(i.calc){var n='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>';if(i.calc=="avg")a.html(n.replace("#tit#",i.calcTit||"AVG").replace("#number#",(i.calc_sum/i.calc_count).toFixed(i.calcDecimal||2)));else if(i.calc=="count")a.html(n.replace("#tit#",i.calcTit||"COUNT").replace("#number#",i.calc_count));else if(i.calc=="sum")a.html(n.replace("#tit#",i.calcTit||"SUM").replace("#number#",i.calc_sum));else if(i.calc=="max")a.html(n.replace("#tit#",i.calcTit||"MAX").replace("#number#",i.calc_max));else if(i.calc=="min")a.html(n.replace("#tit#",i.calcTit||"MIN").replace("#number#",i.calc_min))}if(i.hidden)a.css("display","none");a.appendTo(o)});t.$tfoot.append(o).appendTo(t.$tableF);t.$tfoot.on("bjui.datagrid.tfoot.resizeH",function(){a.setBoxbH(i.height)})};t.prototype.selectedRows=function(t,i){var a=this,n=a.$lockTbody&&a.$lockTbody.find("> tr"),o=a.$tbody.find("> tr"),r;var s=function(e){if(typeof i=="undefined")i=true;o.eq(e).toggleClass(a.classnames.tr_selected,i).find("> td."+a.classnames.td_checkbox+" input").iCheck(i?"check":"uncheck");n&&n.eq(e).toggleClass(a.classnames.tr_selected,i).find("> td."+a.classnames.td_checkbox+" input").iCheck(i?"check":"uncheck")};if(t==null){o.removeClass(a.classnames.tr_selected).find("> td."+a.classnames.td_checkbox+" input").iCheck("uncheck");n&&n.removeClass(a.classnames.tr_selected).find("> td."+a.classnames.td_checkbox+" input").iCheck("uncheck")}else if(typeof t=="object"){t.each(function(){var t=e(this),o=t.index();if(typeof i!="undefined"){s(o)}else{t.toggleClass(a.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+a.classnames.td_checkbox+" input").iCheck(t.hasClass(a.classnames.tr_selected)?"check":"uncheck");n&&n.eq(o).toggleClass(a.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+a.classnames.td_checkbox+" input").iCheck(t.hasClass(a.classnames.tr_selected)?"check":"uncheck")}})}else if(isNaN(t)){e.each(t.split(","),function(e,t){s(parseInt(t.trim()))})}else if(!isNaN(t)){s(parseInt(t))}if(a.$lastSelect&&!a.$lastSelect.hasClass(a.classnames.tr_selected)){a.$lastSelect=null}a.$element.data("selectedTrs",a.$tbody.find("> tr."+a.classnames.tr_selected))};t.prototype.initLock=function(){var t=this,i=t.columnModel;t.col_lock_count=0;e.each(t.columnModel,function(e,i){if(i.initLock)t.col_lock_count++});if(t.col_lock_count)t.doLock()};t.prototype.colLock=function(t,i){var a=this,n,o,r;if(e.type(t)=="number"){o=parseInt(t);if(o<0||o>a.columnModel.length-1)return;r=a.columnModel[o];n=r.th}else{n=t;o=n.data("index");r=a.columnModel[o]}if(r==a.editBtnsColumn)return;else if(r.index==a.columnModel.length-1)return;if(typeof r.locked=="undefined")r.locked=false;if(r.locked==i)return;r.initLock=i;if(i){a.col_lock_count++}else{a.col_lock_count--}if(a.col_lock_count<0)a.col_lock_count=0;a.doLock()};t.prototype.fixedLockItem=function(t){var i=this,a=i.columnModel,n=i.$thead.find("> tr.datagrid-filter > th"),o=i.$lockTbody&&i.$lockTbody.find("> tr");if(!t){if(n&&n.length){i.$lockThead&&i.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var t=e(this),i=t.index(),a=n.eq(i);t.clone().insertAfter(t);t.hide().insertAfter(a);a.remove()})}if(o&&o.length){o.filter("."+i.classnames.tr_edit).each(function(){var t=e(this),n=t.find("> td:eq("+a.lockIndex+")"),o=t.index(),r,s;if(n.hasClass(i.classnames.td_edit)){r=i.$tbody.find("> tr:eq("+o+")"),s=r.find("> td:eq("+index+")");n.clone().insertAfter(n);n.hide().insertAfter(s);s.remove()}})}}else{if(n&&n.length){i.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var t=e(this),i=t.index(),a=n.eq(i);a.clone().html("").insertAfter(a);a.show().insertAfter(t);t.remove()})}if(o&&o.length){o.filter("."+i.classnames.tr_edit).each(function(){var t=e(this),n=t.index();t.find("> td."+i.classnames.td_edit+":visible").each(function(){var t=e(this),o=t.index(),r=a[o],s,l;if(r.locked){s=i.$tbody.find("> tr:eq("+n+")");l=s.find("> td:eq("+o+")");l.clone().insertAfter(l);l.show().insertAfter(t);t.remove()}})})}}};t.prototype.doLock=function(){var t=this,i=t.options,a=t.tools,n=t.columnModel,o=t.$tableH.width(),r=0,s,l,d=0;var c=t.$boxF&&true,f=0;if(!t.$lockBox||!t.$lockBox.length){t.$lockBox=e('<div class="datagrid-box-l"></div>');t.$lockH=e('<div class="datagrid-box-h"></div>');t.$lockB=e('<div class="datagrid-box-b"></div>');t.$lockF=e('<div class="datagrid-box-f"></div>');t.$lockTableH=e('<table class="table table-bordered"></table>');t.$lockTableB=e("<table></table>").addClass(t.$tableB.attr("class"));t.$lockTableF=e('<table class="table table-bordered"></table>');t.$lockH.append(t.$lockTableH);t.$lockB.append(t.$lockTableB);t.$lockF.append(t.$lockTableF);t.$lockBox.append(t.$lockH).append(t.$lockB).prependTo(t.$grid);if(c){t.$lockBox.append(t.$lockF);t.$lockF.css("margin-top",t.$boxB.outerHeight()-t.$boxB[0].clientHeight).height(t.$boxF.outerHeight())}}else{t.fixedLockItem();t.$lockTableH.empty();t.$lockTableB.empty();t.$lockTableF&&t.$lockTableF.empty()}if(t.$boxT)f+=t.$boxT.outerHeight();if(t.$toolbar)f+=t.$toolbar.outerHeight();if(f)t.$lockBox.css({top:f});e.each(n,function(e,t){t.lockShow=false;t.lockHide=false;if(t.initLock){if(t.hidden)a.showhide(t,true);t.lockHide=true;t.locked=true;t.lockIndex=d++;r+=t.width}else{t.lockShow=true;if(!t.hidden)a.showhide(t,false);else t.lockShow=false;if(t.locked)t.lockShow=true;t.locked=false}});t.$lockThead=t.$thead.clone(true);t.$lockTbody=t.$tbody.clone();t.$lockColgroupH=t.$colgroupH.clone();t.$lockColgroupB=t.$colgroupB.clone();t.$lockTableH.append(t.$lockColgroupH).append(t.$lockThead).css("width",r);t.$lockTableB.append(t.$lockColgroupB).append(t.$lockTbody).css("width",r);if(c){t.$lockTfoot=t.$tableF.find("> thead").clone();t.$lockColgroupF=t.$colgroupF.clone();t.$lockTableF.append(t.$lockColgroupF).append(t.$lockTfoot).css("width",r)}e.each(t.columnModel,function(e,t){if(t.lockShow)a.showhide(t,true);if(t.lockHide)a.showhide(t,false)});t.$boxH.find("> div").css("width","");t.$boxB.find("> div").css("width","");t.$boxF&&t.$boxF.find("> div").css("width","");setTimeout(function(){var e=t.$boxB.find("> div").width();t.$boxB.find("> div").width(e);t.$boxH.find("> div").width(e);t.$boxF&&t.$boxF.find("> div").width(e)},50);if(t.col_lock_count==0)t.$lockBox.hide();else t.$lockBox.show();if(r>1)r=r-1;t.$boxH.css("margin-left",r);t.$boxB.css("margin-left",r);if(c)t.$boxF.css("margin-left",r);t.$lockB.height(t.$boxB[0].clientHeight);t.$lockB.prop("scrollTop",t.$boxB[0].scrollTop);var u=t.$lockTableH.height(),h=t.$thead.height(),p=t.$lockTableF&&t.$lockTableF.height(),g=t.$tableF&&t.$tableF.height();if(u!=h){if(u<h)t.$lockTableH.height(h);else t.$tableH.height(u)}if(p&&g&&p!=g){if(p<g)t.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(g);else t.$tableF.find("> thead > tr:first-child > th:visible:first").height(p)}l=t.$lockTbody.find("> tr");s=t.$tbody.find("> tr");setTimeout(function(){var i=t.$lockTableB.height(),a=t.$tableB.height();if(i!=a){if(i>a){l.each(function(t){var i=e(this),a=i.find("> td:visible:first"),n=a.outerHeight();if(n>30){i.height(n);s.eq(t).height(n)}})}else{s.each(function(t){var i=e(this),a=i.find("> td:visible:first"),n=a.outerHeight();if(n>30){i.height(n);l.eq(t).height(n)}})}}},20);t.fixedLockItem(1);l.find("> td:hidden").remove();t.initLockEvents(l)};t.prototype.initLockEvents=function(t){if(!this.$lockTbody)return;var i=this,a=i.options;if(!t)t=i.$lockTbody.find("> tr");t.on("click.bjui.datagrid.tr",function(){var t=e(this).index();i.$tbody.find("> tr:eq("+t+")").trigger("click.bjui.datagrid.tr")}).on("bjui.datagrid.tr.delete",function(t,a){var n=e(this);if(i.linenumberColumn&&i.linenumberColumn.locked){n.nextAll().each(function(){var t=e(this).find("> td:eq(0)"),i=parseInt(t.text());t.text(i-1)})}n.remove()}).find("> td."+i.classnames.td_checkbox+" input").on("ifChanged",function(){var t=e(this),a=t.closest("tr"),n=a.index();if(t.is(":checked")){a.addClass(i.classnames.tr_selected);$trs.eq(n).addClass(i.classnames.tr_selected)}else{a.removeClass(i.classnames.tr_selected);$trs.eq(n).removeClass(i.classnames.tr_selected)}});if(a.contextMenuB){t.each(function(){i.tools.contextmenuB(e(this),true)})}};t.prototype.filterInThead=function(){var t=this,i=t.options,a=t.tools,n=t.regional,o=t.columnModel,r={};var s=e('<tr class="datagrid-filter"></tr>');var l=function(e,t,i){var a=t.type;if(a=="date"){e.on("afterchange.bjui.datepicker",function(i,a){d(t,e.val())}).change(function(){d(t,e.val())})}else if(a=="lookup"){i.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(i,a){for(var n in a){if(t.name==n){e.val(a[n]);d(t,a[n])}}});e.change(function(){d(t,e.val())})}else{e.change(function(){d(t,e.val())})}};var d=function(e,t){a.quickFilter(e,t?{operatorA:"like",valA:t}:null)};if(!t.inputs||!t.inputs.length)a.initEditInputs();e.each(o,function(i,a){var o=e(t.inputs[i]),r=e("<th></th>");if(a.type=="spinner")o=e('<input type="text" name="'+a.name+'">');else if(a.type=="boolean")o=e(BJUI.doRegional('<select name="'+a.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',n));else if(a.type=="select"){if(o.find("> option:first-child").val()){o=e('<select name="'+a.name+'" data-toggle="selectpicker"></select>').append(BJUI.doRegional('<option value="">#all#</option>',n)).append(o.html())}}r.append(o);if(a.hidden)r.hide();if(a.type=="boolean")r.attr("align","center");r.appendTo(s);o.data("clearFilter",false);l(o,a,r);o.on("bjui.datagrid.thead.clearfilter",function(){o.val("");if(a.type=="boolean"||a.type=="select")o.selectpicker("refresh")});a.quickfilter=o});s.appendTo(t.$thead).initui()};t.prototype.showLinenumber=function(t){var i=this,a=i.options,n=i.columnModel,o=n[0],r=i.data;if(o==i.linenumberColumn){if(typeof t==="string"&&(t=="lock"||t=="unlock")){i.colLock(o.th,t=="lock"?true:false)}else{i.showhideColumn(o.th,t?true:false)}}else if(t){var s=i.$thead.find("> tr"),l='<col style="width:30px;">',d,c=s.filter(".datagrid-filter"),f=s.length-c.length;o=i.linenumberColumn;n.unshift(o);i.$colgroupH.prepend(l);i.$colgroupB.prepend(l);i.$colgroupF&&i.$colgroupF.prepend(l);d=e('<th align="center" rowspan="'+f+'" class="'+i.classnames.td_linenumber+'">'+i.linenumberColumn.label+"</th>");s.first().prepend(d);c.length&&c.prepend("<th></th>");o.th=d;o.index=0;o.width=30;i.$tbody.find("> tr").each(function(t){e(this).prepend('<td align="center" class="'+i.classnames.td_linenumber+'">'+(t+1)+"</td>")});i.$tableF&&i.$tableF.find("> thead > tr").prepend("<th></th>");e.each(n,function(e,t){t.index=e;if(t.th)t.th.data("index",e)});if(t=="lock"){i.colLock(d,true)}if(i.$showhide){i.$showhide.remove();i.colShowhide(a.columnShowhide)}}};t.prototype.showCheckboxcol=function(t){var i=this,a=i.options,n=i.columnModel,o=n[0],r,s=i.data;if(n[0]==i.checkboxColumn)r=n[0];if(n[1]==i.checkboxColumn)r=n[1];if(r){if(typeof t==="string"&&(t=="lock"||t=="unlock")){i.colLock(r.th,t=="lock"?true:false)}else{i.showhideColumn(r.th,t)}}else if(t){var l=i.$thead.find("> tr"),d='<col style="width:26px;">',c,f,u=l.filter(".datagrid-filter"),h=l.length-u.length;r=i.checkboxColumn;c=e('<th align="center" rowspan="'+h+'" class="'+i.classnames.td_checkbox+'"><div><input type="checkbox" data-toggle="icheck"></div></th>');if(o==i.linenumberColumn){n.splice(1,0,r);s&&s.splice(1,0,{name:r.name});r.index=1;i.$colgroupH.find("> col:first").after(d);i.$colgroupB.find("> col:first").after(d);i.$colgroupF&&i.$colgroupF.find("> col:first").after(d);u.length&&u.find("> th:first").after("<th></th>");l.first().find("> th:first").after(c);i.$tableF&&i.$tableF.find("> thead > tr > th:first").after("<th></th>")}else{n.unshift(r);s&&s.unshift({name:r.name});r.index=0;i.$colgroupH.prepend(d);i.$colgroupB.prepend(d);i.$colgroupF&&i.$colgroupF.prepend(d);u.length&&u.prepend("<th></th>");l.first().prepend(c);i.$tableF&&i.$tableF.find("> thead > tr").prepend("<th></th>")}c.initui();r.th=c;r.width=26;i.$tbody.find("> tr").each(function(t){f=e('<td align="center" class="'+i.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>');if(r.index==0)e(this).prepend(f);else e(this).find("> td:first").after(f);f.initui()});e.each(n,function(e,t){t.index=e;if(t.th)t.th.data("index",e)});if(t=="lock"){i.colLock(c,true)}if(i.$showhide){i.$showhide.remove();i.colShowhide(a.columnShowhide)}}};t.prototype.showEditCol=function(t){var i=this,a=i.options,n=i.columnModel,o=n[n.length-1],r=i.data;if(o==i.editBtnsColumn){i.showhideColumn(o.th,t?true:false)}else if(t){var s=i.$thead.find("> tr"),l='<col style="width:110px;">',d,c,f=s.filter(".datagrid-filter"),u=s.length-f.length;o=i.editBtnsColumn;n.push(o);i.$colgroupH.append(l);i.$colgroupB.append(l);i.$colgroupF&&i.$colgroupF.append(l);d=e('<th align="center" rowspan="'+u+'">Edit</th>');s.first().append(d);f.length&&f.append("<th></th>");d.initui().data("index",n.length-1);o.th=d;o.width=110;o.index=n.length-1;i.$tbody.find("> tr").each(function(t){c=e('<td align="center" class="'+i.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,i.regional)+"</td>");e(this).append(c);c.initui()});i.edit(i.$tbody.find("> tr"));i.$tableF&&i.$tableF.find("> thead > tr").append("<th></th>");if(i.$showhide){i.$showhide.remove();i.colShowhide(a.columnShowhide)}}};t.prototype.colResize=function(){var t=this,i=t.tools,a=t.columnModel,n=t.$thead,o=t.$grid.find("> .resizeProxy");if(!o.length){o=e('<div class="resizeProxy" style="left:0; display:none;"></div>');o.appendTo(t.$grid)}n.find("> tr > th").each(function(n){var r=e(this),s=r.find("> div > ."+t.classnames.th_cell+"> ."+t.classnames.th_resizemark);s.on("mousedown.bjui.datagrid.resize",function(n){var s=t.$boxH.scrollLeft(),l=parseInt(t.$boxH.css("marginLeft")||0),d=i.getRight(r)-s+l,c=r.data("index"),f=a[c],u=f.th.width(),h=t.$tbody.find("> tr"),p=t.$lockTbody&&t.$lockTbody.find("> tr"),g=t.$lockTableB&&t.$lockTableB.height(),m=t.$tableB.height(),v,b;t.isResize=true;if(f.locked){d=i.getRight4Lock(f.lockIndex);if(f.lockWidth)u=f.lockWidth}o.show().css({left:d,bottom:t.$box_paging?t.$box_paging.outerHeight():0,cursor:"col-resize"}).basedrag({scop:true,cellMinW:20,relObj:o,move:"horizontal",event:n,stop:function(){var i=o.position().left,a=i-d,n=a+u,r=t.$tableH.width()+a,s=t.$lockTableH&&t.$lockTableH.width()+a;if(n<5)n=20;if(f.minWidth&&n<f.minWidth)n=f.minWidth;if(n!=u+a){r=r-a+(n-u);s=s-a+(n-u)}f.width=n;if(f.locked){if(s<t.$grid.width()*.75){f.lockWidth=n;t.$lockColgroupH.find("> col:eq("+c+")").width(n);t.$lockColgroupB.find("> col:eq("+c+")").width(n);t.$lockColgroupF&&t.$lockColgroupF.find("> col:eq("+c+")").width(n);t.$lockTableH.width(s);t.$lockTableB.width(s);t.$lockTableF&&t.$lockTableF.width(s);var l=t.$lockBox.width();t.$boxH.css("margin-left",l-1);t.$boxB.css("margin-left",l-1);t.$boxF&&t.$boxF.css("margin-left",l-1);t.$colgroupH.find("> col:eq("+c+")").width(n);t.$colgroupB.find("> col:eq("+c+")").width(n);t.$colgroupF&&t.$colgroupF.find("> col:eq("+c+")").width(n)}}else{setTimeout(function(){t.$colgroupH.find("> col:eq("+c+")").width(n);t.$colgroupB.find("> col:eq("+c+")").width(n);t.$colgroupF&&t.$colgroupF.find("> col:eq("+c+")").width(n)},1)}setTimeout(function(){h.css("height","");b=t.$tableB.height();if(t.$lockTbody){p.css("height","");v=t.$lockTableB.height();if(v!=g||b!=m){if(v>b){p.each(function(t){var i=e(this),a=i.find("> td:eq("+f.lockIndex+")"),n=a.outerHeight();if(n>30){i.height(n);h.eq(t).height(n)}})}else{h.each(function(t){var i=e(this),a=i.find("> td:eq("+c+")"),n=a.outerHeight();if(n>30){i.height(n);p.eq(t).height(n)}})}}t.$lockB.height(t.$boxB[0].clientHeight)}if(f.calc)t.$tfoot&&t.$tfoot.trigger("bjui.datagrid.tfoot.resizeH");t.isResize=false},10);o.hide();t.resizeFlag=true}})})})};t.prototype.colMenu=function(){var t=this,i=t.options,a=t.tools,n=t.regional,o=t.$trsH.find("> th."+t.classnames.th_menu),r=t.$grid.find("> ."+t.classnames.s_menu);if(!r.legnth){r=e(BJUI.doRegional(FRAG.gridMenu,n));r.hide().appendTo(t.$grid);t.$menu=r}t.colShowhide(i.columnShowhide);o.each(function(){var i=e(this),n=i.data("index"),o=t.columnModel[n],s=i.find("> div > ."+t.classnames.th_cell),l=s.find("> ."+t.classnames.btn_menu),d;if(!l.length){d=e('<button class="btn btn-default"><i class="fa fa-bars"></button>'),l=e('<div class="'+t.classnames.btn_menu+'"></div>').append(d);l.appendTo(s);d.click(function(){var n=i.closest("tr"),s=parseInt(i.attr("rowspan")||1),l=e(this).offset().left-t.$grid.offset().left-1,c=(t.$trsH.length-s)*25+13*s+11,f=r.find("> ul > li.datagrid-li-showhide"),u,h;var p=r.data("bjui.datagrid.menu.btn");if(p&&p.length)p.removeClass("active");e(this).addClass("active");if(f.length&&t.$showhide){t.$showhide.appendTo(f);h=t.$showhide.data("width")}r.css({position:"absolute",top:c,left:l}).show().data("bjui.datagrid.menu.btn",d).siblings("."+t.classnames.s_menu).hide();u=r.outerWidth();var g=function(e){if(t.$boxH.width()-e<u){r.css({left:e-u+18}).addClass("position-right")}else{r.css({left:e}).removeClass("position-right")}};var m=function(e){t.$boxB.scroll(function(){var i=e.offset().left-t.$grid.offset().left-1;g(i)})};g(l);m(d);t.colFilter(i,true);a.locking(i);var v=r.find("> ul > li."+t.classnames.li_asc),b=v.next();v.click(function(){o.sortAsc=false;a.quickSort(o)});b.click(function(){o.sortAsc=true;a.quickSort(o)});r.on("bjui.datagrid.th.sort",function(e,t){v.toggleClass("sort-active",t);b.toggleClass("sort-active",!t)})})}});t.$grid.on("click.bjui.datagrid.filter",function(i){var a=e(i.target),n=t.$grid.find("."+t.classnames.s_menu+":visible");if(n.length&&!a.closest("."+t.classnames.btn_menu).length){if(!a.closest("."+t.classnames.s_menu).length){n.hide().data("bjui.datagrid.menu.btn").removeClass("active")}}})};t.prototype.colShowhide=function(e){var t=this,i=t.options,a=t.tools,n=t.$menu,o=n.find("> ul"),r=o.find("> li."+t.classnames.li_showhide);if(e){if(!t.$showhide){a.createShowhide();a.showSubMenu(r,n,t.$showhide)}}else{r.hide()}};t.prototype.showhideColumn=function(t,i){var a=this,n=a.tools,o,r;if(e.type(t)=="number"){o=parseInt(t);if(o<0)return}else{o=t.data("index")}r=a.columnModel[o];if(r){if(r.locked){if(i)return;else a.colLock(r.th,i)}n.showhide(r,i)}};t.prototype.colFilter=function(t,i){var a=this,n=a.options,o=a.tools,r=a.regional,s=t.data("bjui.datagrid.filter"),l=a.$menu,d=l.find("> ul > li."+a.classnames.li_filter);if(!a.inputs||!a.inputs.length)o.initEditInputs();if(i){d.find("."+a.classnames.s_filter).addClass("hide");if(!s||!s.length){s=e(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",t.text()),r)).hide().appendTo(a.$grid);var c=t.data("index"),f=a.columnModel[c],u=f.type||"string",h=f.operator||[],p=s.find("span.filter-a"),g=s.find("span.filter-b"),m=e('<select data-toggle="selectpicker" data-container="true"></select>'),v=e(a.inputs[c]),b,y;v.removeAttr("data-rule").attr("size",10).addClass("filter-input");if(u=="string"||u=="lookup"){if(!h.length)h=["=","!=","like"]}else if(u=="number"||u=="int"||u=="spinner"){if(u=="spinner")v.removeAttr("data-toggle");if(!h.length)h=["=","!=",">","<",">=","<="]}else if(u=="date"){if(!h.length)h=["=","!="]}else if(u=="boolean"){if(!h.length)h=["=","!="];v=e(BJUI.doRegional('<select name="'+f.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',r))}else if(u=="select"){if(!h.length)h=["=","!="];v.attr("data-width","80");if(v.find("> option:first-child").val()){v=e('<select name="'+f.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',r)).append(v.html())}}for(var k=0;k<h.length;k++){m.append('<option value="'+h[k]+'">'+h[k]+"</option>")}b=v;y=b.clone();p.append(m).append(v);g.append(m.clone()).append(y);t.data("bjui.datagrid.filter",s);s.appendTo(d);s.data("width",s.outerWidth()).hide().initui();s.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(e,t){for(var i in t){if(f.name==i){v.val(t[i])}}});var x=s.find("button.ok"),w=s.find("button.clear"),C=s.find("select"),$=C.first(),j=C.last(),T=C.eq(1);x.click(function(){var i=$.val(),n=b.val().trim(),r=j.val(),c=y.val().trim(),f=T.val();var u={};if(n.length){e.extend(u,{operatorA:i,valA:n})}if(c.length){if(n.length)e.extend(u,{andor:f});e.extend(u,{operatorB:r,valB:c})}if(!e.isEmptyObject(u)){o.quickFilter(a.columnModel[t.data("index")],u);a.$grid.trigger("click");d.trigger("bjui.datagrid.th.submenu.hide",[l,s])}});w.click(function(){var e=a.columnModel[t.data("index")];C.find("> option:first").prop("selected",true);C.selectpicker("refresh");b.val("");y.val("");if(e.isFiltered){o.quickFilter(e,null);a.$grid.trigger("click");d.trigger("bjui.datagrid.th.submenu.hide",[l,s])}})}o.showSubMenu(d,l,s.removeClass("hide"));l.find('> ul > li:not(".'+a.classnames.li_filter+'")').on("mouseover",function(){if(d.hasClass("active"))d.trigger("bjui.datagrid.th.submenu.hide",[l,s])})}else{d.hide()}};t.prototype.initPaging=function(){var t=this,i=t.tools,a=t.options,n=t.paging,o=BJUI.regional.pagination,r=FRAG.gridPaging,s=[],l=n.pageCount,d,c=[];if(n.total==0)return;d=i.getPageInterval(l,n.pageCurrent,n.showPagenum);for(var f=d.start;f<d.end;f++){s.push(FRAG.gridPageNum.replace("#num#",f).replace("#active#",n.pageCurrent==f?" active":""))}r=BJUI.doRegional(r.replaceAll("#pageCurrent#",n.pageCurrent).replaceAll("#count#",n.total+"/"+parseInt(l||0)),o);t.$box_paging=e('<div class="datagrid-paging-box"></div>');t.$pagingCon=e('<div class="paging-content"></div>').width(t.$boxB.width());t.$refreshBtn=e('<button class="btn-default btn-refresh" title="'+o.refresh+'" data-icon="refresh"></button>');t.$paging=e('<div class="datagrid-paging"></div>');t.$btnpaging=e(r);t.$pagenum=e(s.join(""));t.$pagesize=e('<div class="datagrid-pagesize"><span></span></div>');t.$selectpage=e('<select data-toggle="selectpicker"></select>');t.$pagingCon.appendTo(t.$box_paging);t.$box_paging.appendTo(t.$grid);t.$pagesize.appendTo(t.$pagingCon);t.$refreshBtn.appendTo(t.$pagesize);t.$selectpage.appendTo(t.$pagesize);t.$paging.appendTo(t.$pagingCon);t.$btnpaging.appendTo(t.$paging);t.$pagenum.insertAfter(t.$btnpaging.find("> li.page-prev"));t.$box_paging.initui();var u=t.$btnpaging.find("> li.page-jumpto"),h=u.next(),p=h.next(),g=t.$btnpaging.find("> li.page-next"),m=g.next();var v=function(){h.addClass("disabled");p.addClass("disabled")};var b=function(){h.removeClass("disabled");p.removeClass("disabled")};var y=function(){g.addClass("disabled");m.addClass("disabled")};var k=function(){g.removeClass("disabled");m.removeClass("disabled")};var x=function(){v();k()};var w=function(){b();y()};var C=function(i){t.$selectpage.empty();if(!i)i=t.paging.pageSize;c=n.selectPageSize.split(",");c.push(String(i));e.unique(c).sort(function(e,t){return e-t});e.each(c,function(i,a){var r=e('<option value="'+a+'">'+a+"/"+o.page+"</option>");if(a==n.pageSize)r.prop("selected",true);t.$selectpage.append(r)});t.$selectpage.selectpicker("refresh")};if(n.pageCurrent==1)x();if(n.pageCurrent==n.pageCount){w();if(n.pageCurrent==1)v()}C();t.$paging.on("click",".page-num",function(i){var a=e(this);if(!a.hasClass("active")){t.jumpPage(a.text())}i.preventDefault()}).on("bjui.datagrid.paging.jump",function(a){var o=t.paging.pageCurrent,r=i.getPageInterval(t.paging.pageCount,o,n.showPagenum),s=[];for(var l=r.start;l<r.end;l++){s.push(FRAG.gridPageNum.replace("#num#",l).replace("#active#",o==l?" active":""))}t.$pagenum.empty();t.$pagenum=e(s.join(""));t.$pagenum.insertAfter(p);if(o==1){x();if(o==t.paging.pageCount)y()}else if(o==t.paging.pageCount){w()}else{b();k()}u.find("input").val(o);t.$btnpaging.find("> li.page-total > span").html(t.paging.total+"/"+t.paging.pageCount)});t.$selectpage.on("bjui.datagrid.paging.pageSize",function(e,t){C(t)});u.find("input").on("keyup",function(i){if(i.which==BJUI.keyCode.ENTER){var a=e(this).val();if(a)t.jumpPage(a)}});h.on("click",function(){if(t.paging.pageCurrent>1)t.jumpPage(1)});p.on("click",function(){if(t.paging.pageCurrent>1)t.jumpPage(t.paging.pageCurrent-1)});g.on("click",function(){if(t.paging.pageCurrent<t.paging.pageCount)t.jumpPage(t.paging.pageCurrent+1)});m.on("click",function(){if(t.paging.pageCurrent<t.paging.pageCount)t.jumpPage(t.paging.pageCount)});t.$refreshBtn.on("click",function(){t.refresh()});t.$selectpage.on("change",function(){var i=e(this).val();t.jumpPage(null,i)})};t.prototype.jumpPage=function(e,t){var i=this,a=i.paging,n=a.pageCount;if(e&&isNaN(e))return;if(t&&isNaN(t))return;if(e){e=parseInt(e);if(e<1)e=1;if(e>n)e=n;if(e==a.pageCurrent)return}if(t){t=parseInt(t);if(t>a.total)return}i.tools.jumpPage(e,t)};t.prototype.add=function(t){if(!this.tools.beforeEdit())return;if(!this.options.editUrl){BJUI.debug("Datagrid Plugin: Edit url is not set!");return}if(!this.options.editMode)return;if(!this.options.inlineEditMult){this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit))}var i=this,a=i.options,n=i.tools,o=i.paging,r,s={},l=[],d,c=(o.pageCurrent-1)*o.pageSize,f;var u=function(t){var a=e("<tr></tr>").addClass(i.classnames.tr_add),n=a.clone();e.each(i.columnModel,function(t,o){var r="",l=e("<td></td>");if(o.gridNumber)l.addClass(i.classnames.td_linenumber).text(0);else if(o.gridCheckbox)l.addClass(i.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>');else if(o.gridEdit)l.addClass(i.classnames.s_edit).data("isAdd",true).html(BJUI.doRegional(FRAG.gridEditBtn,i.regional));else l.text("");if(o.hidden)l.css("display","none");if(o.align)l.attr("align",o.align);s[o.name]="";if(o.locked){l.clone().show().appendTo(n);l.hide().appendTo(a)}else{l.appendTo(a)}});s=e.extend({},i.attach,s);if(!i.emptyData)i.emptyData=s;return{tr:a,lockTr:n.find("> td").length?n:null}};if(!t)t=a.addLocation||"first";if(!i.$lastSelect){if(t=="prev")t="first";else if(t=="next")t="last"}if(t=="first"){f=0;r=u(f);r.tr.prependTo(i.$tbody);if(r.lockTr)r.lockTr.prependTo(i.$lockTbody)}else if(t=="last"){f=i.data?i.data.length:0;r=u(f);r.tr.appendTo(i.$tbody);if(r.lockTr)r.lockTr.appendTo(i.$lockTbody)}else if(t=="prev"){f=i.$lastSelect.index();r=u(f);r.tr.insertBefore(i.$lastSelect);if(r.lockTr)r.lockTr.insertBefore(i.$lockTbody.find("> tr:eq("+i.$lastSelect.index()+")"))}else if(t=="next"){f=i.$lastSelect.index()+1;r=u(f);r.tr.insertAfter(i.$lastSelect);if(r.lockTr)r.lockTr.insertAfter(i.$lockTbody.find("> tr:eq("+i.$lastSelect.index()+")"))}var h=e.extend({},i.emptyData,{addFlag:true});if(!i.data)i.data=[];if(!i.allData)i.allData=[];if(i.allData.length){i.allData.splice(f+c,0,h)}else{i.allData.push(h)}if(i.data.length){i.data.splice(f,0,h)}else{i.data.push(h)}e.each(i.data,function(t,i){var n=a.linenumberAll?c+(t+1):t+1;e.extend(i,{gridNumber:n,gridIndex:t})});r.tr.initui();setTimeout(function(){i.initEvents(r.tr)},20);if(r.lockTr)i.initLockEvents(r.lockTr);i.edit(r.tr);if(a.editMode!="dialog"){i.doEditRow(r.tr,"inline",true)}else{i.dialogEdit(r.tr,true)}};t.prototype.edit=function(t){var i=this,a=i.options,n=i.tools,o=a.editMode,r=i.columnModel,s;if(o!="dialog")o="inline";if(!t)t=i.$tbody.find("> tr");s=t.find("> td."+i.classnames.s_edit);s.each(function(){var t=e(this),a=t.find("button"),r=a.first(),s=r.next(),l=s.next(),d=l.next(),c=d.next();r.on("click",function(r,c){var f=e(this),u=f.closest("tr"),h=t.data("isAdd");if(!c){if(i.isDom)c=u.data("initData")||n.setDomData(u);else c=i.data[u.index()]}if(!n.beforeEdit(u,c)){return false}if(o!="dialog"){i.inlineEdit(u,h);a.hide();s.show();d.show();if(h){s.hide();l.show()}}else{i.dialogEdit(u,h)}r.stopPropagation()});l.on("click",function(t){var a=e(this),n=a.closest("tr");i.updateEdit(n,a);t.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide();r.show();c.show()});s.on("click",function(t){var a=e(this),n=a.closest("tr");i.updateEdit(n,a);t.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide();r.show();c.show()});d.on("click",function(t){var n=e(this),o=n.closest("tr");i.cancelEdit(o);a.hide();r.show();c.show();t.stopPropagation()});c.on("click",function(t){var a=e(this),n=a.closest("tr");i.delRows(n);t.stopPropagation()})})};t.prototype.doEditRow=function(t,i,a){var n=this,o,r,s=[];i=i||n.options.editMode;if(typeof t=="object"){o=t}else if(isNaN(t)){var l=n.$tbody.find("> tr"),d,t=t.split(",");t=t.unique();t.sort(function(e,t){return e.trim()-t.trim()});e.each(t,function(e,t){var i=l.eq(parseInt(t.trim()));if(i&&i.length){if(!d)d=i;else d=d.add(i)}});o=d}else if(!isNaN(t)){o=n.$tbody.find("> tr").eq(t)}if(!o.length)return;o.each(function(){var t=e(this),i=t.index(),a;if(n.isDom)a=t.data("initData")||tools.setDomData(t);else a=n.data[i];s.push(a)});if(!n.tools.beforeEdit(o,s)){return}if(!n.options.editUrl){BJUI.debug("Datagrid Plugin: Edit url is not set!");return}o.each(function(t){var o=e(this);r=o.find("> td."+n.classnames.s_edit+" > button.edit");if(i!="dialog"){if(r.length)r.trigger("click",[s[t]]);else n.inlineEdit(o,a,s[t])}else{n.dialogEdit(o,a,s[t])}})};t.prototype.doCancelEditRow=function(t){var i=this,a;if(e.type(t)=="number"){a=this.$tbody.find("> tr").eq(t)}else{a=t}a.each(function(){var t=e(this),a=t.find("> td."+i.classnames.s_edit+" > button.cancel");if(a.length){a.trigger("click")}else{i.cancelEdit(t)}})};t.prototype.doSaveEditRow=function(t){var i=this,a=i.options,n;if(e.type(t)=="number"){n=this.$tbody.find("> tr").eq(t)}else if(t){n=t}else{n=i.$tbody.find("> tr."+i.classnames.tr_edit)}if(!n.length){i.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg"))}if(n.length==1){if(n.hasClass(i.classnames.tr_edit))this.updateEdit(n)}else{if(a.saveAll){i.saveAll(n)}else{n.each(function(){i.updateEdit(e(this))})}}};t.prototype.delRows=function(t){var i=this,a=i.options,n=a.beforeDelete,o=a.delConfirm,r;if(n){if(typeof n=="string")n=n.toFunc();if(typeof n=="function"){if(!n.call(this)){return}}}if(typeof t=="object"){r=t}else if(isNaN(t)){var s=i.$tbody.find("> tr"),l,t=t.split(",");t=t.unique();t.sort(function(e,t){return e.trim()-t.trim()});e.each(t,function(e,t){var i=s.eq(parseInt(t.trim()));if(i&&i.length){if(!l)l=i;else l=l.add(i)}});r=l}else if(!isNaN(t)){r=this.$tbody.find("> tr").eq(t)}if(!r||!r.length)return;var d=function(){r.each(function(){e(this).trigger("bjui.datagrid.tr.delete")});i.tools.afterDelete()};var c=function(){var t=r.filter("."+i.classnames.tr_add);if(t.length){t.remove();if(t.length==r.length)return}if(a.delUrl){var n=[],o=a.delCallback;r.each(function(){var t=e(this),o=t.index(),r,s;if(i.isDom)r=t.data("initData")||tools.setDomData(t);else r=i.data[o];if(a.delPK){n.push(r[a.delPK])}else{if(a.jsonPrefix){s={};e.each(r,function(e,t){if(e=="gridCheckbox"||e=="gridEdit")return true;s[a.jsonPrefix+"."+e]=t})}else{s=e.extend({},r);delete s.gridCheckbox;delete s.gridEdit}n.push(s)}});if(typeof o=="string")o=o.toFunc();i.$grid.bjuiajax("doAjax",{url:a.delUrl,data:a.delPK?[{name:a.delPK,value:n.join(",")}]:{json:JSON.stringify(n)},type:a.delType,callback:o||function(e){if(e[BJUI.keys.statusCode]==BJUI.statusCode.ok){d()}else{i.$grid.bjuiajax("ajaxDone",e)}}})}else{d()}};if(o){if(typeof o!="string")o=r.length==1?BJUI.getRegional("datagrid.delMsg"):BJUI.getRegional("datagrid.delMsgM");i.$grid.alertmsg("confirm",o,{okCall:function(){c()}})}else{c()}};t.prototype.inlineEdit=function(t,i,a){if(!this.tools.beforeEdit(t,a)){return false}var n=this,o=n.options,r=n.tools,s=n.columnModel,l=t.find("> td"),d=l.length,c=t.index();if(!a){if(n.isDom)a=t.data("initData")||r.setDomData(t);else a=n.data[c]}if(t.hasClass(n.classnames.tr_edit))return false;if(!n.inputs||!n.inputs.length)r.initEditInputs();t.addClass(n.classnames.tr_edit).data(n.datanames.changeData,{});if(t.data("validator"))t.validator("destroy");if(!o.inlineEditMult){n.doCancelEditRow(t.siblings("."+n.classnames.tr_edit))}n.$lastEditTr=t;l.each(function(o){var r=e(this),l=s[o],f=l&&l.name&&a[l.name],u=r.html(),h=n.inputs[o],p;var g=function(i,o,r){var s=t.data(n.datanames.changeData);switch(l.type){case"date":i.on("afterchange.bjui.datepicker",function(e,t){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()}).change(function(){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()});break;case"select":i.change(function(){o.addClass(n.classnames.td_changed);if(i.val()==String(r))o.removeClass(n.classnames.td_changed);s[l.name]=i.val()});break;case"boolean":i.on("ifChanged",function(){o.toggleClass(n.classnames.td_changed);var t=e(this).is(":checked")?true:false;if(t==r)o.removeClass(n.classnames.td_changed);s[l.name]=t});break;case"lookup":o.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(e,t){o.toggleClass(n.classnames.td_changed);for(var r in t){if(typeof a[r]!="undefined"){s[r]=t[r]}if(l.name==r){if(i.val()==t[r])o.removeClass(n.classnames.td_changed);else i.val(t[r])}}});i.change(function(){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()});break;case"spinner":i.on("afterchange.bjui.spinner",function(e,t){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()}).change(function(){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()});break;default:i.change(function(){o.addClass(n.classnames.td_changed);if(i.val()==r)o.removeClass(n.classnames.td_changed);s[l.name]=i.val()});break}};r.data(n.datanames.td_html,u);if(i){if(!l.add)h=""}else{if(!l.edit)h=""}if(h){p=e(h);if(l.type=="boolean")p.prop("checked",f);else{if(!f||f=="null")f="";p.val(String(f))}if(i){if(l.addAttrs&&typeof l.addAttrs=="object"){e.each(l.addAttrs,function(e,t){p.attr(e,t)})}}else{if(l.editAttrs&&typeof l.editAttrs=="object"){e.each(l.editAttrs,function(e,t){p.attr(e,t)})}}r.empty().append(p).addClass(n.classnames.td_edit);g(p,r,f);if(l.locked){var m=n.$lockTbody.find("tr:eq("+c+")");var v=m.find("> td:eq("+l.lockIndex+")");r.clone().html(u).insertAfter(r);r.show().insertAfter(v).initui();v.remove()}}if(!--d){t.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})}})};t.prototype.saveAll=function(t){var i=this,a=i.options,n=a.editCallback,o,r,s,l,d=[],c=t&&t.length;if(!t||t.length){t=i.$tbody.find("> tr."+i.classnames.tr_edit);c=t.length}t.each(function(){o=e(this),r=i.isDom?o.data("initData"):i.data[o.index()];o.isValid(function(t){if(t){s=o.data(i.datanames.changeData);e.extend(r,s);if(a.jsonPrefix){l={};e.each(r,function(e,t){if(e=="gridCheckbox"||e=="gridEdit")return true;l[a.jsonPrefix+"."+e]=t})}else{l=e.extend({},r);delete l.gridCheckbox;delete l.gridEdit}c--;d.push(l)}else{d=[];return false}})});if(!c){if(n){n=n.toFunc()}else{n=function(a){var n=false,o=[];if(e.type(a)=="array"){n=true;o=a}else if(e.type(a)=="object"){if(a[BJUI.keys.statusCode]){if(a[BJUI.keys.statusCode]==BJUI.statusCode.ok){n=true}else{i.$grid.bjuiajax("ajaxDone",a)}}else{n=true;o.push(a)}}if(n){t.each(function(t){var a=e(this),n=i.isDom?a.data("initData"):i.data[a.index()];e.extend(n,typeof o[t]=="object"&&o[t]);i.inlineEditComplete(a,n)});i.tools.afterSave(t,d)}}}i.$grid.bjuiajax("doAjax",{url:a.editUrl,data:{json:JSON.stringify(d)},type:"POST",callback:n})}};t.prototype.updateEdit=function(t,i){var a=this,n=a.options,o=n.editCallback,r,s,l,d=[];if(a.isDom)r=t.data("initData");else r=a.data[t.index()];if(t.hasClass(a.classnames.tr_edit)){t.isValid(function(c){if(c){s=t.data(a.datanames.changeData);e.extend(r,s);if(n.jsonPrefix){l={};e.each(r,function(e,t){if(e=="gridCheckbox"||e=="gridEdit")return true;l[n.jsonPrefix+"."+e]=t})}else{l=e.extend({},r);delete l.gridCheckbox;delete l.gridEdit}if(o){o=o.toFunc()}else{o=function(n){var o=false,s;if(e.type(n)=="array"){o=true;s=n[0]}else if(e.type(n)=="object"){if(n[BJUI.keys.statusCode]){if(n[BJUI.keys.statusCode]==BJUI.statusCode.ok){o=true}else{a.$grid.bjuiajax("ajaxDone",n)}}else{o=true;s=n}}if(o){e.extend(r,typeof s=="object"&&s);a.inlineEditComplete(t,r,i);a.tools.afterSave(t,r)}}}t.bjuiajax("doAjax",{url:n.editUrl,data:{json:JSON.stringify(d.push(l)&&d)},type:"POST",callback:o})}})}};t.prototype.cancelEdit=function(t){var i=this,a=i.columnModel;t.each(function(){var t=e(this),n=t.index();if(t.hasClass(i.classnames.tr_edit)){t.removeClass(i.classnames.tr_edit).find("> td."+i.classnames.td_edit).each(function(){var t=e(this),o=t.index(),r=a[o],s=t.data(i.datanames.td_html);t.removeClass(i.classnames.td_edit).removeClass(i.classnames.td_changed).html(s);if(r.locked){var l=i.$lockTbody.find("tr:eq("+n+")");var d=l.find("> td:eq("+r.lockIndex+")");s=d.data(i.datanames.td_html);l.removeClass(i.classnames.tr_edit);d.removeClass(i.classnames.td_edit).removeClass(i.classnames.td_changed).html(s)}})}if(t.hasClass(i.classnames.tr_add)){var o=false,r=t.data(i.datanames.changeData);if(e.isEmptyObject(r)){o=true}else{for(var s in r){if(!r[s])delete r[s]}if(e.isEmptyObject(r))o=true}if(o){var l=t.index();i.data=i.data.remove(l);i.$lockTbody&&i.$lockTbody.find("> tr:eq("+l+")").remove();t.remove()}}})};t.prototype.inlineEditComplete=function(i,a,n){var o=this,r=o.columnModel,s=i.index(),l=i.find("> td"),d=false,c=o.$tbody.find("> tr"),f=c.filter("."+o.classnames.tr_add);e.each(r,function(e,i){if(i.gridNumber)d=true;if(!i.name)return;if(i.gridNumber||i.gridCheckbox||i.gridEdit)return;var n=a[i.name],r,c=l.eq(i.index);if(typeof n=="undefined")n="";c.text(n).removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed);if(i.render&&typeof i.render=="function"){if(i.items){r=i.render.call(o,n,i.items);c.html(r)}else{r=i.render.call(o,n);c.html(r)}}else if(i.items){r=t.renderItem.call(o,n,i.items);c.html(r)}if(i.locked){var f=o.$lockTbody.find("> tr:eq("+s+")"),u=f.find("> td:eq("+i.lockIndex+")");u.removeClass(o.classnames.td_changed).html(c.html())}});i.removeClass(o.classnames.tr_edit);if(!n)n=l.filter("."+o.classnames.s_edit).find("button.update");if(n&&n.length)n.trigger("bjui.datagrid.update.tr");if(d&&f.length){f.removeClass(o.classnames.tr_add);c.each(function(t){e(this).find("> td."+o.classnames.td_linenumber).text(t+1);o.$lockTbody&&o.$lockTbody.find("> tr:eq("+t+")").find("> td."+o.classnames.td_linenumber).text(t+1)})}};t.prototype.dialogEdit=function(t,i,a){if(!this.tools.beforeEdit(t,a)){return false}var n=this,o=n.options,r=n.tools,s=n.columnModel,l=t.index(),d,c,f="",u;if(!a){if(n.isDom)a=t.data("initData")||r.setDomData(t);else a=n.data[l]}if(!n.inputs||!n.inputs.length)r.initEditInputs();u=o.gridTitle||"datagrid";if(i){u+=" - "+BJUI.getRegional("datagrid.add")}else{u+=" - "+BJUI.getRegional("datagrid.edit")}d=e('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>');c=e('<form class="datagrid-dialog-edit-form"></form>');var h=function(t,i,o,r){var s=t.data(n.datanames.changeData);switch(r.type){case"date":o.on("afterchange.bjui.datepicker",function(e,t){s[r.name]=o.val()}).change(function(){s[r.name]=o.val()});break;case"select":o.change(function(){s[r.name]=o.val()});break;case"boolean":o.on("ifChanged",function(){var t=e(this).is(":checked")?true:false;s[r.name]=t});break;case"lookup":i.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(e,t){for(var i in t){if(typeof a[i]!="undefined"){s[i]=t[i]}if(r.name==i){o.val(t[i])}}});o.change(function(){s[r.name]=o.val()});break;case"spinner":o.on("afterchange.bjui.spinner",function(e,t){s[r.name]=o.val()}).change(function(){s[r.name]=o.val()});break;default:o.change(function(){s[r.name]=o.val()});break}};var p=function(i){var l=i.find("form.datagrid-dialog-edit-form"),d=i.find("div.bjui-pageFooter button"),c=d.first(),f=d.eq(1),u=d.eq(2),p=d.last();var g=function(t,i,a){i.empty();if(!a.data(n.datanames.changeData))a.data(n.datanames.changeData,{});if(i.data("validator"))i.validator("destroy");e.each(s,function(o,r){if(r==n.linenumberColumn||r==n.checkboxColumn||r==n.editBtnsColumn)return true;var s=e(n.inputs[o]),l=e("<p></p>"),d="datagrid-dialog-edit-column-"+o;if(s.isTag("select"))s.attr("data-width","auto");else if(!s.isTag("checkbox"))s.attr("size",30);if(r.type=="boolean"){s.attr("checked",t[r.name])}else if(r.type=="textarea"){s.html(t[r.name])}else{s.attr("value",t[r.name])}l.append('<label class="control-label x120" for="'+d+'">'+r.label+"：</label>").append(e('<span class="datagrid-dialog-column-span"></span>').append(s.attr("id",d))).appendTo(i);h(a,i,s,r)});i.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})};if(l.is(":empty"))g(a,l,t);if(t.index()==0)c.addClass("disabled");if(t.index()==n.data.length-1)f.addClass("disabled");c.click(function(){var e=t.prev(),i;if(e.length){if(n.isDom){i=e.data("initData")||r.setDomData(e)}else{i=n.data[e.index()]}t=e;g(i,l,t);f.removeClass("disabled");if(!e.prev().length)c.addClass("disabled")}else{c.addClass("disabled")}});f.click(function(){var e=t.next(),i;if(e.length){if(n.isDom){i=e.data("initData")||r.setDomData(e)}else{i=n.data[e.index()]}t=e;g(i,l,t);l.initui();c.removeClass("disabled");if(!e.next().length)f.addClass("disabled")}else{f.addClass("disabled")}});p.click(function(){var i,a,r,s=o.editCallback;if(n.isDom)a=t.data("initData");else a=n.data[t.index()];l.isValid(function(l){if(l){i=t.data(n.datanames.changeData);e.extend(a,i);if(o.jsonPrefix){r={};e.each(a,function(e,t){if(e=="gridCheckbox"||e=="gridEdit")return true;r[o.jsonPrefix+"."+e]=t})}else{r=e.extend({},a);delete r.gridCheckbox;delete r.gridEdit}if(s){s=s.toFunc()}else{s=function(i){var o=false,r;if(e.type(i)=="array"){o=true;r=i[0]}else if(e.type(i)=="object"){if(i[BJUI.keys.statusCode]){if(i[BJUI.keys.statusCode]==BJUI.statusCode.ok){o=true}else{n.$grid.bjuiajax("ajaxDone",i)}}else{o=true;r=i}}if(o){e.extend(a,typeof r=="object"&&r);n.dialogEditComplete(t,a);n.$grid.dialog("close","datagrid-dialog-edit");n.tools.afterSave(t,a)}}}t.bjuiajax("doAjax",{url:o.editUrl,data:{json:JSON.stringify(r)},type:"POST",callback:s})}})});u.click(function(){n.$grid.dialog("close","datagrid-dialog-edit")})};var g=function(){n.$tbody.find("> tr."+n.classnames.tr_add).each(function(){var t=false,i=e(this),a=i.data(n.datanames.changeData);if(e.isEmptyObject(a)){t=true}else{for(var o in a){if(!a[o])delete a[o]}if(e.isEmptyObject(a))t=true}if(t){var r=i.index();n.data=n.data.remove(r);n.$lockTbody&&n.$lockTbody.find("> tr:eq("+r+")").remove();i.remove()}})};d.find("> div:first").append(c).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,n.regional));var m=e.extend({},{id:"datagrid-dialog-edit",fresh:true,target:d[0],width:520,height:400,mask:true,title:u,onLoad:p,onClose:g},typeof o.editDialogOp=="object"&&o.editDialogOp);n.$grid.dialog(m)};t.prototype.dialogEditComplete=function(i,a){var n=this,o=n.columnModel,r=i.index(),s=i.find("> td"),l=false,d=n.$tbody.find("> tr"),c=d.filter("."+n.classnames.tr_add);e.each(o,function(e,i){if(i.gridNumber)l=true;if(!i.name)return;if(i.gridNumber||i.gridCheckbox||i.gridEdit)return;var o=a[i.name],d,c=s.eq(i.index);if(typeof o=="undefined")o="";c.text(o).removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed);if(i.render&&typeof i.render=="function"){if(i.items){d=i.render.call(n,o,i.items);c.html(d)}else{d=i.render.call(n,o);c.html(d)}}else if(i.items){d=t.renderItem.call(n,o,i.items);c.html(d)}if(i.locked){var f=n.$lockTbody.find("> tr:eq("+r+")"),u=f.find("> td:eq("+i.lockIndex+")");u.removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed).html(c.html());f.removeClass(n.classnames.tr_edit)}});if(l&&c.length){c.removeClass(n.classnames.tr_add);d.each(function(t){e(this).find("> td."+n.classnames.td_linenumber).text(t+1);n.$lockTbody&&n.$lockTbody.find("> tr:eq("+t+")").find("> td."+n.classnames.td_linenumber).text(t+1)})}};t.prototype.resizeGrid=function(){var t=this,i=t.$grid.getPageTarget(),a,n;var o=function(){if(t.initFixedW&&String(t.options.width).endsWith("%")){a=t.$grid.parent().width();if(i.is(":hidden")&&i.hasClass("navtabPage")){t.$grid.data("need.fixedW",true)}else{t.fixedWidth()}}if(String(t.options.height).endsWith("%")){n=t.$grid.parent().height();if(i.is(":hidden")&&i.hasClass("navtabPage")){if(i.hasClass("navtabPage")){t.$grid.data("need.fixedH",true)}}else if(n){if(n!=t.parentH)t.tools.fixedH(n)}}};i.on("bjui.navtab.switch",e.proxy(function(){if(t.$grid.data("need.fixedH")){n=t.$grid.parent().height();if(n)t.tools.fixedH(n);t.$grid.removeData("need.fixedH")}if(t.$grid.data("need.fixedW")){t.fixedWidth();t.$grid.removeData("need.fixedW")}},t));e(window).on(BJUI.eventType.resizeGrid,e.proxy(o,t))};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.datagrid");if(!s)o.data("bjui.datagrid",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.datagrid;e.fn.datagrid=i;e.datagrid=t;e.fn.datagrid.noConflict=function(){e.fn.datagrid=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('table[data-toggle="datagrid"]');if(!a.length)return;i.call(a)})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS()};t.SCROLLW=18;t.DEFAULTS={width:"100%"};t.prototype.TOOLS=function(){var t=this;var i={getLeft:function(t){var i=0;t.prevAll().each(function(){i+=e(this).outerWidth()});return i},getRight:function(t){var i=0;t.prevAll().andSelf().each(function(){i+=e(this).outerWidth()});return i-1},getCellNum:function(e){return e.prevAll().andSelf().size()},getColspan:function(e){return e.attr("colspan")||1},getStart:function(t){var i=1;t.prevAll().each(function(){i+=parseInt(e(this).attr("colspan")||1)});return i},getPageCoord:function(e){var t={x:0,y:0};while(e){t.x+=e.offsetLeft;t.y+=e.offsetTop;e=e.offsetParent}return t},getOffset:function(t,i){if(!e.support.leadingWhitespace){var a=t.offset();var n={offsetX:i.pageX||i.screenX,offsetY:i.pageY||i.screenY};var o={offsetX:n.offsetX-a.left,offsetY:n.offsetY-a.top};return o}var r=i.target;if(r.offsetLeft==undefined){r=r.parentNode}var s=this.getPageCoord(r);var l={x:window.pageXOffset+i.clientX,y:window.pageYOffset+i.clientY};var o={offsetX:l.x-s.x,offsetY:l.y-s.y};return o}};return i};t.prototype.resetWidth=function(){var i=this.$element,a=i.width(),n=i.find("table"),o=n&&n.width(),r=n.eq(0)&&n.eq(0).find("tr:first-child > th"),s=n.eq(1)&&n.eq(1).find("tr:first-child > td");if(n&&a-o<t.SCROLLW){var l=parseInt((a-o)/r.length);n.width(a-t.SCROLLW);r.each(function(t){var i=parseInt(e(this).css("width"));e(this).width(i+l);if(s.eq(t))s.eq(t).width(i+l)})}};t.prototype.init=function(){if(!this.$element.isTag("table"))return;this.$container=this.$element.parent().addClass("bjui-resizeGrid");this.$fixed=undefined;var e=this.$container.width();var t=this.options.height;if(this.$container.hasClass("tab-pane"))e=this.$container.parent().width()-20;if(typeof this.options.width=="string"&&this.options.width.indexOf("%")){this.options.newWidth=e*(this.options.width.replace("%","")/100)}else{this.options.newWidth=parseInt(this.options.width)}this.options.styles=[];this.$element.wrap('<div class="bjui-tablefixed clearfix"></div>');this.$fixed=this.$element.parent();this.initHead();this.initBody();this.resizeCol();if(t&&!this.$fixed.closest(".tab-content").length)this.$fixed.height(t).addClass("fixedH")};t.prototype.initHead=function(){var i=this.options.styles=[];var a=this.$element.find("thead > tr");var n=a.eq(0).find("> th");var o=this.$element;var r=0;var s=[];var l=[];var d=-1;n.each(function(t){var i=e(this),a=parseInt(i.attr("colspan")||1),n=i.attr("width"),o=i.attr("align"),r="";for(var c=0;c<a;c++){if(a==1&&n)r=' width="'+n+'"';if(o)i.removeAttr("align").addClass(o);s.push("<th"+r+"></th>")}i.attr("colsNum",d+=a);l[t]=a});var c=s.length,f=e('<tr class="resize-head">'+s.join("")+"</tr>");if(a.length>1){d=0;var u=a.eq(1).find("> th");e.each(l,function(e,t){t=parseInt(t);if(t>1){var i=parseInt(n.eq(e).attr("colsnum"));for(var a=t-1;a>=0;a--){var o=u.eq(d++),r=i-a,s=o.attr("width"),l=o.attr("align");var c=f.find("> th").eq(r);if(o&&o.length)o.attr("colsnum",r);if(s)c.attr("width",s);if(l)o.addClass(l).removeAttr("align")}}})}this.$fixed.html(this.$element.html());var h=this.$fixed.find("thead");h.prepend(f);f.find("> th").each(function(t){var a=e(this);var n=[],o=a.innerWidth();n[0]=parseInt(o);r+=n[0];i[i.length]=n});r=parseInt((this.options.newWidth-t.SCROLLW-r)/c);var p=h.find("> tr:eq(0) > th");this.options.$ths=p;p.each(function(t){var a=e(this),n=i[t],o=a.attr("width");a.removeAttr("align").width(n[0]+r);n[0]=n[0]+r;if(o){n[0]=parseInt(o);a.width(o).removeAttr("width")}});h.find("> tr:gt(0) > th").each(function(){var t=e(this);t.html('<div class="fixedtableCol">'+t.html()+"</div>")});h.wrap('<div class="fixedtableHeader" style="width:'+(this.options.newWidth-t.SCROLLW)+'px;overflow:hidden;"><div class="fixedtableThead"><table class="table table-bordered" style="width:'+(this.options.newWidth-t.SCROLLW)+"px; max-width:"+(this.options.newWidth-t.SCROLLW)+'px;"></table></div></div>');this.$fixed.append('<div class="resizeMarker" style="display:none; height:300px; left:57px;"></div><div class="resizeProxy" style="left:377px; display:none; height:300px;"></div>')};t.prototype.initBody=function(){var i=this;var a=this.$fixed.find("> tbody");var n=this.options.styles;var o,r;if(this.options.height){r=this.options.height-this.$fixed.find(".fixedtableHeader").height()+"px"}else{r="100%";var s=function(){var e=i.$fixed.parent().height();i.$fixed.parent().css("overflow","hidden");i.$fixed.height(e).find(".fixedtableScroller").height(e-i.$fixed.find(".fixedtableHeader").height())};e(document).one(BJUI.eventType.afterInitUI,function(e){s()})}o='style="height:'+r+'; overflow-y:auto;"';a.wrap('<div class="fixedtableScroller"'+o+' style="width:'+this.options.newWidth+'px;"><div class="fixedtableTbody"><table style="width:'+(this.options.newWidth-t.SCROLLW)+"px; max-width:"+(this.options.newWidth-t.SCROLLW)+'px;"></table></div></div>');if(!this.$element.attr("class"))a.parent().addClass("table table-striped table-bordered table-hover");else a.parent().addClass(this.$element.attr("class"));if(typeof this.$element.attr("data-selected-multi")!="undefined")a.parent().attr("data-selected-multi",this.$element.attr("data-selected-multi"));a.before('<thead><tr class="resize-head">'+this.$fixed.find("thead > tr").html()+"</tr></thead>");this.options.$tds=a.prev().find("> tr:first-child > th");if(this.options.nowrap)a.parent().addClass("nowrap");a.closest(".fixedtableScroller").scroll(function(t){var i=e(this);var a=i.scrollLeft();var n=i.prev().find("> .fixedtableThead");n.css({position:"relative",left:-a});return false})};t.prototype.resizeCol=function(){var i=this;var a=this.$fixed;var n=this.options.$ths;var o=this.options.$tds;var r=this.tools;a.find("thead > tr:gt(0) > th").each(function(s){var l=e(this);l.mouseover(function(e){var s=parseInt(a.find(".fixedtableThead").css("left"))||0;var d=r.getOffset(l,e).offsetX;var c=n.eq(l.attr("colsnum"));if(l.outerWidth()-d<5){l.css("cursor","col-resize").off("mousedown.bjui.tablefixed.resize").on("mousedown.bjui.tablefixed.resize",function(e){a.find("> .resizeProxy").show().css({left:r.getRight(c)+s+a.position().left,top:a.position().top,height:a.height(),cursor:"col-resize"}).basedrag({scop:true,cellMinW:20,relObj:a.find(".resizeMarker"),move:"horizontal",event:e,stop:function(){var e=a.find(".resizeProxy").position().left;var n=a.find(".resizeMarker").position().left;var s=e-n-c.outerWidth()-9;var l=r.getCellNum(c);var d=c.width(),f=c.width()+s;var u=o.eq(l-1);var h=a.find("> .fixedtableHeader .table").width();c.width(f);u.width(f);a.find(".table").width(h+s);a.find(".resizeMarker, .resizeProxy").hide();if(h+s+t.SCROLLW<i.options.newWidth){a.find(".fixedtableScroller").width(h+s+t.SCROLLW)}else{var f=a.closest(".bjui-resizeGrid").innerWidth();if(h+s+t.SCROLLW<f)f=h+s+t.SCROLLW;a.find(".fixedtableHeader").width(f-t.SCROLLW);a.find(".fixedtableScroller").width(f);a.width(f)}a.data("resizeGrid",true)}});a.find("> .resizeMarker").show().css({left:r.getLeft(c)+s+a.position().left,top:a.position().top,height:a.height()})})}else{l.css("cursor","default").off("mousedown.bjui.tablefixed.resize")}return false})})};t.prototype.setOrderBy=function(t){var i=this.$element,a=i.find(".fixedtableCol"),n=e(FRAG.orderby.replace("#asc#",BJUI.regional.orderby.asc).replace("#desc#",BJUI.regional.orderby.desc));t=t||this.options;i.addClass("orderby");if(t.orderDirection){if(!BJUI.ui.clientPaging)i.addClass(t.orderDirection);i.pagination("setClientOrder",{orderField:t.orderField,orderDirection:t.orderDirection})}if(!a.length){a=e('<div class="fixedtableCol">'+i.html()+"</div>").appendTo(i.empty())}n.data("orderField",t.orderField).appendTo(a).pagination("orderBy")};t.prototype.resizeGrid=function(){var i=this;var a=function(){e("div.bjui-resizeGrid").each(function(){var a=e(this),n=a.closest(".navtabPage"),o=a.width(),r=a.height(),s=a.find(".bjui-tablefixed"),l=s.find(".fixedtableThead").height(),d=i.options.newWidth,c;if(a.length&&a.is(":hidden")){if(!a.hasClass("tab-pane")){n.show();o=a.innerWidth();r=a.height();l=s.find(".fixedtableHeader").height();n.hide()}}if(o){a.find(".bjui-tablefixed").each(function(){var i=e(this);if(!i.data("resizeGrid"))c=o;else c=d;i.width(c);i.find(".table").width(c-t.SCROLLW);i.find(".fixedtableHeader").width(c-t.SCROLLW);i.find(".fixedtableScroller").width(c)})}a.css("overflow","hidden");s.height(r).find(".fixedtableScroller").height(r-l)});var a=function(){var e=i.$fixed.parent().height();i.$fixed.parent().css("overflow","hidden");i.$fixed.height(e).find(".fixedtableScroller").height(e-i.$fixed.find(".fixedtableHeader").height())}};e(window).on(BJUI.eventType.resizeGrid,a)};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.tablefixed");if(!s)o.data("bjui.tablefixed",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.tablefixed;e.fn.tablefixed=i;e.fn.tablefixed.Constructor=t;e.fn.tablefixed.noConflict=function(){e.fn.tablefixed=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('table[data-toggle="tablefixed"]');if(!a.length)return;i.call(a)});e(document).on(BJUI.eventType.afterInitUI,function(t){var a=e(t.target).find("th[data-order-field]");if(!a.length)return;i.call(a,"setOrderBy")});e(document).on("click.bjui.tr.data-api","tr[data-id]",function(t){var i=e(this),a=i.closest("table"),n=a.data("selectedMulti"),o=i.attr("data-id"),r="selected",s=a.closest(".unitBox").find("#bjui-selected");i.toggleClass(r);if(n){o=[];i.siblings("."+r).add(i.hasClass(r)?i:"").each(function(){o.push(e(this).attr("data-id"))});o=o.join(",")}else{i.siblings().removeClass(r);if(!i.hasClass(r))o=""}if(s&&s.length){s.val(o)}else{s=e('<input type="hidden" id="bjui-selected" value="'+o+'">');s.appendTo(a.closest(".unitBox"))}})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS();this.$tbody=this.$element.find("> tbody");if(!this.$tbody.length){this.$tbody=e("<tbody></tbody>");this.$element.append(this.$tbody)}this.$numAdd=this.$btnAdd=null};t.DEFAULTS={singleNoindex:true};t.EVENTS={afterDelete:"afterdelete.bjui.tabledit"};t.prototype.TOOLS=function(){var i=this;var a={initSuffix:function(t){var i=t.find("> tr");i.each(function(t){var i=e(this);i.find(":input, :file, a, label, div").each(function(){var i=e(this),a=i.attr("name"),n=i.val(),o=i.attr("for"),r=i.attr("id"),s=i.attr("href"),l=i.attr("data-group"),d=i.attr("data-suffix");if(a)i.attr("name",a.replaceSuffix(t));if(o)i.attr("for",o.replaceSuffix(t));if(r)i.attr("id",r.replaceSuffix(t).replaceSuffix2(t));if(s)i.attr("href",s.replaceSuffix(t));if(l)i.attr("data-group",l.replaceSuffix(t));if(d)i.attr("data-suffix",d.replaceSuffix(t));if(n&&n.indexOf("#index#")>=0)i.val(n.replace("#index#",t+1));if(i.hasClass("no")){var c=i.data("prefix")?i.data("prefix"):"";i.val(c+(t+1))}})})},initEnter:function(t){var i=t.find(":text");i.each(function(t){e(this).bind("keydown",function(e){if(e.which==BJUI.keyCode.ENTER){var a=t+1;if(i.eq(a)){i.eq(a).focus()}e.preventDefault()}})});this.initInput(t)},initInput:function(t){t.find("> tr > td").each(function(){var t=e(this).find(".input-hold");if(!t.length){t=e('<span class="input-hold" style="display:block; padding:0 4px; height:0px; font-size:12px; visibility:hidden;"></span>');e(this).append(t)}if(!e.support.leadingWhitespace){e(this).on("propertychange",":text",function(i){t.text(e(this).val())})}else{e(this).on("input",":text",function(i){t.text(e(this).val())})}})},initTbody:function(){var t=i.$element,a=i.$tbody;a.find("> tr").each(function(){var r=e(this),s=r.find("> td"),l=t.data("bjui.tabledit.tr").clone().find("> th");r.data("bjui.tabledit.oldTds",r.html());l.each(function(t){var i=s.eq(t),a=i.data("val"),n=e(this),o=n.children(),r=n.find(".pic-box");if(typeof a=="undefined")a=i.html();if(!i.data("noedit")){if(o.length){if(o.is("input:checkbox")||o.is("input:radio")){o.filter('[value="'+a+'"]').attr("checked","checked")}else if(o.isTag("select")){o.find('option[value="'+i.data("val")+'"]').attr("selected","selected")}else if(r.length){if(i.data("val"))n.find(".pic-name").val(i.data("val"));r.html(i.html())}else if(o.hasClass("wrap_bjui_btn_box")){o.find("input[data-toggle]").attr("value",a+"")}else if(o.is("textarea")){o.html(a);if(o.attr("data-toggle")=="kindeditor"){o.attr("data-toggle-old","kindeditor").removeAttr("data-toggle")}}else{o.attr("value",a+"")}i.html(n.html())}}});r.on("dblclick",e.proxy(function(e){n(r)},i)).initui();i.tools.initSuffix(a);o(r)});a.on("click.bjui.tabledit.readonly",'[data-toggle="doedit"]',function(t){n(e(this).closest("tr"))}).on("click.bjui.tabledit.readonly",'[data-toggle="dosave"]',function(a){var n=e(this).closest("tr"),r=n.index(),s=i.options.callback;if(i.options.action){n.wrap('<form action="" method="POST"></form>');if(n.attr("data-id")){var l=t.find("> thead > tr:eq(0)").data("idname")||"id";n.before('<input type="hidden" name="'+l.replaceSuffix(r)+'" value="'+n.attr("data-id")+'">')}var d=n.parent().serializeArray();if(i.options.singleNoindex){e.each(d,function(t,i){e.extend(i,{name:i.name.replaceSuffix(0)})})}n.prev("input").remove();n.unwrap().isValid(function(e){if(e){if(s){s=s.toFunc()}else{s=function(e){if(e[BJUI.keys.statusCode]==BJUI.statusCode.ok){o(n)}else{n.bjuiajax("ajaxDone",e)}}}n.bjuiajax("doAjax",{url:i.options.action,data:d,type:i.options.type||"POST",callback:s})}})}else{o(n)}});i.tools.initEnter(a);function n(t){t.removeClass("readonly").find("> td *").each(function(){var t=e(this),i=t.closest("td"),a=i.data("val"),n=t.attr("data-toggle-old"),o=i.data("readonly");if(typeof a=="undefined")a=i.html();if(i.data("notread"))return true;if(t.isTag("select"))t.val(i.attr("data-val")).selectpicker("refresh").nextAll(".bootstrap-select").removeClass("readonly").find("button").removeClass("disabled");if(t.is(":checkbox")){t.closest(".icheckbox_minimal-purple").removeClass("disabled");t.closest(".icheckbox_minimal-purple").find("ins").removeClass("readonly")}if(t.is(":radio")){t.closest(".iradio_minimal-purple").removeClass("disabled");t.closest(".iradio_minimal-purple").find("ins").removeClass("readonly")}if(n){if(n=="dosave")return true;else t.removeAttr("data-toggle-old").attr("data-toggle",n);if(n=="spinner"){t.spinner("destroy").spinner()}if(n=="kindeditor"){i.initui()}}if(t.is(":text")||t.is("textarea")){t.off("keydown.readonly");if(o)t.prop("readonly",true)}t.find(".bjui-lookup, .bjui-spinner, .bjui-upload").show()});t.find('[data-toggle="doedit"]').attr("data-toggle","dosave").text("完成")}function o(t){t.addClass("readonly").find("> td *").each(function(){var t=e(this),i=t.closest("td"),a=t.attr("data-toggle");if(i.data("notread"))return true;if(t.isTag("select"))t.nextAll(".bootstrap-select").addClass("readonly").find("button").addClass("disabled");if(t.is(":checkbox")){t.closest(".icheckbox_minimal-purple").addClass("disabled");t.closest(".icheckbox_minimal-purple").find("ins").addClass("readonly")}if(t.is(":radio")){t.closest(".iradio_minimal-purple").addClass("disabled");t.closest(".iradio_minimal-purple").find("ins").addClass("readonly")}if(a){if(a=="doedit"||a=="dosave")return true;else t.removeAttr("data-toggle").attr("data-toggle-old",a);if(a=="kindeditor"){KindEditor.remove(t)}}if(t.is(":text")||t.is("textarea"))t.on("keydown.readonly",function(e){e.preventDefault()});t.find(".bjui-lookup, .bjui-spinner, .bjui-upload").hide()});t.find('[data-toggle="dosave"]').attr("data-toggle","doedit").text("编辑")}},doAdd:function(){var e=this;var t=i.$element;if(!i.$numAdd||!i.$btnAdd)return;t.on("keydown.bjui.tabledit.add","thead .num-add",function(e){if(e.which==BJUI.keyCode.ENTER){i.$btnAdd.trigger("click.bjui.tabledit.add");e.preventDefault()}}).on("click.bjui.tabledit.add","thead .row-add",function(e){var a=1;if(!isNaN(i.$numAdd.val()))a=parseInt(i.$numAdd.val());i.add(t,a);e.preventDefault()})},doDel:function(t){var i=this;var a="click.bjui.tabledit.del";t.off(a).on(a,".row-del",function(t){var a=e(this);if(a.data("confirmMsg")){a.alertmsg("confirm",a.data("confirmMsg"),{okCall:function(){i.delData(a)}})}else{i.delData(a)}t.preventDefault()})},delData:function(e){var t=this;var a=e.closest("tbody");var n=e.data();var o=function(o){e.closest("tr").remove();t.initSuffix(a);t.afterDelete(a);if(n.callback)n.callback.toFunc().apply(i,[o])};if(e.is("[href^=javascript:]")||e.is('[href^="#"]')){o()}else{e.bjuiajax("doAjax",{url:e.attr("href"),data:n.data,callback:o})}},afterDelete:function(a){var n=e.Event(t.EVENTS.afterDelete,{relatedTarget:a[0]});i.$element.trigger(n);if(n.isDefaultPrevented())return}};return a};t.prototype.init=function(){var t=this;var i=this.tools;var a=this.$element.addClass("bjui-tabledit"),n=a.find("> thead > tr:first"),o=this.$tbody;var r=a.find("> thead > tr:first").html();n.find("> th").each(function(){var i=e(this);var a=i.attr("title");var n=i.data("addtool");if(a)i.html(a);if(n){var o=e('<span style="position:relative;"></span>');i.empty();t.$numAdd=e('<input type="text" value="1" class="form-control num-add" size="2" title="待添加的行数">');t.$btnAdd=e('<a href="javascript:;" class="row-add" title="添加行"><i class="fa fa-plus-square"></i></a>');o.append(t.$numAdd).append(t.$btnAdd).appendTo(i)}});a.data("bjui.tabledit.tr",e("<tr>"+r+"</tr>"));i.initTbody();i.doAdd();i.doDel(o)};t.prototype.add=function(t,i){var a=this.tools;var n=t.find("> tbody");var o,r=t.data("bjui.tabledit.tr");for(var s=0;s<i;s++){r.find("> th").each(function(){e(this).replaceWith("<td>"+e(this).html()+"</td>")});var l=r.clone();if(s==0)o=l;l.hide().appendTo(n);a.initSuffix(n);a.initEnter(n);l.show().css("display","").initui()}if(o&&o.length){var d=o.find(":text");d.each(function(){var t=e(this);if(!t.prop("readonly")){t.focus();return false}})}};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.tabledit");if(!s)o.data("bjui.tabledit",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.tabledit;e.fn.tabledit=i;e.fn.tabledit.Constructor=t;e.fn.tabledit.noConflict=function(){e.fn.tabledit=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('table[data-toggle="tabledit"]');if(!a.length)return;i.call(a)});e(document).on(BJUI.eventType.afterInitUI,function(t){var a=e(t.target).find('table[data-toggle="tabledit"]');a.each(function(){if(e(this).is("[data-initnum]")){var t=e(this).data("initnum");if(t>0){i.call(e(this),"add",e(this),t)}}})});e(document).on("click.bjui.tabledit.data-api",'[data-toggle="tableditadd"]',function(t){var a=e(this);var n=a.data("num")||1;var o=a.data("target");if(!o||!e(o).length)return;if(!e(o).isTag("table"))return;i.call(a,"add",e(o),n);t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS();this.$spinner=null;this.height=this.$element.addClass("form-control").innerHeight();this.ivalue=Number(this.$element.val())||0};t.DEFAULTS={min:0,max:100,step:1,decimalPlace:0};t.EVENTS={afterChange:"afterchange.bjui.spinner"};t.prototype.TOOLS=function(){var e=this;var i={changeVal:function(i){var a=e.$element;var n=Number(a.val())||Number(e.ivalue);var o=i.data("add")||-1;var r=e.options.min,s=e.options.max,l=e.options.step;if(o==1){if(n<=s-l)n=n+l}else if(o==-1){if(n>=r+l)n=n-l}else if(n>s){n=s}else if(n<r){n=r}if(e.options.decimalPlace)n=new String(n.toFixed(e.options.decimalPlace));e.ivalue=n;a.val(n).trigger(t.EVENTS.afterChange,{value:n})}};return i};t.prototype.init=function(){var e=this;var t=this.$element;var i=this.options;if(isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step)){BJUI.debug("Spinner Plugin: Parameter is non-numeric type!");return}this.addBtn()};t.prototype.addBtn=function(){var t=this,i=t.$element;if(!this.$lookBtn&&!i.parent().hasClass("wrap_bjui_btn_box")){this.$spinner=e(FRAG.spinnerBtn);i.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var a=i.parent();a.css("position","relative");this.$spinner.css({height:this.height}).appendTo(a);this.$spinner.on("selectstart",function(){return false});var n=null;t.$spinner.find("li").on("click",function(i){t.tools.changeVal(e(this))}).on("mousedown",function(){var i=e(this);n=setInterval(function(){t.tools.changeVal(i)},150)}).on("mouseup",function(){clearTimeout(n)})}};t.prototype.destroy=function(){if(this.$element.parent().hasClass("wrap_bjui_btn_box")){this.$element.parent().find(".bjui-spinner").remove();this.$element.unwrap()}};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.spinner");if(!s)o.data("bjui.spinner",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.spinner;e.fn.spinner=i;e.fn.spinner.Constructor=t;e.fn.spinner.noConflict=function(){e.fn.spinner=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('input[data-toggle="spinner"]');if(!a.length)return;i.call(a)})}(jQuery);+function(e){"use strict";var t,i,a;var n=function(t,i){this.$element=e(t);this.options=i;this.$lookBtn=null};n.DEFAULTS={url:null,id:null,mask:true,width:700,height:400,title:"Lookup",maxable:true,resizable:true};n.EVENTS={afterChange:"afterchange.bjui.lookup"};n.prototype.init=function(){var e=this,n=this.options,o=this.tools;if(!n.url){BJUI.debug("Lookup Plugin: Error trying open a lookup dialog, url is undefined!");return false}else{n.url=decodeURI(n.url).replacePlh(e.$element.closest(".unitBox"));if(!n.url.isFinishedTm()){e.$element.alertmsg("error",n.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Lookup Plugin: The lookup's url is incorrect, url:"+n.url);return false}n.url=encodeURI(n.url)}t=this.options.group||null;i=this.options.suffix||null;a=this.$element;if(i)i=i.trim();this.open(e.$element)};n.prototype.addBtn=function(){var t=this,i=t.$element;if(!this.$lookBtn&&!i.parent().hasClass("wrap_bjui_btn_box")){this.$lookBtn=e(FRAG.lookupBtn);this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var a=this.$element.parent();var n=this.$element.addClass("form-control").innerHeight();a.css({position:"relative",display:"inline-block"});e.each(t.options,function(e,i){if(e!="toggle")t.$lookBtn.data(e,i)});this.$lookBtn.css({height:n,lineHeight:n+"px"}).appendTo(a);this.$lookBtn.on("selectstart",function(){return false})}};n.prototype.open=function(e){var t=this,i=this.options;e.dialog({id:i.id||"lookup_dialog",url:i.url,title:i.title,width:i.width,height:i.height,mask:i.mask,maxable:i.maxable,resizable:i.resizable})};n.prototype.getField=function(e){return(t?t+".":"")+e+(i?i:"")};n.prototype.setSingle=function(e,t){if(typeof e=="string")e=new Function("return "+e)();this.setVal(e,t)};n.prototype.setMult=function(t,i){var a={};var n=this.$element.closest(".unitBox");n.find('[name="'+t+'"]').filter(":checked").each(function(){var t=new Function("return "+e(this).val())();for(var i in t){var n=a[i]?a[i]+",":"";a[i]=n+t[i]}});if(e.isEmptyObject(a)){this.$element.alertmsg("error",this.$element.data("warn")||FRAG.alertSelectMsg);return}this.setVal(a,i)};n.prototype.setVal=function(t,i){var o=this;var r=a.closest(".unitBox");var s;if(a.data("customEvent")){a.trigger("customEvent.bjui.lookup",[t])}else{r.find(":input").each(function(){var a=e(this),r=a.attr("name");for(var l in t){var d=o.getField(l);if(d==r){if(i==1)s=a.val()?a.val()+","+t[l]:t[l];else s=t[l];a.val(s).trigger(n.EVENTS.afterChange,{value:t[l]});break}}})}this.$element.dialog("closeCurrent")};function o(t){var i=arguments;var a=t;return this.each(function(){var o=e(this);var r=e.extend({},n.DEFAULTS,o.data(),typeof t=="object"&&t);var s=o.data("bjui.lookup");if(!s){if(o.data("newurl"))r.url=o.data("newurl");o.data("bjui.lookup",s=new n(this,r))}else if(o.data("newurl")){s.options.url=o.data("newurl");o.data("bjui.dialog",null)}if(typeof a=="string"&&e.isFunction(s[a])){[].shift.apply(i);if(!i)s[a]();else s[a].apply(s,i)}else{s.init()}})}var r=e.fn.lookup;e.fn.lookup=o;e.fn.lookup.Constructor=n;e.fn.lookup.noConflict=function(){e.fn.lookup=r;return this};e(document).on(BJUI.eventType.initUI,function(t){var i=e(t.target).find('[data-toggle="lookup"]');if(!i.length)return;o.call(i,"addBtn")});e(document).on("click.bjui.lookup.data-api",'[data-toggle="lookupbtn"]',function(t){var i=e(this);if(i.attr("href")&&!i.data("url"))i.attr("data-url",i.attr("href"));if(!i.data("title"))i.attr("data-title",i.text());o.call(i);t.preventDefault()});e(document).on("click.bjui.lookupback.data-api",'[data-toggle="lookupback"]',function(t){var i=e(this);var a=i.data("args");var n=i.data("lookupid");var r=e('input[name="lookupType"]:checked').val();if(a)o.call(i,"setSingle",a,r);else if(n)o.call(i,"setMult",n,r);t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t).addClass("tag-input");this.options=i;this.tools=this.TOOLS();this.$box=e(this.$element.wrap('<div class="bjui-tags"></div>')).parent();this.timeout=null;this.$tagsArr={};this.tags=[]};t.DEFAULTS={width:300,url:"",global:false,type:"GET",tagname:"tag",max:0,clear:false,lightCls:"tags-highlight"};t.EVENTS={afterCreated:"aftercreated.bjui.tags"};t.prototype.TOOLS=function(){var i=this,a=this.options;var n={keyDown:function(e){if(e.which==13){return false}},keyUp:function(t){switch(t.which){case BJUI.keyCode.BACKSPACE:if(e.trim(i.$element.val()).length==0){i.tools.removeMenu();return false}break;case BJUI.keyCode.ESC:i.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!i.$menu||!i.$menu.length)return;var n=i.$menu.find("> ."+a.lightCls),o=i.$menu.find("> li:first-child");if(!n.length){o.addClass(a.lightCls)}else{var r=n.removeClass(a.lightCls).next();if(r.length){r.addClass(a.lightCls)}else{o.addClass(a.lightCls)}}return false;break;case BJUI.keyCode.UP:if(!i.$menu||!i.$menu.length)return;var n=i.$menu.find("> ."+a.lightCls),s=i.$menu.find("> li:last-child");if(!n.length){s.addClass(a.lightCls)}else{var l=n.removeClass(a.lightCls).prev();if(l.length){l.addClass(a.lightCls)}else{s.addClass(a.lightCls)}}return false;break;case BJUI.keyCode.ENTER:if(a.max>0&&i.$tagsArr.length>=a.max)return false;var d=false,c=false,f=null;var u=i.$menu&&i.$menu.find("> ."+a.lightCls);if(u&&u.length){d=u.text();f=u.data("item");c=f.value}else{d=e.trim(i.$element.val());if(!d.length)return false;if(a.clear){if(e.inArray(d,i.tags)==-1){i.$element.val("");return false}}c=d}if(!d)return;var h=false;i.$tagsArr.length&&i.$tagsArr.each(function(){if(e(this).val()==c){h=true;return}});if(h){i.$element.val("");return false}i.tools.createTag(d,c);i.tools.removeMenu();i.$element.val("");e.proxy(i.tools.onAfterCreated(f,c),i);return false;break}},query:function(){if(i.timeout)clearTimeout(i.timeout);i.timeout=setTimeout(i.tools.doQuery,300)},doQuery:function(){if(a.max>0&&i.$tagsArr.length>=a.max)return;var t=i.$element.val(),n=i.$box.find("> .tags-menu"),o=[],r=null;var s=i.$element.closest(".navtab-panel").length?e.CurrentNavtab:e.CurrentDialog;if(i.$element.closest(".bjui-layout").length)s=i.$element.closest(".bjui-layout");if(t.length==0)return;i.$element.one("ajaxStart",function(){s.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){s.trigger("bjui.ajaxStop")});e.ajax({url:a.url,global:a.global,type:a.type,data:{term:t},dataType:"json",success:function(t){if(t.length!=0){if(!n.length)n=e('<ul class="tags-menu"></ul>');n.empty().hide().appendTo(i.$box);for(var s=0;s<t.length;s++){r=e('<li class="tags-item">'+t[s].label+"</li>").data("item",t[s]);r.appendTo(n);o.push(t[s].label)}i.tags=o;n.css({top:i.$element.position().top+i.$element.outerHeight(),left:i.$element.position().left}).fadeIn().find("> li").hover(function(){e(this).addClass(a.lightCls).siblings().removeClass(a.lightCls)},function(){e(this).removeClass(a.lightCls)}).click(function(){var t=e(this).text();var a=e(this).data("item");var o=a.value;var r=false;i.$box.find("input:hidden").each(function(){if(e(this).val()==o){r=true;return}});if(r){i.$element.val("");n.remove();return}e.proxy(i.tools.createTag(t,o),i);n.remove();i.$element.val("");e.proxy(i.tools.onAfterCreated(a,o),i)});i.$menu=n}}})},createTag:function(t,a){var n=e('<span class="label label-tag" data-value="'+a+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+t+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');n.insertBefore(i.$element).find("a.close").click(function(){var t=n.data("value");i.$box.find("input:hidden").each(function(){if(e(this).val()==t){e(this).remove()}});n.remove();i.$tagsArr=i.$box.find('input[name="'+i.options.tagname+'"]')});var o=e('<input type="hidden" name="'+i.options.tagname+'">').val(a);o.appendTo(i.$box);i.$tagsArr=i.$box.find('input[name="'+i.options.tagname+'"]')},removeMenu:function(){if(i.$menu)i.$menu.remove()},onAfterCreated:function(a,n){var o=[];i.$tagsArr.length&&i.$tagsArr.each(function(){o.push(e(this).val())});i.$element.trigger(t.EVENTS.afterCreated,{item:a,value:n,tags:o.join(",")})}};return n};t.prototype.init=function(){var t=this;var i=this.$element;var a=this.options;if(!a.url){BJUI.debug("Tags Plugin: Do query tags, url is undefined!");return}else{a.url=decodeURI(a.url).replacePlh(i.closest(".unitBox"));if(!a.url.isFinishedTm()){i.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Tags Plugin: The query tags url is incorrect, url: "+a.url);return}a.url=encodeURI(a.url)}if(isNaN(this.options.max)){BJUI.debug("Tags Plugin: Parameter 'max' is non-numeric type!");return}t.$box.width(a.width).on("click",function(){i.focus()});i.on("keydown",e.proxy(this.tools.keyDown,this)).on("keyup",e.proxy(this.tools.keyUp,this));if(!e.support.leadingWhitespace){i.on("propertychange",e.proxy(this.tools.query,this))}else{i.on("input",e.proxy(this.tools.query,this))}e(document).on("click.bjui.tags",e.proxy(function(t){if(!e(t.target).closest(this.$box).length)this.tools.removeMenu()},this))};t.prototype.destroy=function(){if(this.$tags){this.$element.upwrap();$tags.remove()}};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.tags");if(!s)o.data("bjui.tags",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.tags;e.fn.tags=i;e.fn.tags.Constructor=t;e.fn.tags.noConflict=function(){e.fn.tags=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('input[data-toggle="tags"]');if(!a.length)return;i.call(a)})}(jQuery);+function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=i;this.tools=this.TOOLS()};t.DEFAULTS={fileTypeExts:"*.jpg;*.png",uploader:"",auto:false,method:"POST",multi:false,formData:{},fileObjName:"file",fileSizeLimit:204800,previewImg:true,previewLoadimg:null,dragDrop:false,showUploadedPercent:true,showUploadedSize:true,buttonText:"选择上传文件",removeTimeout:1e3,itemTemplate:FRAG.uploadTemp,breakPoints:false,fileSplitSize:1024*1024,onUploadStart:null,onUploadSuccess:null,onUploadComplete:null,onUploadError:null,onInit:null,onCancel:null,onSelect:null};t.MIMETYPES={zip:["application/x-zip-compressed"],jpg:["image/jpeg"],png:["image/png"],gif:["image/gif"],swf:["application/x-shockwave-flash"],doc:["application/msword"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],ppt:["application/vnd.ms-powerpoint"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.presentation"],mp3:["audio/mpeg"],mp4:["video/mp4"],pdf:["application/pdf"],txt:["text/plain"],xml:["text/xml"]};t.prototype.TOOLS=function(){var i=this,a=this.options;var n={formatFileSize:function(e,t){if(e>1024*1024&&!t)e=(Math.round(e*100/(1024*1024))/100).toString()+"MB";else e=(Math.round(e*100/1024)/100).toString()+"KB";return e},getFile:function(e,t){for(var i=0;i<t.length;i++){if(t[i].index==e)return t[i]}return false},getFileTypes:function(e){var t=[];var i=e.split(";");for(var a=0;a<i.length;a++){t.push(i[a].split(".").pop())}return t},getMimetype:function(e){return t.MIMETYPES[e]},getAcceptString:function(e){var t=this.getFileTypes(e);var i=[];for(var a=0;a<t.length;a++){var n=this.getMimetype(t[a]);if(n)i.push(n);else i.push("."+t[a])}return i.join(",")},filter:function(t){var n=[];var o=this.getFileTypes(a.fileTypeExts);if(o.length>0){for(var r=0;r<t.length;r++){var s=t[r];if(parseInt(this.formatFileSize(s.size,true))>a.fileSizeLimit){i.$element.alertmsg("error",'文件"'+s.name+'"大小超出限制！');continue}if(e.inArray(s.name.split(".").pop().toLowerCase(),o)>=0){n.push(s)}else{i.$element.alertmsg("error",'文件"'+s.name+'"类型不允许！')}}}return n},getFiles:function(e){var t=e.target.files||e.dataTransfer.files;t=this.filter(t);for(var a=0;a<t.length;a++){t[a].id=t[a].lastModifiedDate.getTime()+"_"+t[a].size+"_"+(t[a].type||"").replace(/\W/g,"");this.renderQueueItem(t[a]);i.queueData.files++}return t},renderQueueItem:function(t){var n=0;var o=e(a.itemTemplate.replace("{fileId}",t.id).replace("{fileName}",t.name).replace("#upConfirm#",BJUI.regional.upload.upConfirm).replace("#upPause#",BJUI.regional.upload.upPause).replace("#upCancel#",BJUI.regional.upload.upCancel).replace("{percent}","0.00%").replace("{uploadedSize}","0KB").replace("{fileSize}",this.formatFileSize(t.size)));if(a.auto){o.find("> .info > .up_confirm").remove()}o.data("upfile",t);i.$uploadFileList.append(o);if(a.breakPoints){n=this.getUploadedSize(t.id);if(n>t.size)n=t.size}this.showProgress(t.id,n,t.size);if(a.previewImg&&t.type.indexOf("image")!=-1){var r=o.find("> .preview > .img");if(a.previewLoadimg)r.html('<img src="'+a.previewLoadimg+'" height="114">');this.previewImg(t,r)}else{o.find("> .preview").remove()}if(a.showUploadedSize){var s=o.find("> .filesize");s.find("> .uploadedsize").html(this.formatFileSize(n));s.find("> .filesize").html(this.formatFileSize(t.size))}else{o.find("> .filesize").remove()}if(a.showUploadedPercent){o.find("> .percent").html((n/t.size*100).toFixed(2)+"%")}else{o.find("> .percent").remove()}a.onSelect&&a.onSelect(files);if(a.auto)i.fileUpload(t,n);o.on("click.bjui.upload.confirm",".up_confirm",function(t){var a=e(this),o=a.closest(".item");a.hide().next().show();i.fileUpload(o.data("upfile"),n)});o.on("click.bjui.upload.cancel",".up_cancel",this.removeQueueItem)},successQueueItem:function(t,o){n.showProgress(t.id,t.size,t.size);a.onUploadSuccess&&a.onUploadSuccess.toFunc().call(i,t,o.responseText,i.$element);setTimeout(function(){i.$element.find("#"+t.id).fadeOut("normal",function(){e(this).remove();var t=i.$element.find("> .queue > .item:visible").length;if(t==0){i.$element.find("> .queue").hide();i.$file.val("")}})},a.removeTimeout)},removeQueueItem:function(t,a){if(a)a.abort();e(this).closest(".item").fadeOut("normal",function(){e(this).remove();var t=i.$element.find("> .queue > .item:visible").length;if(t==0)i.$element.find("> .queue").hide()});t.preventDefault()},previewImg:function(e,t){if(e&&t.length){var i=new FileReader;i.onload=function(e){t.html('<img src="'+e.target.result+'">')};i.readAsDataURL(e)}},showProgress:function(e,t,a){var n=t/a*100+"%",o=i.tools.formatFileSize(t),r=(t/a*100).toFixed(2)+"%";i.$element.find("#"+e+" > .progress > .bar").css("width",n)},getUploadedSize:function(e){return localStorage.getItem(e)*1},saveUploadedSize:function(e,t){localStorage.setItem(e,t)},sendBlob:function(e,t,i,n){var o=new FormData;t.open(a.method,e,true);t.setRequestHeader("X-Requested-With","XMLHttpRequest");o.append(a.fileObjName,i);if(n){for(var r in n){o.append(r,n[r])}}t.send(o)}};return n};t.prototype.init=function(){var t=this;var i=this.$element;var a=this.options;if(!a.uploader){BJUI.debug("Upload Plugin: The options uploader is undefined!");return}else{a.uploader=decodeURI(a.uploader).replacePlh(i.closest(".unitBox"));if(!a.uploader.isFinishedTm()){i.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Upload Plugin: The options uploader is incorrect: "+a.uploader);return}a.uploader=encodeURI(a.uploader)}if(i.hasClass("bjui-upload"))return;var n=e(FRAG.uploadFrag.replaceAll("#multi#",a.multi?"multiple":"").replaceAll("#accept#",t.tools.getAcceptString(a.fileTypeExts)).replaceAll("#btnTxt#",(a.icon?'<i class="fa fa-'+a.icon+'">&nbsp;&nbsp;':"")+a.buttonText));i.addClass("bjui-upload").append(n);this.$file=i.find("> .bjui-upload-select-file");this.$uploadFileList=i.find("> .queue");this.queueData={files:0,success:0,error:0};i.on("change.bjui.upload",".bjui-upload-select-file",function(e){t.fileSelect(e)}).on("click.bjui.upload",".bjui-upload-select",function(e){t.$file.trigger("click")});a.onInit&&a.onInit();if(a.dragDrop){i[0].ondragover=function(e){e.preventDefault();return true};i[0].ondrop=function(e){t.fileSelect(e);e.stopPropagation();e.preventDefault()}}};t.prototype.fileSelect=function(e){this.$uploadFileList.show();this.tools.getFiles(e)};t.prototype.fileUpload=function(t,i){var a=this,n=a.$element,o=a.options,r=a.tools;var s=false,l=t;s=new XMLHttpRequest;if(o.breakPoints){t=l.slice(i,i+o.fileSplitSize)}if(s.upload){s.upload.onprogress=function(e){a.onProgress(t,e.loaded,l.size)};s.onreadystatechange=function(e){if(s.readyState==4&&s.status==200){var n=JSON.parse(s.responseText),d=false;if(o.breakPoints){i+=o.fileSplitSize;r.saveUploadedSize(l.id,i);if(i<l.size){t=l.slice(i,i+o.fileSplitSize);r.sendBlob(o.uploader,s,t,o.formData)}else{d=true}}else{d=true}if(d){a.queueData.success++;r.successQueueItem(l,s);o.onUploadComplete&&o.onUploadComplete(l,s.responseText)}}else{a.queueData.error++;o.onUploadError&&o.onUploadError(l,s.responseText)}if(o.onQueueComplete){if(a.queueData.files=a.queueData.success+a.queueData.error)option.onQueueComplete(a.queueData)}};o.onUploadStart&&o.onUploadStart();o.formData.fileName=l.name;o.formData.lastModifiedDate=l.lastModifiedDate.getTime();r.sendBlob(o.uploader,s,t,o.formData)}n.find("#"+l.id+" > .info > .up_pause").on("click.bjui.upload.pause",function(t){s.abort();e(this).hide().prev().show()});n.find("#"+l.id+" > .info > .up_cancel").off("click.bjui.upload.cancel").on("click.bjui.upload.cancel",e.proxy(function(e){this.tools.removeQueueItem(e,s)},this))};t.prototype.onProgress=function(e,t,i){var a=this,n=a.options;var o=a.$element.find("#"+e.id+" .progress");var r=t;var s=o.attr("lastLoaded")||0;t-=parseInt(s);if(t>e.size)t=e.size;a.$progressBar=o.children(".bar");var l=n.breakPoints?parseFloat(a.$progressBar.get(0).style.width||0):0;var d=(t/i*100+l).toFixed(2);var c=d>100?"100%":d+"%";if(n.showUploadedSize){var f=o.nextAll(".filesize");f.find("> .uploadedsize").text(a.tools.formatFileSize(t))}if(n.showUploadedPercent){o.nextAll(".up_percent").text(c)}a.$progressBar.css("width",c);if(r<n.fileSplitSize){o.attr("lastLoaded",r)}else{o.removeAttr("lastLoaded")}};t.prototype.destroy=function(){};function i(i){var a=arguments;var n=i;if(window.FileReader){return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.upload");if(!s)o.data("bjui.upload",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}else{this.each(function(){if(!e.fn.uploadify)return;var t={swf:BJUI.PLUGINPATH+"uploadify/scripts/uploadify.swf",fileTypeExts:"*.jpg;*.png",id:"fileInput",fileObjName:"file",fileSizeLimit:204800,buttonText:"选择上传文件",auto:false,multi:false,height:24};var i=e(this),a=i.data();if(!a.id)a.id=i.attr("id");e.extend(t,a);if(!t.uploader){BJUI.debug("Upload Plugin: The options uploader is undefined!");return}else{t.uploader=decodeURI(t.uploader).replacePlh(i.closest(".unitBox"));if(!t.uploader.isFinishedTm()){i.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg));BJUI.debug("Upload Plugin: The options uploader is incorrect: "+t.uploader);return}t.uploader=encodeURI(t.uploader)}if(t.id=="fileInput")t.id=t.id+(new Date).getTime();var n=e('<input type="file" name="'+t.name+'" id="'+t.id+'">');if(t.onInit&&typeof t.onInit=="string")t.onInit=t.onInit.toFunc();if(t.onCancel&&typeof t.onCancel=="string")t.onCancel=t.onCancel.toFunc();if(t.onSelect&&typeof t.onSelect=="string")t.onSelect=t.onSelect.toFunc();if(t.onUploadSuccess&&typeof t.onUploadSuccess=="string")t.onUploadSuccess=t.onUploadSuccess.toFunc();if(t.onUploadComplete&&typeof t.onUploadComplete=="string")t.onUploadComplete=t.onUploadComplete.toFunc();if(t.onUploadError&&typeof t.onUploadError=="string")t.onUploadError=t.onUploadError.toFunc();n.appendTo(i);if(!t.auto){var o=e('<button class="btn btn-orange" data-icon="cloud-upload">开始上传</button>');o.hide().insertAfter(i).click(function(){n.uploadify("upload","*");e(this).hide()});t.onSelect=function(){o.show()}}n.uploadify(t)})}}var a=e.fn.upload;e.fn.upload=i;e.fn.upload.Constructor=t;e.fn.upload.noConflict=function(){e.fn.upload=a;return this};e(document).on(BJUI.eventType.initUI,function(t){var a=e(t.target).find('[data-toggle="upload"]');if(!a.length)return;i.call(a)})}(jQuery);+function(e){"use strict";var t,i;e(function(){var a=function(){t=e("#bjui-link-theme");i=e("#bjui-themes");if(e.cookie){var a=e.cookie("bjui_theme")||"blue";var n=i.find("a.theme_"+a);n.theme({})}};a()});var a=function(t,i){this.$element=e(t);this.options=i};a.DEFAULTS={theme:"purple"};a.prototype.init=function(){if(!t.length)return;var e=t.attr("href");e=e.substring(0,e.lastIndexOf("/"));e=e.substring(0,e.lastIndexOf("/"));e+="/"+this.options.theme+"/core.css";t.attr("href",e);var a=this.$element.closest("ul").prev();var n=a.attr("class");n=n.replace(/(theme[\s][a-z]*)/g,"");a.removeClass().addClass(n).addClass("theme").addClass(this.options.theme);i.find("li").removeClass("active");this.$element.parent().addClass("active");this.cookie()};a.prototype.setTheme=function(e){i.find("a.theme_"+e).trigger("click")};a.prototype.cookie=function(){var t=this.options.theme;if(e.cookie)e.cookie("bjui_theme",t,{path:"/",expires:30})};function n(t){var i=arguments;var n=t;return this.each(function(){var o=e(this);var r=e.extend({},a.DEFAULTS,o.data(),typeof t=="object"&&t);var s=o.data("bjui.theme");if(!s)o.data("bjui.theme",s=new a(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(i);if(!i)s[n]();else s[n].apply(s,i)}else{s.init()}})}var o=e.fn.theme;e.fn.theme=n;e.fn.theme.Constructor=a;e.fn.theme.noConflict=function(){e.fn.theme=o;return this};e(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(t){n.call(e(this));t.preventDefault()})}(jQuery);+function(e){"use strict";var t=function(t,i){var a=this;this.$element=e(t);this.options=i};t.DEFAULTS={};t.prototype.init=function(){var t=this,i=t.$element;e.when(t.initUI()).done(function(){i.trigger(BJUI.eventType.afterInitUI)})};t.prototype.initUI=function(){var t=this.$element;e.when(t.trigger(BJUI.eventType.beforeInitUI)).done(function(){t.trigger(BJUI.eventType.initUI)})};function i(i){var a=arguments;var n=i;return this.each(function(){var o=e(this);var r=e.extend({},t.DEFAULTS,o.data(),typeof i=="object"&&i);var s=o.data("bjui.initui");if(!s)o.data("bjui.initui",s=new t(this,r));if(typeof n=="string"&&e.isFunction(s[n])){[].shift.apply(a);if(!a)s[n]();else s[n].apply(s,a)}else{s.init()}})}var a=e.fn.initui;e.fn.initui=i;e.fn.initui.Constructor=t;e.fn.initui.noConflict=function(){e.fn.initui=a;return this};e(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(e){i.call($this,$this.data());e.preventDefault()});e(document).on(BJUI.eventType.beforeInitUI,function(t){var i=e(t.target);var a=[];var n=i.find("[data-noinit]");i.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast");n.each(function(t){var i=e(this);var n={};n.$target=i;n.$next=i.next();n.$prev=i.prev();n.$parent=i.parent();n.visible=i.is(":visible")?true:false;a.push(n);i.remove()});i.data("bjui.noinit",a)});e(document).on(BJUI.eventType.initUI,function(t){var i=e(t.target);i.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")});e(document).on(BJUI.eventType.afterInitUI,function(t){var i=e(t.target);var a=i.data("bjui.noinit");var n=i.find("> .bjui-pageContent").find("form");if(a){e.each(a,function(e,t){if(t.$next.length)t.$next.before(t.$target);else if(t.$prev.length)t.$prev.after(t.$target);else if(t.$parent.length)t.$parent.append(t.$target);if(t.visible)t.$target.show();i.removeData("bjui.noinit")})}i.resizePageH();if(n.length){i.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(e){e.preventDefault();n.submit()})}i.find(".bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){i.find(".bjui-ajax-mask").fadeOut("normal",function(){e(this).remove()})})});e(document).one(BJUI.eventType.afterInitUI,function(t){var i=e("#bjui-hnav-navbar"),a=i.find("> li.active");if(a.length&&a.find("> .items").length){a.find("> a").trigger("click")}});var n=function(t){var i=t;var a=i;var n=i.css("position");if(n=="static")a=i.offsetParent();var o=parseInt(a.css("zIndex"))||0;var r=i.find("> .bjui-maskBackground");var s=i.find("> .bjui-maskProgress");if(!r.length){r=e(FRAG.maskBackground);s=e(FRAG.maskProgress.replace("#msg#",BJUI.regional.progressmsg));i.prepend(r).prepend(s)}var l=parseInt(r.css("zIndex"))||0;var d=parseInt(s.css("zIndex"))||0;r.css("zIndex",o+1);s.css("zIndex",o+2);return{$bg:r,$pr:s}};e(document).on("bjui.ajaxStart",function(t,i,a){var o=n(e(t.target));o.$bg.fadeIn();o.$pr.fadeIn();o.$pr.find(".progress").animate({width:"80%"},i||500);if(a){setTimeout(function(){a.toFunc().call(this)},25)}}).on("bjui.ajaxStop",function(t){var i=n(e(t.target));i.$pr.find(".progress").animate({width:"100%"},"fast",function(){i.$bg.remove();i.$pr.remove()})}).on("bjui.ajaxError",function(t){var i=n(e(t.target));i.$bg.remove();i.$pr.remove()});e(document).on(BJUI.eventType.ajaxStatus,function(t){var i=e(t.target),a=n(i);i.one("ajaxStart",function(){a.$bg.fadeIn();a.$pr.fadeIn();a.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){a.$bg.remove();a.$pr.remove()})});var o=function(e){e.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu");e.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree")};e(document).on(BJUI.eventType.beforeLoadDialog,function(e){}).on(BJUI.eventType.beforeAjaxLoad,function(t){o(e(t.target))}).on(BJUI.eventType.beforeCloseNavtab,function(t){o(e(t.target))}).on(BJUI.eventType.beforeCloseDialog,function(t){o(e(t.target))});e(function(){e(document).on("keydown keyup",function(e){if(e.which===BJUI.keyCode.CTRL){BJUI.KeyPressed.ctrl=e.type=="keydown"?true:false}if(e.which===BJUI.keyCode.SHIFT){BJUI.KeyPressed.shift=e.type=="keydown"?true:false}})})}(jQuery);+function(e){"use strict";e(document).on(BJUI.eventType.initUI,function(t){var i=e(t.target);var a=i.find('[data-toggle="icheck"]');a.each(function(t){var i=e(this),a=i.attr("id"),n=i.attr("name"),o=i.data("label");if(o)i.after('<label for="'+a+'" class="ilabel">'+o+"</label>");i.on("ifCreated",function(t){var i=e(this).closest("div"),o=i.next('[for="'+a+'"]');i.attr("data-icheck",n);o.attr("data-icheck",n)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){e(this).trigger("validate")});if(i.prop("disabled"))i.iCheck("disable")});a.filter(".checkboxCtrl").on("ifChanged",function(t){var a=t.target.checked==true?"check":"uncheck";var n=e(this).data("group");i.find(':checkbox[name="'+n+'"]').iCheck(a)});i.find(":text, :password, textarea, :button, a.btn").each(function(){var t=e(this),i=t.closest("table.bjui-tabledit");if((t.is(":text")||t.is(":password")||t.isTag("textarea"))&&!t.hasClass("form-control"))t.addClass("form-control");if(t.is(":button")){var a=t.data("icon"),n=t.data("large"),o=t.attr("class");if(!t.hasClass("btn"))t.removeClass().addClass("btn").addClass(o);if(a){var r="fa-"+a.replace("fa-","");if(!t.data("bjui.icon")){t.html('<i class="fa '+r+'"></i> '+t.html()).data("bjui.icon",true)}}}if(t.isTag("a")){var a=t.data("icon"),n=t.data("large");if(a){var r="fa-"+a.replace("fa-","");if(!t.data("bjui.icon")){t.html('<i class="fa '+r+'"></i> '+t.html()).data("bjui.icon",true)}}}if(t.isTag("textarea")){var s=t.data("toggle");if(s&&s=="autoheight"&&e.fn.autosize)t.addClass("autosize").autosize()}if(!i.length){var l=t.attr("size")||t.attr("cols"),d=l*10;if(!l)return;if(d)t.css("width",d)}});i.find('form[data-toggle="validate"]').each(function(){var t=e(this),i=typeof t.data("alertmsg")=="undefined"?true:t.data("alertmsg"),a=typeof t.data("msg-class")=="undefined"?"n-right":t.data("msg-class");e(this).validator({valid:function(t){e(t).bjuiajax("ajaxForm",e(t).data())},msgClass:a,validClass:"ok",theme:"red_right_effect"}).on("invalid.form",function(t,a,n){if(i)e(a).alertmsg("error",FRAG.validateErrorMsg.replace("#validatemsg#",BJUI.regional.validatemsg).replaceMsg(n.length))})});i.find('[data-toggle="moresearch"]').each(function(){var t=e(this),i=t.closest(".bjui-pageHeader"),a=i&&i.find(".bjui-moreSearch"),n=t.data("name");if(!t.attr("title"))t.attr("title","更多查询条件");t.click(function(o){if(!a.length){BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!");return}a.css("top",i.outerHeight()-1);if(a.is(":visible")){t.html('<i class="fa fa-angle-double-down"></i>');if(n)e("body").data("moresearch."+n,false)}else{t.html('<i class="fa fa-angle-double-up"></i>');if(n)e("body").data("moresearch."+n,true)}a.fadeToggle("slow","linear");o.preventDefault()});if(n&&e("body").data("moresearch."+n)){a.css("top",i.outerHeight()-1).fadeIn();t.html('<i class="fa fa-angle-double-up"></i>')}});var n=i.find('select[data-toggle="selectpicker"]');var o=function(t,i){var a=t.data("refurl");var n=function(t){var i=e(t.data("nextselect"));if(i&&i.length){var a=i.data("emptytxt")||"&nbsp;";i.html("<option>"+a+"</option>").selectpicker("refresh");n(i)}};if(i&&i.length&&a){var o=t.data("val"),r=i.data("val");if(typeof o=="undefined")o=t.val();e.ajax({type:"POST",dataType:"json",url:a.replace("{value}",encodeURIComponent(o)),cache:false,data:{},success:function(a){if(!a)return;var o="",s="";e.each(a,function(e){var t,i;if(a[e]&&a[e].length){t=a[e][0];i=a[e][1]}else{t=a[e].value;i=a[e].label}if(typeof r!="undefined")s=t==r?" selected":"";o+='<option value="'+t+'"'+s+">"+i+"</option>"});t.removeAttr("data-val").removeData("val");i.removeAttr("data-val").removeData("val");if(!o){o=i.data("emptytxt")||"&nbsp;";o="<option>"+o+"</option>"}i.html(o).selectpicker("refresh");n(i)},error:BJUI.ajaxError})}};n.each(function(){var t=e(this);var i=t.data();var a=e(i.nextselect);t.addClass("show-tick");if(!i.style)t.data("style","btn-default");if(!i.width)t.data("width","auto");if(!i.container)t.data("container","body");else if(i.container==true)t.attr("data-container","false").data("container",false);t.selectpicker();if(a&&a.length&&typeof a.data("val")!="undefined")o(t,a)});n.change(function(){var t=e(this);var i=e(t.data("nextselect"));o(t,i);if(t.attr("aria-required")){t.trigger("validate")}});i.find('[data-toggle="ztree"]').each(function(){var t=e(this),i=t.data(),a=i.options,n;if(a&&typeof a=="string")a=a.toObj();if(a)e.extend(i,typeof a=="object"&&a);n=i.setting;if(!i.nodes){i.nodes=[];t.find("> li").each(function(){var t=e(this);var a=t.data();if(a.pid)a.pId=a.pid;a.name=t.html();i.nodes.push(a)});t.empty()}else{if(typeof i.nodes=="string"){if(i.nodes.trim().startsWith("[")||i.nodes.trim().startsWith("{")){i.nodes=i.nodes.toObj()}else{i.nodes=i.nodes.toFunc()}}if(typeof i.nodes=="function"){i.nodes=i.nodes.call(this)}t.removeAttr("data-nodes")}if(!i.showRemoveBtn)i.showRemoveBtn=false;if(!i.showRenameBtn)i.showRenameBtn=false;if(i.addHoverDom&&typeof i.addHoverDom!="function")i.addHoverDom=i.addHoverDom=="edit"?f:i.addHoverDom.toFunc();if(i.removeHoverDom&&typeof i.removeHoverDom!="function")i.removeHoverDom=i.removeHoverDom=="edit"?u:i.removeHoverDom.toFunc();if(!i.maxAddLevel)i.maxAddLevel=2;var o={view:{addHoverDom:i.addHoverDom||null,removeHoverDom:i.removeHoverDom||null,addDiyDom:i.addDiyDom?i.addDiyDom.toFunc():null},edit:{enable:i.editEnable,showRemoveBtn:i.showRemoveBtn,showRenameBtn:i.showRenameBtn},check:{enable:i.checkEnable,chkStyle:i.chkStyle,radioType:i.radioType},callback:{onClick:i.onClick?i.onClick.toFunc():null,beforeDrag:i.beforeDrag?i.beforeDrag.toFunc():h,beforeDrop:i.beforeDrop?i.beforeDrop.toFunc():p,onDrop:i.onDrop?i.onDrop.toFunc():null,onCheck:i.onCheck?i.onCheck.toFunc():null,beforeRemove:i.beforeRemove?i.beforeRemove.toFunc():null,onRemove:i.onRemove?i.onRemove.toFunc():null,onNodeCreated:l,onCollapse:d,onExpand:c},data:{simpleData:{enable:i.simpleData||true},key:{title:i.title||""}}};if(n&&typeof n=="string")n=n.toObj();if(n)e.extend(true,o,typeof n=="object"&&n);e.fn.zTree.init(t,o,i.nodes);var r="_a";var s=e.fn.zTree.getZTreeObj(t.attr("id"));if(i.expandAll)s.expandAll(true);function l(t,a,n){if(n.faicon){var o=e("#"+n.tId+"_a");if(!o.data("faicon")){o.data("faicon",true).addClass("faicon").find("> span.button").append('<i class="fa fa-'+n.faicon+'"></i>')}}if(i.onNodeCreated){i.onNodeCreated.toFunc().call(this,t,a,n)}}function d(t,a,n){if(n.faiconClose){e("#"+n.tId+"_ico").find("> i").attr("class","fa fa-"+n.faiconClose)}console.log("11");if(i.onCollapse){i.onCollapse.toFunc().call(this,t,a,n)}}function c(t,a,n){if(n.faicon&&n.faiconClose){e("#"+n.tId+"_ico").find("> i").attr("class","fa fa-"+n.faicon)}if(i.onExpand){i.onExpand.toFunc().call(this,t,a,n)}}function f(t,a){var n=a.level;var o=e("#"+a.tId+r);var l=e("#diyBtn_add_"+a.id);var d=e("#diyBtn_del_"+a.id);if(!l.length){if(n<i.maxAddLevel){l=e('<span class="tree_add" id="diyBtn_add_'+a.id+'" title="添加"></span>');l.appendTo(o);l.on("click",function(){s.addNodes(a,{name:"新增Item"})})}}if(!d.length){var d=e('<span class="tree_del" id="diyBtn_del_'+a.id+'" title="删除"></span>');d.appendTo(o).on("click",function(e){var n=function(){d.alertmsg("confirm","确认要删除 "+a.name+" 吗？",{okCall:function(){s.removeNode(a);if(i.onRemove){var n=i.onRemove.toFunc();if(n)n.call(this,e,t,a)}},cancelCall:function(){return}})};if(i.beforeRemove){var o=i.beforeRemove.toFunc();if(o){var r=o.call(o,t,a);if(r&&r==true)n()}}else{n()}})}}function u(t,i){var a=e("#diyBtn_add_"+i.id);var n=e("#diyBtn_del_"+i.id);if(a&&a.length){a.off("click").remove()}if(n&&n.length){n.off("click").remove()}}function h(e,t){for(var i=0;i<t.length;i++){if(t[i].drag===false){return false}}return true}function p(e,t,i,a){return i?i.drop!==false:true}});var r=i.find('[data-toggle="selectztree"]');r.each(function(){var t=e(this);var i=t.data(),a=e(i.tree),n=parseFloat(t.css("width")),o=t.outerHeight();i.width=i.width||t.outerWidth();i.height=i.height||"auto";if(!a||!a.length)return;var r=a.attr("id");var s=e("#"+r+"_select_box");var l=function(n){var r=t.offset().top,s=t.offset().left,l=a.clone().appendTo(e("body")),d=l.outerHeight();l.remove();var c=e(window).height()-d-r-o,f=e(window).height()-r-o;if(i.height=="auto"&&c<0)f=f+c;n.css({top:r+o,left:s,"max-height":f})};t.click(function(){if(s&&s.length){l(s);s.show();return}var n=2;var o=e.CurrentDialog;if(o&&o.length){n=o.css("zIndex")+1}s=e('<div id="'+r+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:n,"min-width":i.width,height:i.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(e("body"));a.appendTo(s).css("width","100%").data("fromObj",t).removeClass("hide").show();l(s);s.show()});e("body").on("mousedown",function(i){var a=e(i.target);if(!(t[0]==i.target||s&&s.length>0&&a.closest(".tree-box").length>0)){s.hide()}});var d=t.closest(".bjui-pageContent");if(d&&d.length){d.scroll(function(){if(s&&s.length){l(s)}})}t.on("destroy.bjui.selectztree",function(){s.remove()})});i.find('[data-toggle="accordion"]').each(function(){var t=e(this),i=t.data("heightbox"),a=t.data("height");var n=function(i,a){var n=t.data("offsety")||0,a=a||e(i).outerHeight()-n*1,o=t.find(".panel-heading"),r=o.outerHeight();r=(r+1)*o.length;t.css("height",a);a=a-r;t.find(".panel-collapse").find(".panel-body").css("height",a)};if(t.find("> .panel").length){if(i||a){n(i,a);e(window).resize(function(){n(i,a)});t.on("hidden.bs.collapse",function(t){var i=e(this).find("> .panel:last"),a=i.find("> .panel-heading > h4 > a");if(a.hasClass("collapsed"))i.css("border-bottom","1px #ddd solid")})}}});i.find('[data-toggle="kindeditor"]').each(function(){var t=e(this),i=t.data();if(i.items&&typeof i.items=="string")i.items=i.items.replaceAll("'","").replaceAll(" ","").split(",");if(i.afterUpload)i.afterUpload=i.afterUpload.toFunc();if(i.afterSelectFile)i.afterSelectFile=i.afterSelectFile.toFunc();if(i.confirmSelect)i.confirmSelect=i.confirmSelect.toFunc();var a={font:[],span:[".color",".background-color",".font-size",".font-family"],div:[".margin",".padding",".text-align"],table:["align","width"],"td,th":["align","valign","width","height","colspan","rowspan"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["class","align",".text-align",".color",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["class"],hr:["class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]};KindEditor.create(t,{pasteType:i.pasteType,minHeight:i.minHeight||260,autoHeightMode:i.autoHeight||false,items:i.items||KindEditor.options.items,uploadJson:i.uploadJson,fileManagerJson:i.fileManagerJson,allowFileManager:i.allowFileManager||true,fillDescAfterUploadImage:i.fillDescAfterUploadImage||true,afterUpload:i.afterUpload,afterSelectFile:i.afterSelectFile,X_afterSelect:i.confirmSelect,htmlTags:a,cssPath:[BJUI.PLUGINPATH+"kindeditor/editor-content.css",BJUI.PLUGINPATH+"kindeditor/plugins/code/prettify.css"],afterBlur:function(){this.sync()}})});i.find('[data-toggle="colorpicker"]').each(function(){var t=e(this);var i=t.data("bgcolor");t.colorpicker();if(i){t.on("changeColor",function(e){t.css("background-color",e.color.toHex())})}});i.find('[data-toggle="clearcolor"]').each(function(){var t=e(this);var i=t.data("target")?e(t.data("target")):null;if(i&&i.length){t.click(function(){i.val("");if(i.data("bgcolor"))i.css("background-color","")})}});i.find('[data-toggle="tooltip"]').each(function(){e(this).tooltip()});i.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(t){var i=e(this),a=i.outerWidth(),n=i.find("> .dropdown-menu"),o=n.outerWidth();if(a>o){n.css("min-width",a)}});i.find('form[data-toggle="ajaxform"]').each(function(){e(this).validator({ignore:":input"});e(this).validator("destroy")});var s=i.find('[data-toggle="highcharts"]');s.each(function(){var t=e(this);var i=t.data();e.get(i.url,function(e){t.highcharts(e)},"json")});var l=i.find('[data-toggle="echarts"]');l.each(function(){var t=e(this);var i=t.data();var a=i.theme?i.theme:"default";var n=i.type.split(",");require.config({paths:{echarts:BJUI.PLUGINPATH+"echarts"}});require(["echarts","echarts/theme/"+a,"echarts/chart/"+n[0],n[1]?"echarts/chart/"+n[1]:"echarts"],function(a,n){var o=a.init(t[0],n);e.get(i.url,function(e){o.setOption(e)},"json")})})})}(jQuery);